/*

Jmat.js

Copyright (c) 2011-2016, Lode Vandevenne
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:
1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.
3. The name of the author may not be used to endorse or promote products
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Math.log2",function(a){return a?a:function(a){return Math.log(a)/Math.LN2}},"es6","es3");$jscomp.polyfill("Math.log10",function(a){return a?a:function(a){return Math.log(a)/Math.LN10}},"es6","es3");
$jscomp.polyfill("Math.trunc",function(a){return a?a:function(a){a=Number(a);if(isNaN(a)||Infinity===a||-Infinity===a||0===a)return a;var b=Math.floor(Math.abs(a));return 0>a?-b:b}},"es6","es3");$jscomp.polyfill("Math.sinh",function(a){if(a)return a;var b=Math.exp;return function(a){a=Number(a);return 0===a?a:(b(a)-b(-a))/2}},"es6","es3");$jscomp.polyfill("Math.cosh",function(a){if(a)return a;var b=Math.exp;return function(a){a=Number(a);return(b(a)+b(-a))/2}},"es6","es3");
$jscomp.polyfill("Math.tanh",function(a){return a?a:function(a){a=Number(a);if(0===a)return a;var b=Math.exp(-2*Math.abs(a));b=(1-b)/(1+b);return 0>a?-b:b}},"es6","es3");$jscomp.polyfill("Math.asinh",function(a){return a?a:function(a){a=Number(a);if(0===a)return a;var b=Math.log(Math.abs(a)+Math.sqrt(a*a+1));return 0>a?-b:b}},"es6","es3");$jscomp.polyfill("Math.acosh",function(a){return a?a:function(a){a=Number(a);return Math.log(a+Math.sqrt(a*a-1))}},"es6","es3");
$jscomp.polyfill("Math.log1p",function(a){return a?a:function(a){a=Number(a);if(.25>a&&-.25<a){for(var b=a,d=1,e=a,f=0,g=1;f!=e;)b*=a,g*=-1,e=(f=e)+g*b/++d;return e}return Math.log(1+a)}},"es6","es3");$jscomp.polyfill("Math.atanh",function(a){if(a)return a;var b=Math.log1p;return function(a){a=Number(a);return(b(a)-b(-a))/2}},"es6","es3");$jscomp.polyfill("Math.sign",function(a){return a?a:function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1}},"es6","es3");function Jmat(){}Jmat.Real=function(){};
Jmat.Real.cast=function(a){return a&&void 0!=a.re?a.re:void 0==a?0:a};Jmat.Real.caststrict=function(a){return a&&void 0!=a.re?0==a.im?a.re:NaN:void 0==a?0:a};Jmat.Real.SQRT2=Math.sqrt(2);Jmat.Real.SQRTPI=Math.sqrt(Math.PI);Jmat.Real.INVSQRT2PI=1/Math.sqrt(2*Math.PI);Jmat.Real.EM=.5772156649015329;Jmat.Real.APERY=1.2020569;Jmat.Real.BIGGESTJSINT=9007199254740992;Jmat.Real.BIGGESTJSPRIME=9007199254740881;Jmat.Real.isInt=function(a){return a==Math.floor(a)};
Jmat.Real.isPositiveInt=function(a){return a==Math.floor(a)&&0<a};Jmat.Real.isNegativeInt=function(a){return a==Math.floor(a)&&0>a};Jmat.Real.isPositiveIntOrZero=function(a){return a==Math.floor(a)&&0<=a};Jmat.Real.isNegativeIntOrZero=function(a){return a==Math.floor(a)&&0>=a};Jmat.Real.isOdd=function(a){return 1==Math.abs(a%2)};Jmat.Real.isEven=function(a){return 0==a%2};Jmat.Real.isPOT=function(a){return 0!=a&&0==(a&a-1)};Jmat.Real.isInf=function(a){return Infinity==a||-Infinity==a};
Jmat.Real.isInfOrNaN=function(a){return Infinity==a||-Infinity==a||isNaN(a)};Jmat.Real.dist=function(a,b){return a==b?0:Math.abs(a-b)};Jmat.Real.cheb=function(a,b){return Jmat.Real.dist(a,b)};Jmat.Real.manhattan=function(a,b){return Jmat.Real.dist(a,b)};Jmat.Real.mod=function(a,b){return a-Math.floor(a/b)*b};Jmat.Real.rem=function(a,b){return a%b};Jmat.Real.wrap=function(a,b,c){if(b==c)return b;var d=Math.min(b,c);return d+Jmat.Real.mod(a-d,Math.max(b,c)-d)};
Jmat.Real.clamp=function(a,b,c){return Math.max(Math.min(b,c),Math.min(Math.max(b,c),a))};Jmat.Real.idiv=function(a,b){return Math.floor(a/b)};
Jmat.Real.gamma=function(a){if(Infinity==a)return Infinity;if(-Infinity==a)return NaN;if(Jmat.Real.useFactorialLoop_(a-1))return Jmat.Real.factorial(a-1);if(.5==a)return Jmat.Real.SQRTPI;if(200<a)return Infinity;var b=function(a){if(0>=a&&a==Math.round(a))return Infinity;if(.5>a)return Math.PI/(Math.sin(Math.PI*a)*b(1-a));var c=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9.984369578019572E-6,1.5056327351493116E-7];
--a;for(var e=c[0],f=1;9>f;f++)e+=c[f]/(a+f);c=a+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(c,a+.5)*Math.exp(-c)*e};return b(a)};Jmat.Real.factorialmem_=[1];Jmat.Real.useFactorialLoop_=function(a){return Jmat.Real.isPositiveIntOrZero(a)&&200>a};
Jmat.Real.factorial=function(a){if(!Jmat.Real.useFactorialLoop_(a))return Jmat.Real.gamma(a+1);if(Jmat.Real.factorialmem_[a])return Jmat.Real.factorialmem_[a];for(var b=Jmat.Real.factorialmem_[Jmat.Real.factorialmem_.length-1],c=Jmat.Real.factorialmem_.length;c<=a;c++)b*=c,Jmat.Real.factorialmem_[c]=b;return b};
Jmat.Real.isPowerOf=function(a,b){var c=Jmat.Real;if(a==b)return 1;if(0>=b||0>=a||1==a||b>a)return 0;if(c.isPOT(a)&&c.isPOT(b))return a=c.ilog2(a),c=c.ilog2(b),0==a%c?a/c:0;if(c.isPOT(a)!=c.isPOT(b)||c.isEven(a)!=c.isEven(b))return 0;c=b;var d=[],e=b;for(b=1;c<a;){d.push(e);c*=e;b*=2;if(c==a)return b;e*=e}if(Infinity==c)return 0;for(;0<d.length;)if(e=d.pop(),c>a?(c/=e,b-=1<<d.length):(c*=e,b+=1<<d.length),c==a)return b;return 0};
Jmat.Real.firstPrimes_=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97];Jmat.Real.isPrimeInit_=function(a){if(Infinity==a||a!=a)return NaN;if(a!=Math.round(a)||2>a)return 0;if(a>Jmat.Real.BIGGESTJSINT)return NaN;for(var b=0;b<Jmat.Real.firstPrimes_.length;b++){if(a==Jmat.Real.firstPrimes_[b])return 1;if(0==a%Jmat.Real.firstPrimes_[b])return 0}return-1};
Jmat.Real.isPrimeSlow_=function(a){var b=Jmat.Real.isPrimeInit_(a);if(-1!=b)return b;b=Jmat.Real.firstPrimes_[Jmat.Real.firstPrimes_.length-1];var c=Math.ceil(Math.sqrt(a))+6;for(b=6*Math.floor(b/6);b<c;){if(0==a%(b-1)||0==a%(b+1))return 0;b+=6}return 1};
Jmat.Real.isPrimeMillerRabin_=function(a){var b=Jmat.Real.isPrimeInit_(a);if(-1!=b)return b;b=1373653>a?[2,3]:9080191>a?[31,73]:4759123141>a?[2,7,61]:1122004669633>a?[2,13,23,1662803]:2152302898747>a?[2,3,5,7,11]:3474749660383>a?[2,3,5,7,11,13]:341550071728321>a?[2,3,5,7,11,13,17]:0xd655278977733>a?[2,2570940,880937,610386380,4130785767]:[2,325,9375,28178,450775,9780504,1795265022];for(var c=Math.floor(a/2),d=1;!(c&1);)c=Math.floor(c/2),++d;for(var e=function(a,b,c){return a+b<Jmat.Real.BIGGESTJSINT?
(a+b)%c:a+b>c?(a-c+b)%c:(a%c+b%c)%c},f=function(a,b,c){if(a*b<Jmat.Real.BIGGESTJSINT)return a*b%c;var d=0;for(a%=c;0<b;)b&1&&(d=e(d,a,c)),a=e(a,a,c),b=Math.floor(b/2);return d%c},g=function(a,b,c,d){for(var e=1;0<c;)c&1&&(e=f(e,d,a)),d=f(d,d,a),c=Math.floor(c/2);d=e;for(var g;b;){g=f(d,d,a);if(1==g&&1!=d&&d!=a-1)return!1;d=g;b--}return 1==g},h=0;h<b.length;h++)if(!g(a,d,c,b[h]))return 0;return 1};Jmat.Real.isPrime=function(a){return 15E5>a?Jmat.Real.isPrimeSlow_(a):Jmat.Real.isPrimeMillerRabin_(a)};
Jmat.Real.eratosthenes=function(a){if(2>a)return[];for(var b=[2],c=[],d=Math.floor(Math.sqrt(a)),e=Math.ceil(a/2),f=0;f<e;f++)c[f]=!0;for(var g=3;g<=d;g+=2)if(f=Math.floor(g/2),c[f])for(f+=g;f<e;f+=g)c[f]=!1;for(f=1;f<=a;f++)c[f]&&b.push(2*f+1);return b};
Jmat.Real.smallestPrimeFactor=function(a){if(Infinity==a||a!=a||a!=Math.round(a)||1>a||a>Jmat.Real.BIGGESTJSINT)return NaN;if(1==a)return 1;for(var b=0;b<Jmat.Real.firstPrimes_.length;b++){if(a==Jmat.Real.firstPrimes_[b])return a;if(0==a%Jmat.Real.firstPrimes_[b])return Jmat.Real.firstPrimes_[b]}b=Jmat.Real.firstPrimes_[Jmat.Real.firstPrimes_.length-1];var c=Math.ceil(Math.sqrt(a));for(b=6*Math.floor(b/6);b<c+5;){if(0==a%(b-1))return b-1;if(0==a%(b+1))return b+1;b+=6}return a};
Jmat.Real.factorize=function(a){if(!(a>Jmat.Real.BIGGESTJSINT)){a=Math.round(a);var b=[];0>a&&(a=-a,b.push(-1));if(2>=a)return 0!=b.length&&1==a||b.push(a),b;for(;!(1>a);){var c=Jmat.Real.smallestPrimeFactor(a);b.push(c);if(a==c)break;a=Math.round(a/c)}return b}};
Jmat.Real.primeCount=function(a){var b=[0,2,3,5,7,11,13,17],c=function(a){if(a<b.length)return b[a];for(var c=b[b.length-1]+2,d=b.length-1;;){if(Jmat.Real.isPrime(c)&&(b.push(c),d++,d==a))return c;c+=2}},d={},e=function(a,b){if(0==b)return Math.floor(a);if(1==b)return Math.floor((a+1)/2);if(d[a]&&void 0!=d[a][b])return d[a][b];var f=e(a,b-1)-e(Math.floor(a/c(b)),b-1);d[a]||(d[a]={});return d[a][b]=f},f={},g=function(a){if(1E9<a)return NaN;if(2>a)return 0;if(3>a)return 1;if(5>a)return 2;var b=Math.floor(a);
if(f[b])return f[b];var d=Math.floor(g(Math.pow(a,.25))),h=Math.floor(g(Math.sqrt(a)));a=Math.floor(g(Math.pow(a,1/3)));var n=e(b,d)+Math.floor((h+d-2)*(h-d+1)/2);for(d+=1;d<=h;d++){var p=b/c(d);n-=g(p);if(d<=a)for(var q=g(Math.sqrt(p)),t=d;t<=q;t++)n-=g(p/c(t))-t+1}return f[b]=n};return g(a)};
Jmat.Real.nearestPrime=function(a){a=Math.round(a);if(7>a)return 2>=a?2:4>=a?3:5;if(Infinity==a||a!=a||9007199254740881<=a)return NaN;if(Jmat.Real.isPrime(a))return a;for(var b=a%6,c=6-b,d=0,e=0;;){Jmat.Real.isPrime(a-d-b+1)?e=a-d-b+1:Jmat.Real.isPrime(a-d-b-1)&&(e=a-d-b-1);(!e||a-e>d+c-1)&&Jmat.Real.isPrime(a+d+c-1)?e=a+d+c-1:(!e||a-e>d+c+1)&&Jmat.Real.isPrime(a+d+c+1)&&(e=a+d+c+1);if(e)return e;d+=6}};
Jmat.Real.nextPrime=function(a){a=Math.floor(a);if(2>a)return 2;if(3>a)return 3;if(Infinity==a||a!=a||9007199254740881<=a)return NaN;var b=a%6,c=2;0==b||5==b?(a+=0==b?1:2,c=4):a+=5-b;for(;;){if(Jmat.Real.isPrime(a))return a;a+=c;c^=6}};
Jmat.Real.previousPrime=function(a){a=Math.ceil(a);if(2>=a)return NaN;if(3>=a)return 2;if(5>=a)return 3;if(7>=a)return 5;if(Infinity==a||a!=a||a>Jmat.Real.BIGGESTJSINT)return NaN;var b=a%6,c=2;0==b||1==b?(a-=b+1,c=4):a-=b-1;for(;;){if(Jmat.Real.isPrime(a))return a;a-=c;c^=6}};Jmat.Real.eulerTotient=function(a){if(0>=a)return NaN;var b=Math.floor(a);a=Jmat.Real.factorize(b);for(var c=-1,d=0;d<a.length;d++)if(c!=a[d]){if(1==a[d])break;c=a[d];b*=1-1/a[d]}return b};
Jmat.Real.pascal_triangle_cache_=[[1],[1,1],[1,2,1],[1,3,3,1],[1,4,6,4,1],[1,5,10,10,5,1],[1,6,15,20,15,6,1],[1,7,21,35,35,21,7,1]];Jmat.Real.pascal_triangle=function(a,b){if(0>a||0>b||a<b||180<a)return NaN;for(var c=Jmat.Real.pascal_triangle_cache_;c.length<=a;){var d=c.length,e=d+1;c[d]=[];for(var f=0;f<e;f++)c[d][f]=0==f||f==e-1?1:c[d-1][f-1]+c[d-1][f]}return c[a][b]};
Jmat.Real.gcd=function(a,b){if(!Jmat.Real.isInt(a)||!Jmat.Real.isInt(b)||Math.abs(a)>Jmat.Real.BIGGESTJSINT||Math.abs(b)>Jmat.Real.BIGGESTJSINT)return NaN;for(;;){if(0==b)return Math.abs(a);var c=Jmat.Real.mod(a,b);a=b;b=c}};Jmat.Real.lcm=function(a,b){return Math.abs(a*b)/Jmat.Real.gcd(a,b)};
Jmat.Real.decompose=function(a,b){b||(b=1E5);var c=0>a;c&&(a=-a);var d=Math.floor(a),e=a-d;if(0==e)return[a,1];a=0;for(var f=1,g=1,h=1;f<=b&&h<=b;){var k=(a+g)/(f+h);if(e==k){var l=f+h<=b?[a+g,f+h]:h>f?[g,h]:[a,f];break}else e>k?(a+=g,f+=h):(g=a+g,h=f+h)}l||(l=f>b?[g,h]:[a,f]);l[0]+=d*l[1];c&&(l[0]=-l[0]);return l};
Jmat.Real.decomposeSemiFast=function(a,b){if(1E3>b)return Jmat.Real.decompose(a,b);b=Jmat.Real.decompose(a,1E3);var c=b[0]/b[1];if(c==a)return b;var d=Jmat.Real.decomposeFast(a,1E3);return Math.abs(a-c)<Math.abs(a-d[0]/d[1])?b:d};Jmat.Real.decomposeFast=function(a,b){b||(b=1E5);var c=b-1;if(a<=c&&a>=-c&&(a<-1/c||a>1/c)){(c=0>a)&&(a=-a);var d=Math.floor(a);a=Math.floor((a-d)*b);var e=Jmat.Real.gcd(a,b);b/=e;a=a/e+d*b;c&&(a=-a);return[a,b]}return[a,1]};
Jmat.Real.near=function(a,b,c){return a>=b-c&&a<=b+c};Jmat.Real.relnear=function(a,b,c){if(a==b)return!0;if(0==a||0==b||0>a!=0>b)return!1;a=Math.abs(a);b=Math.abs(b);return(a>b?a/b:b/a)<1+c};Jmat.Real.frac=function(a){return a-Math.floor(a)};Jmat.Real.fracn=function(a){return 0<a?a-Math.floor(a):-(-a-Math.floor(-a))};
Jmat.Real.lambertw=function(a){if(isNaN(a))return NaN;if(Infinity==a||-Infinity==a)return Infinity;if(a>=-1/Math.E&&703>=a){for(var b=10>a?0:Math.log(a)-Math.log(Math.log(a)),c=Math.max(30,0<a?10+Math.floor(a):30),d=0;d<c;d++){var e=Math.exp(b);b-=(b*e-a)/(e+b*e)}return b}if(0<a)for(b=1,c=0,d=Math.log(a)-Math.log(Math.log(a));;){if(0==b||.5*b==b||d+b==d)return d;e=d*Math.exp(d);if(Jmat.Real.near(e,a,1E-15))return d;e>a?(d-=b,-1==c&&(b*=.5),c=1):(d+=b,1==c&&(b*=.5),c=-1)}return NaN};
Jmat.Real.logy=function(a,b){return Math.log(a)/Math.log(b)};Jmat.Real.clz32=Math.clz32||function(a){for(var b=0;0<a;)a=Math.floor(a/2),b++;return 32-b};Jmat.Real.log2=Math.log2||function(a){return Math.log(a)/Math.LN2};Jmat.Real.ilog2=function(a){return 0>=a?NaN:2147483648>a?31-Jmat.Real.clz32(a):Math.floor(Jmat.Real.log2(Math.floor(a)+.5))};Jmat.Real.getNumBits=function(a){return Jmat.Real.ilog2(Math.abs(a))+1};Jmat.Real.log10=Math.log10||function(a){return Math.log(a)/Math.LN10};
Jmat.Real.root=function(a,b){return Math.pow(a,1/b)};Jmat.Real.seed=void 0;Jmat.Real.random=function(){if(void 0==Jmat.Real.seed)return Math.random();Jmat.Real.seed=1103515245*Jmat.Real.seed+12345&2147483647;return(Jmat.Real.seed>>1)/1073741823};
Jmat.Real.faddeeva=function(a,b){var c=Jmat.Real,d=2/c.SQRTPI,e=function(a,b){a=Math.exp(a);return[a*Math.cos(b),a*Math.sin(b)]},f=function(a,b,c,d){return[a*c-b*d,a*d+b*c]},g=function(a,b){var c=a*a+b*b;return[a/c,-b/c]},h=a/6.3*a/6.3+b/4.4*b/4.4;if(0>b&&h>=.292*.292){if(0==a&&-26.64>b)return[Infinity,0];h=e(b*b-a*a,-2*a*b);a=c.faddeeva(-a,-b);return[2*h[0]-a[0],2*h[1]-a[1]]}c=[0,0];if(h<.292*.292){var k=(1-.85*b/4.4)*Math.sqrt(h);h=Math.ceil(6+72*k);g=1;k=[b*b-a*a,-2*a*b];for(var l=[b,-a],m=0;m<
h;m++)0<m&&(g*=-m,l=f(l[0],l[1],k[0],k[1])),c[0]+=l[0]/(g*(2*m+1)),c[1]+=l[1]/(g*(2*m+1));h=e(k[0],k[1]);c=f(h[0],h[1],c[0],c[1]);c[0]=h[0]-c[0]*d;c[1]=h[1]-c[1]*d}else{if(1>h){k=(1-b/4.4)*Math.sqrt(1-h);m=Math.ceil(16+26*k)+1;h=Math.ceil(7+34*k)+1;e=1.88*k;for(k=[0,0];m>h;m--)k=g(2*(b+m*k[0]+e),2*(m*k[1]-a));l=Math.pow(2*e,h-1);for(m=h;0<m;m--)k=g(2*(b+m*k[0]+e),2*(m*k[1]-a)),c=f(c[0]+l,c[1],k[0],k[1]),l/=2*e}else for(m=Math.ceil(3+1442/(26*Math.sqrt(h)+77))+1;0<m;m--)c=g(2*(b+m*c[0]),2*(m*c[1]-
a));c[0]*=d;c[1]*=d}0==a&&(c[1]=0);0==b&&(c[0]=Math.exp(-a*a));return c};Jmat.Real.erfcx=function(a){return Jmat.Real.faddeeva(0,a)[0]};Jmat.Real.erf=function(a){var b=Math.exp(-a*a);return 0<=a?1-b*Jmat.Real.faddeeva(0,a)[0]:b*Jmat.Real.faddeeva(0,-a)[0]-1};Jmat.Real.erfc=function(a){var b=Math.exp(-a*a);return 0<=a?b*Jmat.Real.faddeeva(0,a)[0]:2-b*Jmat.Real.faddeeva(0,-a)[0]};Jmat.Real.erfi=function(a){return Math.exp(a*a)*Jmat.Real.faddeeva(a,0)[1]};
Jmat.Real.dawson=function(a){var b=Math.exp(-a*a);a=Jmat.Real.faddeeva(a,0)[1];return Jmat.Real.SQRTPI/2*-(b-a)};Jmat.Real.erf_fast_=function(a){var b=0>a;b&&(a=-a);if(0==a)return 0;var c=1/(1+.3275911*a);a=1-c*(.254829592+c*(-.284496736+c*(1.421413741+c*(-1.453152027+1.061405429*c))))*Math.exp(-(a*a));b&&(a=-a);return a};
Jmat.Real.erfc_fast_=function(a){var b=0>a;b&&(a=-a);if(.5>=a){var c=a*a,d=a*c,e=d*c;a=1-2/Jmat.Real.SQRTPI*(a-d/3+e/10+e*c/42)}else 5<=a?(c=a*a,d=c*c,e=d*c,a=Math.exp(-(a*a))/(a*Jmat.Real.SQRTPI)*(1-.5/c+.75/d-1.875/e+6.5625/(e*c))):(c=1/(1+.3275911*a),a=c*(.254829592+c*(-.284496736+c*(1.421413741+c*(-1.453152027+1.061405429*c))))*Math.exp(-(a*a)));b&&(a=2-a);return a};
Jmat.Real.dawson_fast_=function(a){var b=a*a,c=b*b,d=c*b,e=d*b,f=e*b;return(1+.1049934947*b+.0424060604*c+.0072644182*d+5.064034E-4*e+1.789971E-4*f)/(1+.7715471019*b+.2909738639*c+.0694555761*d+.0140005442*e+8.327945E-4*f+3.579942E-4*f*b)*a};
Jmat.Real.erfi_fast_=function(a){var b=!1;0>a&&(a=-a,b=!0);var c=1/Jmat.Real.SQRTPI;if(.5>=a){var d=a*a*a,e=d*a*a;a=c*(2*a+2/3*d+.2*e+1/21*e*a*a)}else if(5<=a){d=1/a;e=d*d*d;var f=e*d*d;a=c*Math.exp(a*a)*(d+.5*e+.75*f+1.875*f*d*d)}else a=2/Jmat.Real.SQRTPI*Math.exp(a*a)*Jmat.Real.dawson(a);b&&(a=-a);return a};Jmat.Real.dms=function(a){var b=0>a;b&&(a=-a);var c=Math.floor(a),d=Math.floor(60*a-60*c);a=c+d/100+Math.floor(3600*a-3600*c-60*d)/1E4;b&&(a=-a);return a};
Jmat.Real.dd=function(a){var b=0>a;b&&(a=-a);var c=Math.floor(a),d=Math.floor(100*a-100*c);a=c+d/60+Math.floor(1E4*a-1E4*c-100*d)/3600;b&&(a=-a);return a};Jmat.Real.degToRad=function(a){return 2*Math.PI*a/360};Jmat.Real.radToDeg=function(a){return 360*a/(2*Math.PI)};Jmat.Real.round=function(a){var b=Math.floor(a);a-=b;return.5==a?0==b%2?b:b+1:.5>a?b:b+1};Jmat.Real.trunc=Math.trunc||function(a){return 0>a?Math.ceil(a):Math.floor(a)};Jmat.Real.lerp=function(a,b,c){return(1-c)*a+c*b};
Jmat.Real.sinh=Math.sinh||function(a){return(Math.exp(a)-Math.exp(-a))/2};Jmat.Real.cosh=Math.cosh||function(a){return(Math.exp(a)+Math.exp(-a))/2};Jmat.Real.tanh=Math.tanh||function(a){return 354<a?1:(Math.exp(2*a)-1)/(Math.exp(2*a)+1)};Jmat.Real.asinh=Math.asinh||function(a){return-Infinity==a?a:Math.log(a+Math.sqrt(a*a+1))};Jmat.Real.acosh=Math.acosh||function(a){return Math.log(a+Math.sqrt(a*a-1))};Jmat.Real.atanh=Math.atanh||function(a){return Math.log((1+a)/(1-a))/2};
Jmat.Real.hypot=function(a,b){a=Math.abs(a);b=Math.abs(b);var c=Math.min(a,b);a=Math.max(a,b);if(Infinity==a)return Infinity;c/=a;return a*Math.sqrt(1+c*c)};Jmat.Real.expm1=function(a){return 1E-5>Math.abs(a)?a+a*a/2+a*a*a/6:Math.exp(a)-1};Jmat.Real.calcCache_=function(a,b,c,d){if(d){for(var e=0;e<d;e++)if(a==c[2*e+1])return c[2*e+2];e=c[0]||0;e++;e>=d&&(e=0);b=b(a);c[2*e+1]=a;c[2*e+2]=b;c[0]=e}else{if(a==c[0])return c[1];b=b(a);c[0]=a;c[1]=b}return b};Jmat.Real.abs=Math.abs;Jmat.Real.floor=Math.floor;
Jmat.Real.ceil=Math.ceil;Jmat.Real.min=Math.min;Jmat.Real.max=Math.max;Jmat.Real.exp=Math.exp;Jmat.Real.log=Math.log;Jmat.Real.sqrt=Math.sqrt;Jmat.Real.pow=Math.pow;Jmat.Real.sin=Math.sin;Jmat.Real.cos=Math.cos;Jmat.Real.tan=Math.tan;Jmat.Real.asin=Math.asin;Jmat.Real.acos=Math.acos;Jmat.Real.atan=Math.atan;Jmat.Real.atan2=Math.atan2;Jmat.Real.isLeapYear=function(a){return 0==a%400||0==a%4&&0!=a%100};Jmat.Real.montharray_=[-1,31,28,31,30,31,30,31,31,30,31,30,31];
Jmat.Real.monthLength=function(a,b){return b&&2==a?29:Jmat.Real.montharray_[a]};Jmat.Real.numDaysSince0=function(a,b,c){var d=Jmat.Real,e=0==a?0:d.idiv(a-1,4)-d.idiv(a-1,100)+d.idiv(a-1,400)+1;e=365*a+e;a=2<b?Jmat.Real.isLeapYear(a)?1:2:0;var f=8<b&&1==b%2?1:0;b=30*(b-1)+d.idiv(b,2)-a+f;return e+b+c-1};
Jmat.Real.daysSince0ToDate=function(a){var b=Math.floor(a/365.2425),c=Jmat.Real.isLeapYear(b);a-=Jmat.Real.numDaysSince0(b,1,1);for(var d=0,e=1;12>=e;e++){d++;var f=Jmat.Real.monthLength(e,c);if(a>=f)a-=f;else break}return[b,d,a+1]};Jmat.Real.dayOfWeek=function(a,b,c){var d=Jmat.Real;c+=3>b?a--:a-2;return(d.idiv(23*b,9)+c+4+d.idiv(a,4)-d.idiv(a,100)+d.idiv(a,400))%7};
Jmat.Real.matrix_add=function(a,b){if(a.length==b.length&&a[0].length==b[0].length){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[d].length;e++)c[d][e]=a[d][e]+b[d][e]}return c}};Jmat.Real.matrix_sub=function(a,b){if(a.length==b.length&&a[0].length==b[0].length){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[d].length;e++)c[d][e]=a[d][e]-b[d][e]}return c}};
Jmat.Real.matrix_mul=function(a,b){var c=a.length,d=a[0].length,e=b[0].length;if(d==b.length){for(var f=[],g=0;g<c;g++)f[g]=[];for(var h=[],k=0;k<e;k++){for(var l=0;l<d;l++)h[l]=b[l][k];for(g=0;g<c;g++){var m=0;for(l=0;l<d;l++)m+=a[g][l]*h[l];f[g][k]=m}}return f}};Jmat.Real.matrix_mulT=function(a,b){var c=a.length,d=a[0].length,e=b.length;if(d==b[0].length){for(var f=[],g=0;g<c;g++)f[g]=[];for(var h=0;h<e;h++)for(g=0;g<c;g++){for(var k=0,l=0;l<d;l++)k+=a[g][l]*b[h][l];f[g][h]=k}return f}};
Jmat.Real.matrix_mulr=function(a,b){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[d].length;e++)c[d][e]=a[d][e]*b}return c};Jmat.Real.matrix_divr=function(a,b){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[d].length;e++)c[d][e]=a[d][e]/b}return c};Jmat.Real.matrix_transpose_naive_=function(a){for(var b=[],c=0;c<a[0].length;c++){b[c]=[];for(var d=0;d<a.length;d++)b[c][d]=a[d][c]}return b};
Jmat.Real.matrix_transpose_cache_friendly_=function(a){for(var b=[],c=0;c<a[0].length;c++)b[c]=[];for(var d=[[0,0,a[0].length,a.length]];0<d.length;){var e=d.pop(),f=e[0];c=e[1];var g=e[2];e=e[3];var h=g-f,k=e-c;if(h>=k&&16<h)d.push([f+g>>1,c,g,e]),d.push([f,c,f+g>>1,e]);else if(16<k)d.push([f,c+e>>1,g,e]),d.push([f,c,g,c+e>>1]);else for(;c<e;c++)for(h=f;h<g;h++)b[h][c]=a[c][h]}return b};
Jmat.Real.matrix_transpose=function(a){return 25E4<a.length*a[0].length?Jmat.Real.matrix_transpose_cache_friendly_(a):Jmat.Real.matrix_transpose_naive_(a)};
Jmat.Real.matrix_rref=function(a){for(var b=a.length,c=a[0].length,d=function(a,b,c){var d=a[b];a[b]=a[c];a[c]=d},e=function(a,b,c,d,e){for(var f=a[0].length;b<f;b++)a[d][b]-=e*a[c][b]},f=function(a,b,d,e){for(;b<c;b++)a[d][b]*=e},g=[],h=0,k=0;k<c;k++){var l=Jmat.Real.argmax(h,b,function(b){return Math.abs(a[b][k])});if(0!=a[l][k]){h!=l&&d(a,h,l);f(a,k,h,1/a[h][k]);for(l=h+1;l<b;l++)0!=a[l][k]&&e(a,k,h,l,a[l][k]),a[l][k]=0;g.push(k);h++;if(h>=b)break}}for(k=0;k<g.length;k++)for(b=g[k],d=k-1;0<=d;d--)0!=
a[d][b]&&e(a,b,k,d,a[d][b]),a[d][b]=0;return a};Jmat.Real.matrix_solve=function(a,b){for(var c=[],d=0;d<a.length;d++){c[d]=[];for(var e=0;e<a[d].length;e++)c[d][e]=a[d][e];c[d].push(b[d]||0)}a=Jmat.Real.matrix_rref(c);b=[];for(c=0;c<a[0].length-1;c++)b[c]=a[c][a[c].length-1];return b};
Jmat.Real.matrix_jacobi=function(a,b,c,d){d=void 0==d?1E-15:d;for(var e=0;e<c;e++){b[e]=[];for(var f=0;f<c;f++)b[e][f]=f==e?1:0}var g=0;for(e=0;e<c;e++)for(f=e+1;f<c;f++)f!=e&&(g+=2*a[e][f]*a[e][f]);for(;g>d;)for(e=0;e<c;e++)for(f=e+1;f<c;f++)if(!(a[e][f]*a[e][f]<=g/(2*c*c))){g-=2*a[e][f]*a[e][f];var h=(a[f][f]-a[e][e])/(2*a[e][f]);h=Math.sign(h)/(Math.abs(h)+Math.sqrt(h*h+1));var k=1/Math.sqrt(h*h+1),l=k*h;for(h=0;h<c;h++){var m=a[h][e];a[h][e]=k*a[h][f]+l*m;a[h][f]=l*a[h][f]-k*m}for(h=0;h<c;h++)m=
a[e][h],a[e][h]=k*a[f][h]+l*m,a[f][h]=l*a[f][h]-k*m,m=b[e][h],b[e][h]=k*b[f][h]+l*m,b[f][h]=l*b[f][h]-k*m}for(h=0;h<c;h++){d=h;for(e=h+1;e<c;e++)a[e][e]>a[d][d]&&(d=e);if(h!=d)for(m=a[d][d],a[d][d]=a[h][h],a[h][h]=m,e=0;e<c;e++)m=b[d][e],b[d][e]=b[h][e],b[h][e]=m}};Jmat.Real.matrix_random=function(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=Jmat.Real.random()}return c};Jmat.Real.argmax=function(a,b,c){var d=c(a),e=a;for(a+=1;a<b;a++){var f=c(a);f>d&&(d=f,e=a)}return e};/*

License of Jmat.Complex.kiss_fft_ (converted from C to JavaScript):
Kiss FFT
Copyright (c) 2003-2010, Mark Borgerding
All rights reserved.
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
 Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
 Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
 Neither the author nor the names of any contributors may be used to endorse or promote products derived from this software without specific prior written permission.
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
Jmat.Complex=function(a,b){if(this instanceof Jmat.Complex)this.re=a,this.im=b;else return Jmat.Complex.make(a,b)};Jmat.Complex.make=function(a,b){return void 0==a?new Jmat.Complex(0,0):"number"==typeof a?new Jmat.Complex(a,void 0==b?0:b):"string"==typeof a?Jmat.Complex.parse(a):new Jmat.Complex(a.re,a.im)};Jmat.Complex.newr=function(a){return new Jmat.Complex(a,0)};Jmat.Complex.newi=function(a){return new Jmat.Complex(0,a)};
Jmat.Complex.polar=function(a,b){return new Jmat.Complex(a*Math.cos(b),a*Math.sin(b))};Jmat.Complex.polarDeg=function(a,b){b=Jmat.Real.degToRad(b);return new Jmat.Complex(a*Math.cos(b),a*Math.sin(b))};Jmat.Complex.cast=function(a){return a&&void 0!=a.re?a:void 0==a?Jmat.Complex(0):Jmat.Complex(a)};Jmat.Complex.castArray=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=Jmat.Complex.cast(a[c]);return b};Jmat.Complex.copy=function(a){return new Jmat.Complex(a.re,a.im)};
Jmat.Complex.formatFloat_=function(a,b){b=Math.pow(10,b||0);return String(Math.round(a*b)/b)};Jmat.Complex.toString=function(a,b){if(!a)return 0==a?"invalid0":""+a;var c=a.re;a=a.im;!b&&1E-15>Math.abs(c)&&.1<Math.abs(a)&&(c=0);!b&&1E-15>Math.abs(a)&&.1<Math.abs(c)&&(a=0);var d=b?Jmat.Complex.formatFloat_(c,b):""+c;b=b?Jmat.Complex.formatFloat_(a,b):""+a;"1"==b&&(b="");"-1"==b&&(b="-");return 0==a||"0"==b?""+d:0==c?""+b+"i":0>a?""+d+b+"i":""+d+"+"+b+"i"};
Jmat.Complex.prototype.toString=function(a){return Jmat.Complex.toString(this,a)};Jmat.Complex.toStringPolar=function(a,b){if(!a)return 0==a?"invalid0":""+a;var c=b?Jmat.Complex.formatFloat_(a.abs(),b):""+a.abs();a=b?Jmat.Complex.formatFloat_(a.arg(),b):""+a.arg();return""+c+"\u2220"+a};Jmat.Complex.prototype.toStringPolar=function(a){return Jmat.Complex.toStringPolar(this,a)};
Jmat.Complex.toStringPolarDeg=function(a,b){if(!a)return 0==a?"invalid0":""+a;var c=Jmat.Real.radToDeg(a.arg());!b&&1E-10>Math.abs(c-Math.round(c))&&(c=Math.round(c));a=b?Jmat.Complex.formatFloat_(a.abs(),b):""+a.abs();b=b?Jmat.Complex.formatFloat_(c,b):""+c;return""+a+"\u2220"+b+"\u00b0"};Jmat.Complex.prototype.toStringPolarDeg=function(a){return Jmat.Complex.toStringPolarDeg(this,a)};
Jmat.Complex.parse=function(a){var b=a.indexOf("i");if(-1==b)return Jmat.Complex(parseFloat(a));if("i"==a)return Jmat.Complex(0,1);a=a.substr(0,b);a=a.replace(/ /g,"");if("+"==a[b-1]||"-"==a[b-1])a+="1";for(b=1;b<a.length;b++)if(("+"==a[b]||"-"==a[b])&&"e"!=a[b-1]&&"E"!=a[b-1])return Jmat.Complex(parseFloat(a.substr(0,b)),parseFloat(a.substr(b)));return Jmat.Complex(0,parseFloat(a))};Jmat.Complex.ZERO=Jmat.Complex(0);Jmat.Complex.ONE=Jmat.Complex(1);Jmat.Complex.TWO=Jmat.Complex(2);
Jmat.Complex.I=Jmat.Complex.newi(1);Jmat.Complex.PI=Jmat.Complex(Math.PI);Jmat.Complex.E=Jmat.Complex(Math.E);Jmat.Complex.SQRT2=Jmat.Complex(Math.sqrt(2));Jmat.Complex.SQRTPI=Jmat.Complex(Math.sqrt(Math.PI));Jmat.Complex.LOGPI=Jmat.Complex(Math.log(Math.PI));Jmat.Complex.INVSQRT2PI=Jmat.Complex(Jmat.Real.INVSQRT2PI);Jmat.Complex.EM=Jmat.Complex(Jmat.Real.EM);Jmat.Complex.APERY=Jmat.Complex(Jmat.Real.APERY);Jmat.Complex.real=function(a){return Jmat.Complex(a.re)};Jmat.Complex.prototype.real=function(){return Jmat.Complex(this.re)};
Jmat.Complex.imag=function(a){return Jmat.Complex(a.im)};Jmat.Complex.prototype.imag=function(){return Jmat.Complex(this.im)};Jmat.Complex.add=function(a,b){return new Jmat.Complex(a.re+b.re,a.im+b.im)};Jmat.Complex.prototype.add=function(a){return new Jmat.Complex(this.re+a.re,this.im+a.im)};Jmat.Complex.sub=function(a,b){return new Jmat.Complex(a.re-b.re,a.im-b.im)};Jmat.Complex.prototype.sub=function(a){return new Jmat.Complex(this.re-a.re,this.im-a.im)};
Jmat.Complex.mul=function(a,b){if(0==a.im&&0==b.im)return new Jmat.Complex(a.re*b.re,0);if(Jmat.Complex.isInfOrNaN(a)||Jmat.Complex.isInfOrNaN(b)){if(Jmat.Complex.isNaN(a)||Jmat.Complex.isNaN(b))return new Jmat.Complex(NaN,NaN);if(Jmat.Real.isInf(a.re)&&Jmat.Real.isInf(a.im)||Jmat.Real.isInf(b.re)&&Jmat.Real.isInf(b.im))return new Jmat.Complex(Infinity,Infinity)}return new Jmat.Complex(a.re*b.re-a.im*b.im,a.im*b.re+a.re*b.im)};Jmat.Complex.prototype.mul=function(a){return Jmat.Complex.mul(this,a)};
Jmat.Complex.div=function(a,b){if(0==a.im&&0==b.im)return new Jmat.Complex(a.re/b.re,0);if(Jmat.Complex.isInf(a)&&!Jmat.Complex.isInfOrNaN(b))return a;var c=b.re*b.re+b.im*b.im;if((Infinity==c||-Infinity==c)&&!Jmat.Complex.isInfOrNaN(a))return Jmat.Complex(0);if(0==c&&!Jmat.Complex.isInfOrNaN(a)&&(0!=a.re||0!=a.im))return new Jmat.Complex(0==a.re?0:0>a.re?-Infinity:Infinity,0==a.im?0:0>a.im?-Infinity:Infinity);c=1/c;if(1<c){var d=(a.re*b.re+a.im*b.im)*c;a=(a.im*b.re-a.re*b.im)*c}else d=a.re*c*b.re+
a.im*c*b.im,a=a.im*c*b.re-a.re*c*b.im;return new Jmat.Complex(d,a)};Jmat.Complex.prototype.div=function(a){return Jmat.Complex.div(this,a)};Jmat.Complex.addr=function(a,b){return new Jmat.Complex(a.re+b,a.im)};Jmat.Complex.prototype.addr=function(a){return new Jmat.Complex(this.re+a,this.im)};Jmat.Complex.addi=function(a,b){return new Jmat.Complex(a.re,a.im+b)};Jmat.Complex.prototype.addi=function(a){return new Jmat.Complex(this.re,this.im+a)};
Jmat.Complex.subr=function(a,b){return new Jmat.Complex(a.re-b,a.im)};Jmat.Complex.prototype.subr=function(a){return new Jmat.Complex(this.re-a,this.im)};Jmat.Complex.rsub=function(a,b){return new Jmat.Complex(a-b.re,-b.im)};Jmat.Complex.prototype.rsub=function(a){return new Jmat.Complex(a-this.re,-this.im)};Jmat.Complex.subi=function(a,b){return new Jmat.Complex(a.re,a.im-b)};Jmat.Complex.prototype.subi=function(a){return new Jmat.Complex(this.re,this.im-a)};
Jmat.Complex.mulr=function(a,b){return new Jmat.Complex(a.re*b,a.im*b)};Jmat.Complex.prototype.mulr=function(a){return new Jmat.Complex(this.re*a,this.im*a)};Jmat.Complex.muli=function(a,b){return new Jmat.Complex(-a.im*b,a.re*b)};Jmat.Complex.prototype.muli=function(a){return new Jmat.Complex(-this.im*a,this.re*a)};Jmat.Complex.divr=function(a,b){return new Jmat.Complex(a.re/b,a.im/b)};Jmat.Complex.prototype.divr=function(a){return new Jmat.Complex(this.re/a,this.im/a)};
Jmat.Complex.rdiv=function(a,b){return new Jmat.Complex.div(Jmat.Complex(a),b)};Jmat.Complex.prototype.rdiv=function(a){return Jmat.Complex.div(Jmat.Complex(a),this)};Jmat.Complex.divi=function(a,b){return new Jmat.Complex(a.im/b,-a.re/b)};Jmat.Complex.prototype.divi=function(a){return new Jmat.Complex(this.im/a,-this.re/a)};Jmat.Complex.rotate=function(a,b){return 0==b?a:Jmat.Complex.polar(a.abs(),a.arg()+b)};
Jmat.Complex.nextroot=function(a,b){a=Jmat.Complex.rotate(a,2*Math.PI/b);Jmat.Real.near(a.im,0,1E-14)&&(a.im=0);return a};Jmat.Complex.mod=function(a,b){return 0!=a.im||0!=b.im?a.sub(Jmat.Complex.floor(a.div(b)).mul(b)):Jmat.Complex(Jmat.Real.mod(a.re,b.re))};Jmat.Complex.rem=function(a,b){return 0!=a.im||0!=b.im?a.sub(Jmat.Complex.trunc(a.div(b)).mul(b)):Jmat.Complex(a.re%b.re)};Jmat.Complex.wrap=function(a,b,c){return new Jmat.Complex(Jmat.Real.wrap(a.re,b.re,c.re),Jmat.Real.wrap(a.im,b.im,c.im))};
Jmat.Complex.clamp=function(a,b,c){return new Jmat.Complex(Jmat.Real.clamp(a.re,b.re,c.re),Jmat.Real.clamp(a.im,b.im,c.im))};Jmat.Complex.bitneg=function(a){var b=Jmat.Complex(0);b.re=~a.re;b.im=-a.im;return b};Jmat.Complex.bitand=function(a,b){var c=Jmat.Complex(0);c.re=a.re&b.re;c.im=a.im&b.im;return c};Jmat.Complex.bitor=function(a,b){var c=Jmat.Complex(0);c.re=a.re|b.re;c.im=a.im|b.im;return c};Jmat.Complex.bitxor=function(a,b){var c=Jmat.Complex(0);c.re=a.re^b.re;c.im=a.im^b.im;return c};
Jmat.Complex.lshift=function(a,b){var c=Jmat.Complex(0);c.re=a.re<<b.re;c.im=a.im<<b.im;return c};Jmat.Complex.rshift=function(a,b){var c=Jmat.Complex(0);c.re=a.re>>b.re;c.im=a.im>>b.im;return c};Jmat.Complex.neg=function(a){return Jmat.Complex(-a.re,-a.im)};Jmat.Complex.prototype.neg=function(){return Jmat.Complex(-this.re,-this.im)};Jmat.Complex.sign=function(a){return 0==a.im?0==a.re?Jmat.Complex(0):0>a.re?Jmat.Complex(-1):Jmat.Complex(1):a.divr(a.abs())};
Jmat.Complex.csgn=function(a){if(Jmat.Real.near(a.re,0,1E-15)){if(0==a.im)return Jmat.Complex(0);if(0>a.im)return Jmat.Complex(-1)}else{if(0==a.re)return Jmat.Complex(0);if(0>a.re)return Jmat.Complex(-1)}return Jmat.Complex(1)};Jmat.Complex.sign1=function(a){return 0==a.im?0>a.re?Jmat.Complex(-1):Jmat.Complex(1):a.divr(a.abs())};Jmat.Complex.csgn1=function(a){if(Jmat.Real.near(a.re,0,1E-15))return 0>a.im?Jmat.Complex(-1):Jmat.Complex(1);if(0>a.re)return Jmat.Complex(-1);Jmat.Complex(1)};
Jmat.Complex.copysign=function(a,b){return Jmat.Complex.abs(a).mul(Jmat.Complex.sign(b))};Jmat.Complex.conj=function(a){return Jmat.Complex(a.re,-a.im)};Jmat.Complex.prototype.conj=function(){return Jmat.Complex(this.re,-this.im)};Jmat.Complex.eq=function(a,b){return a&&b?a.re==b.re&&a.im==b.im:a==b};Jmat.Complex.prototype.eq=function(a){return a&&this.re==a.re&&this.im==a.im};Jmat.Complex.eqr=function(a,b){return a.re==b&&0==a.im};Jmat.Complex.prototype.eqr=function(a){return this.re==a&&0==this.im};
Jmat.Complex.inv=function(a){return Jmat.Complex.ONE.div(a)};Jmat.Complex.prototype.inv=function(){return Jmat.Complex.ONE.div(this)};Jmat.Complex.inc=function(a){return new Jmat.Complex(a.re+1,a.im)};Jmat.Complex.prototype.inc=function(){return new Jmat.Complex(this.re+1,this.im)};Jmat.Complex.dec=function(a){return new Jmat.Complex(a.re-1,a.im)};Jmat.Complex.prototype.dec=function(){return new Jmat.Complex(this.re-1,this.im)};Jmat.Complex.abs=function(a){return Jmat.Complex(a.abs())};
Jmat.Complex.prototype.abs=function(){return 0==this.im?Math.abs(this.re):0==this.re?Math.abs(this.im):Infinity==this.re||-Infinity==this.re||Infinity==this.im||-Infinity==this.im?Infinity:Jmat.Real.hypot(this.re,this.im)};Jmat.Complex.abssq=function(a){return Jmat.Complex(a.re*a.re+a.im*a.im)};Jmat.Complex.prototype.abssq=function(){return this.re*this.re+this.im*this.im};Jmat.Complex.arg=function(a){return Jmat.Complex(a.arg())};
Jmat.Complex.prototype.arg=function(){return 0==this.im?0>this.re?Math.PI:0:Math.atan2(this.im,this.re)};Jmat.Complex.arg1=function(a){a=a.arg();0>a&&(a+=2*Math.PI);a/=2*Math.PI;0>a&&(a=0);1<a&&(a=1);return a};Jmat.Complex.abs1r=function(a){return Math.abs(a.re)+Math.abs(a.im)};Jmat.Complex.hypot=function(a,b){var c=Jmat.Complex;if(c.abs1r(b)>c.abs1r(a)){var d=a;a=b;b=d}if(c.isInf(a))return Infinity;b=b.div(a);return a.mul(c.sqrt(c.abssq(b).addr(1)))};Jmat.Complex.isReal=function(a){return 0==a.im};
Jmat.Complex.isImaginary=function(a){return 0==a.re};Jmat.Complex.isInt=function(a){return 0==a.im&&Jmat.Real.isInt(a.re)};Jmat.Complex.isGaussian=function(a){return Jmat.Real.isInt(a.re)&&Jmat.Real.isInt(a.im)};Jmat.Complex.isNaN=function(a){return!a||isNaN(a.re)||isNaN(a.im)};Jmat.Complex.isInf=function(a){return Infinity==a.re||-Infinity==a.re||Infinity==a.im||-Infinity==a.im};Jmat.Complex.isInfOrNaN=function(a){return Jmat.Complex.isNaN(a)||Jmat.Complex.isInf(a)};
Jmat.Complex.isPositive=function(a){return 0<a.re&&0==a.im};Jmat.Complex.isNegative=function(a){return 0>a.re&&0==a.im};Jmat.Complex.isPositiveOrZero=function(a){return 0<=a.re&&0==a.im};Jmat.Complex.isNegativeOrZero=function(a){return 0>=a.re&&0==a.im};Jmat.Complex.isPositiveInt=function(a){return Jmat.Complex.isInt(a)&&0<a.re};Jmat.Complex.isNegativeInt=function(a){return Jmat.Complex.isInt(a)&&0>a.re};Jmat.Complex.isPositiveIntOrZero=function(a){return Jmat.Complex.isInt(a)&&0<=a.re};
Jmat.Complex.isNegativeIntOrZero=function(a){return Jmat.Complex.isInt(a)&&0>=a.re};Jmat.Complex.isOdd=function(a){return Jmat.Complex.isInt(a)&&1==Math.abs(a.re%2)};Jmat.Complex.isEven=function(a){return Jmat.Complex.isInt(a)&&0==a.re%2};
Jmat.Complex.pow=function(a,b){var c=Jmat.Complex;if(c.isReal(a)&&c.isReal(b)&&(0<=a.re||Infinity==b.re||-Infinity==b.re||Jmat.Real.isInt(b.re)))return c(Math.pow(a.re,b.re));if(a.eqr(0))return 0==b.re?c(NaN):c(0>b.re?Infinity:0);var d=a.abs(),e=a.arg();a=Math.pow(d,b.re)*Math.exp(-b.im*e);isNaN(a)&&(a=Math.pow(1,b.re/d)*Math.exp(-b.im*e/d),a=0>a?-Infinity:0<a?Infinity:NaN);b=b.im*Math.log(d)+b.re*e;return c(a*Math.cos(b),a*Math.sin(b))};
Jmat.Complex.prototype.pow=function(a){return Jmat.Complex.pow(this,a)};Jmat.Complex.powr=function(a,b){return Jmat.Complex.pow(a,Jmat.Complex(b))};Jmat.Complex.prototype.powr=function(a){return Jmat.Complex.pow(this,Jmat.Complex(a))};Jmat.Complex.rpow=function(a,b){return Jmat.Complex.pow(Jmat.Complex(a),b)};Jmat.Complex.prototype.rpow=function(a){return Jmat.Complex.pow(Jmat.Complex(a),this)};
Jmat.Complex.sin=function(a){if(0==a.im)return Jmat.Complex(Math.sin(a.re));a=Jmat.Complex(-a.im,a.re);a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.sub(b).div(Jmat.Complex(0,2))};Jmat.Complex.sinc=function(a){return a.eqr(0)?Jmat.Complex(1):Jmat.Complex.sin(a).div(a)};Jmat.Complex.cos=function(a){if(0==a.im)return Jmat.Complex(Math.cos(a.re));a=Jmat.Complex(-a.im,a.re);a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.add(b).mulr(.5)};
Jmat.Complex.tan=function(a){if(0==a.im)return Jmat.Complex(Math.tan(a.re));a=Jmat.Complex(-a.im,a.re);a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.sub(b).div(Jmat.Complex(0,2)).div(a.add(b).mulr(.5))};Jmat.Complex.asin=function(a){if(0==a.im&&-1<=a.re&&1>=a.re)return Jmat.Complex(Math.asin(a.re));var b=Jmat.Complex.sqrt(Jmat.Complex.ONE.sub(a.mul(a)));a=Jmat.Complex.log(Jmat.Complex(-a.im,a.re).add(b));return Jmat.Complex(a.im,-a.re)};
Jmat.Complex.acos=function(a){if(0==a.im&&-1<=a.re&&1>=a.re)return Jmat.Complex(Math.acos(a.re));var b=Jmat.Complex.sqrt(Jmat.Complex.ONE.sub(a.mul(a))).mul(Jmat.Complex.I);a=Jmat.Complex.log(a.add(b));return Jmat.Complex(a.im,-a.re)};Jmat.Complex.atan=function(a){if(0==a.im)return Jmat.Complex(Math.atan(a.re));a=Jmat.Complex(-a.im,a.re);a=Jmat.Complex.ONE.sub(a).div(a.inc());a=Jmat.Complex.log(a);return Jmat.Complex(-.5*a.im,.5*a.re)};
Jmat.Complex.atan2=function(a,b){var c=Jmat.Complex;return c.isReal(a)&&c.isReal(b)?(c=c(0),c.re=Math.atan2(a.re,b.re),c):b.eqr(0)?c(Math.PI/2):c.atan(a.div(b))};Jmat.Complex.sinh=function(a){a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.sub(b).divr(2)};Jmat.Complex.cosh=function(a){a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.add(b).divr(2)};
Jmat.Complex.tanh=function(a){if(350<a.re)return Jmat.Complex(1);if(-350>a.re)return Jmat.Complex(-1);a=Jmat.Complex.exp(a);var b=Jmat.Complex.inv(a);return a.sub(b).div(a.add(b))};Jmat.Complex.asinh=function(a){return Jmat.Complex.log(a.add(Jmat.Complex.sqrt(a.mul(a).addr(1))))};Jmat.Complex.acosh=function(a){return Jmat.Complex.log(a.add(Jmat.Complex.sqrt(a.subr(1)).mul(Jmat.Complex.sqrt(a.addr(1)))))};Jmat.Complex.atanh=function(a){return Jmat.Complex.log(a.addr(1).div(a.rsub(1))).mulr(.5)};
Jmat.Complex.logsin=function(a){if(-10<a.im&&10>a.im)return Jmat.Complex.log(Jmat.Complex.sin(a));var b=Jmat.Complex(.69314718056,1.570796326795),c=Jmat.Complex(Jmat.Real.wrap(a.re,-Math.PI/2,3*Math.PI/2),a.im);return 0<a.im?Jmat.Complex.newi(Jmat.Complex.PI).sub(Jmat.Complex.I.mul(c)).sub(b):Jmat.Complex.I.mul(c).sub(b)};Jmat.Complex.logcos=function(a){return Jmat.Complex.logsin(a.rsub(Math.PI/2))};Jmat.Complex.floor=function(a){var b=Jmat.Complex(0);b.re=Math.floor(a.re);b.im=Math.floor(a.im);return b};
Jmat.Complex.ceil=function(a){var b=Jmat.Complex(0);b.re=Math.ceil(a.re);b.im=Math.ceil(a.im);return b};Jmat.Complex.round=function(a){var b=Jmat.Complex(0);b.re=Jmat.Real.round(a.re);b.im=Jmat.Real.round(a.im);return b};Jmat.Complex.trunc=function(a){var b=Jmat.Complex(0);b.re=0>a.re?Math.ceil(a.re):Math.floor(a.re);b.im=0>a.im?Math.ceil(a.im):Math.floor(a.im);return b};Jmat.Complex.frac=function(a){return Jmat.Complex(Jmat.Real.frac(a.re),Jmat.Real.frac(a.im))};
Jmat.Complex.fracn=function(a){return Jmat.Complex(Jmat.Real.fracn(a.re),Jmat.Real.fracn(a.im))};Jmat.Complex.lerp=function(a,b,c){return c.rsub(1).mul(a).add(c.mul(b))};Jmat.Complex.exp=function(a){if(0==a.im)return Jmat.Complex(Math.exp(a.re));var b=Math.exp(a.re);return new Jmat.Complex(b*Math.cos(a.im),b*Math.sin(a.im))};Jmat.Complex.expm1=function(a){return 1E-5>a.abssq()?a.add(a.mul(a).divr(2)).add(a.mul(a).mul(a).divr(6)):Jmat.Complex.exp(a).subr(1)};
Jmat.Complex.log=function(a){return a.eqr(-Infinity)?Jmat.Complex(Infinity):Jmat.Complex.isReal(a)&&0<=a.re?Jmat.Complex(Math.log(a.re)):Jmat.Complex(Math.log(a.abs()),a.arg())};Jmat.Complex.log1p=function(a){return 1E-8>a.abssq()?a.mulr(-.5).addr(1).mul(a):Jmat.Complex.log(a.addr(1))};Jmat.Complex.logy=function(a,b){return Jmat.Complex.log(a).div(Jmat.Complex.log(b))};Jmat.Complex.logr=function(a,b){return Jmat.Complex.log(a).divr(Math.log(b))};Jmat.Complex.log2=function(a){return Jmat.Complex.log(a).divr(Math.LN2)};
Jmat.Complex.log10=function(a){return Jmat.Complex.log(a).divr(Math.LN10)};Jmat.Complex.sqrt=function(a){if(Jmat.Complex.isReal(a)){var b=Jmat.Complex(0);0<=a.re||a.re!=a.re?b.re=Math.sqrt(a.re):b.im=Math.sqrt(-a.re);return b}return a.pow(Jmat.Complex(.5))};Jmat.Complex.root=function(a,b){return a.pow(Jmat.Complex(Jmat.Complex.inv(b)))};Jmat.Complex.rootr=function(a,b){return a.pow(Jmat.Complex(1/b))};Jmat.Complex.toInt=function(a){return Math.round(a.re)};
Jmat.Complex.infNormalize=function(a){return Jmat.Complex.isNaN(a)?Jmat.Complex(NaN):Infinity==a.re?Infinity==a.im?Jmat.Complex(1,1):-Infinity==a.im?Jmat.Complex(1,-1):Jmat.Complex(1,0):-Infinity==a.re?Infinity==a.im?Jmat.Complex(-1,1):-Infinity==a.im?Jmat.Complex(-1,-1):Jmat.Complex(-1,0):Infinity==a.im?Infinity==a.re?Jmat.Complex(1,1):-Infinity==a.re?Jmat.Complex(-1,1):Jmat.Complex(0,1):-Infinity==a.im?Infinity==a.re?Jmat.Complex(1,-1):-Infinity==a.re?Jmat.Complex(-1,-1):Jmat.Complex(0,-1):a.divr(a.abs())};
Jmat.Complex.calcCache_=function(a,b,c,d){if(d){for(var e=0;e<d;e++)if(a.eq(c[2*e+1]))return c[2*e+2];e=c[0]||0;e++;e>=d&&(e=0);b=b(a);c[2*e+1]=a;c[2*e+2]=b;c[0]=e}else{if(a.eq(c[0]))return c[1];b=b(a);c[0]=a;c[1]=b}return b};
Jmat.Complex.loggamma_=function(a){var b=Jmat.Complex;if(a.eqr(1)||a.eqr(2))return b(0);if(Infinity==a.re)return b(Infinity);if(-Infinity==a.re)return b(NaN);if(0>a.re){if(0==a.im&&a.re==Math.floor(a.re))return b(Infinity);if(110<a.im||-110>a.im)return b.log(b.newi(2*Math.PI)).sub(b.newi(-Math.PI).mul(0<a.im?a:a.neg())).sub(b.loggamma_(b.ONE.sub(a)));if(-.5>a.re&&Jmat.Real.isInt((2*a.re+1)/4))return b.loggamma_(a.addr(1)).sub(b.log(a));var c=b.log(a.neg()),d=b.log(b.sin(a.mulr(Math.PI))),e=b.loggamma_(a.neg());
c=b.LOGPI.sub(c).sub(d).sub(e);-.5>a.re&&(d=Math.floor((2*a.re+1)/4),0==a.im&&(d=Math.floor((2*a.re+2)/4)),b=new b(0,2*Math.PI*d),c=c.add(b.mulr(0==a.im?-Math.sign(a.re):Math.sign(a.im))));return c}if(10>a.re)return c=b.loggamma_(a.addr(1)),c=c.sub(b.log(a));c=b(.918938533205);c=c.add(b.subr(a,.5).mul(b.log(a)));c=c.sub(a);c=c.add(a.mulr(12).inv());c=c.sub(b.powr(a,3).mulr(360).inv());c=c.add(b.powr(a,5).mulr(1260).inv());c=c.sub(b.powr(a,7).mulr(1680).inv());return c=c.add(b.powr(a,9).mulr(1188).inv())};
Jmat.Complex.gamma=function(a){var b=Jmat.Complex;if(Infinity==a.re&&0==a.im)return b(Infinity,0);if(-Infinity==a.re)return b(NaN);if(b.isNegativeIntOrZero(a))return b(Infinity,Infinity);if(0==a.im)return b(Jmat.Real.gamma(a.re));if(.5>a.re){var c=b.PI.div(b.sin(b.PI.mul(a))).div(b.gamma(b.ONE.sub(a)));b.isNaN(c)&&(c=b(0));return c}if(50<a.re)return b.exp(b.loggamma_(a));var d=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,
9.984369578019572E-6,1.5056327351493116E-7];a=a.subr(1);c=b(d[0]);for(var e=1;9>e;e++)c=c.add(b(d[e]).div(a.addr(e)));var f=a.addr(7.5);d=Math.sqrt(2*Math.PI);e=f.pow(a.addr(.5));if(b.isInf(e))return e=b.log(f).mul(a.addr(.5)),a=f.neg(),c=e.add(a).add(c).addr(d),b.exp(c);a=b.exp(f.neg());return c=e.mul(a).mul(c).mulr(d)};Jmat.Complex.factorial=function(a){return Jmat.Complex.gamma(Jmat.Complex.inc(a))};Jmat.Complex.isPrime=function(a){return Jmat.Complex.isReal(a)?Jmat.Real.isPrime(a.re):0};
Jmat.Complex.decompose=function(a,b){if(Math.abs(a.re)>=Math.abs(a.im))return b=Jmat.Real.decompose(a.re,b),[Jmat.Complex(b[0],Math.round(a.im*b[1])),Jmat.Complex(b[1])];b=Jmat.Real.decompose(a.im,b);return[Jmat.Complex(Math.round(a.re*b[1]),b[0]),Jmat.Complex(b[1])]};Jmat.Complex.near=function(a,b,c){c=void 0==c?1E-15:c;return a.re-c<=b.re&&a.re+c>=b.re&&a.im-c<=b.im&&a.im+c>=b.im};Jmat.Complex.nearr=function(a,b,c){c=void 0==c?1E-15:c;return a.re-c<=b&&a.re+c>=b&&0>=a.im-c&&0<=a.im+c};
Jmat.Complex.dist=function(a,b){return a.sub(b).abs()};Jmat.Complex.cheb=function(a,b){return Math.max(Jmat.Real.dist(a.re,b.re),Jmat.Real.dist(a.im,b.im))};Jmat.Complex.manhattan=function(a,b){return Math.max(Math.abs(a.re-b.re),Math.abs(a.im-b.im))};Jmat.Complex.relnear=function(a,b,c){return a.eq(b)?!0:a.sub(b).abs()<Math.max(a.abs(),b.abs())*c};
Jmat.Complex.lambertwb_generic_=function(a,b,c){if(a.isReal(c)&&-.36<c.re&&0==b)return a(Jmat.Real.lambertw(c));if(!Jmat.Real.isInt(b))return a(NaN);if(a.isNaN(c))return NaN;if(a.isInf(c))return a(Infinity);if(0==b&&c.eqr(0))return a(0);if(0!=b&&c.eqr(0))return a(-Infinity);var d=a.log(c).add(a(0,b*Math.PI*2));0==b&&1.2>c.abs()&&(d=a.sqrt(c.mulr(5.43656365691809).addr(2)).add(a(-1,b*Math.PI*2)));0!=b&&0==c.im&&(c.im+=1E-14);for(b=0;36>b;b++){var e=a.exp(d),f=d.mul(e),g=f.sub(c);e=e.mul(d.addr(1));
var h=d.addr(2).mul(g).div(d.mulr(2).addr(2));d=d.sub(g.div(e.sub(h)));g=a.log(c.div(d));if(a.near(g,d,1E-16)||a.near(f,c,1E-16))break;if(36==b+1&&!a.near(g,d,1)&&!a.near(f,c,1))return a(NaN)}0==c.im&&0<=c.re&&(d.im=0);return d};Jmat.Complex.lambertwb=function(a,b){return Jmat.Complex.lambertwb_generic_(Jmat.Complex,a,b)};Jmat.Complex.lambertw=function(a){return Jmat.Complex.lambertwb(0,a)};Jmat.Complex.lambertwm=function(a){return Jmat.Complex.lambertwb(-1,a)};
Jmat.Complex.faddeeva=function(a){a=Jmat.Real.faddeeva(a.re,a.im);return Jmat.Complex(a[0],a[1])};Jmat.Complex.erfcx=function(a){return Jmat.Complex.faddeeva(Jmat.Complex(-a.im,a.re))};Jmat.Complex.erf=function(a){var b=Jmat.Complex.exp(a.mul(a).neg());b=0<=a.re?Jmat.Complex.ONE.sub(b.mul(Jmat.Complex.faddeeva(a.mul(Jmat.Complex.I)))):b.mul(Jmat.Complex.faddeeva(a.mul(Jmat.Complex.I.neg()))).sub(Jmat.Complex.ONE);0==a.re&&(b.re=0);return b};
Jmat.Complex.erfc=function(a){var b=Jmat.Complex.exp(a.mul(a));return 0<=a.re?Jmat.Complex.faddeeva(a.mul(Jmat.Complex.I)).div(b):Jmat.Complex.TWO.sub(Jmat.Complex.faddeeva(a.mul(Jmat.Complex.I.neg())).div(b))};Jmat.Complex.erfi=function(a){return Jmat.Complex.erf(a.mul(Jmat.Complex.I)).mul(Jmat.Complex.I).neg()};Jmat.Complex.dawson=function(a){var b=Jmat.Complex.faddeeva(a);return Jmat.Complex.exp(a.mul(a).neg()).sub(b).mul(Jmat.Complex.I.mulr(Jmat.Real.SQRTPI/2))};
Jmat.Complex.random=function(a,b){a=void 0==a?0:a;return Jmat.Complex.polar(Math.random()*((void 0==b?1:b)-a)+a,Math.random()*Math.PI*2)};
Jmat.Complex.kiss_fft_=function(a,b,c){var d=function(a,b){this.nfft=a;this.inverse=b;this.factors=[];this.twiddles=[]},e=function(a,b,c,d,l,m,n,p,q){var f=n[p+0],g=n[p+1],h=0;if(1==g)for(var k=0;k<f*g;k++)a[k+b]=Jmat.Complex(c[d+h]),h+=l*m;else for(k=0;k<f*g;k+=g)e(a,b+k,c,d+h,l*f,m,n,p+2,q),h+=l*m;switch(f){case 2:for(c=f=0;c<g;c++)d=a[b+c+g].mul(q.twiddles[f]),f+=l,a[b+c+g]=a[b+c].sub(d),a[b+c]=a[b+c].add(d);break;case 3:f=2*g;d=c=0;m=[];n=q.twiddles[l*g];for(p=0;p<g;p++)m[1]=a[b+p+g].mul(q.twiddles[c]),
m[2]=a[b+p+f].mul(q.twiddles[d]),m[3]=m[1].add(m[2]),m[0]=m[1].sub(m[2]),c+=l,d+=2*l,a[b+p+g].re=a[b+p].re-m[3].re/2,a[b+p+g].im=a[b+p].im-m[3].im/2,m[0]=m[0].mulr(n.im),a[b+p]=a[b+p].add(m[3]),a[b+p+f].re=a[b+p+g].re+m[0].im,a[b+p+f].im=a[b+p+g].im-m[0].re,a[b+p+g].re-=m[0].im,a[b+p+g].im+=m[0].re;break;case 4:f=[];c=2*g;d=3*g;for(h=p=n=m=0;h<g;h++)f[0]=a[b+h+g].mul(q.twiddles[m]),f[1]=a[b+h+c].mul(q.twiddles[n]),f[2]=a[b+h+d].mul(q.twiddles[p]),f[5]=a[b+h].sub(f[1]),a[b+h]=a[b+h].add(f[1]),f[3]=
f[0].add(f[2]),f[4]=f[0].sub(f[2]),a[b+h+c]=a[b+h].sub(f[3]),m+=l,n+=2*l,p+=3*l,a[b+h]=a[b+h].add(f[3]),q.inverse?(a[b+h+g].re=f[5].re-f[4].im,a[b+h+g].im=f[5].im+f[4].re,a[b+h+d].re=f[5].re+f[4].im,a[b+h+d].im=f[5].im-f[4].re):(a[b+h+g].re=f[5].re+f[4].im,a[b+h+g].im=f[5].im-f[4].re,a[b+h+d].re=f[5].re-f[4].im,a[b+h+d].im=f[5].im+f[4].re);break;case 5:f=[];c=q.twiddles[l*g];d=q.twiddles[2*l*g];m=2*g;n=3*g;p=4*g;for(h=0;h<g;++h)f[0]=Jmat.Complex(a[b+h]),f[1]=a[b+g+h].mul(q.twiddles[h*l]),f[2]=a[b+
m+h].mul(q.twiddles[2*h*l]),f[3]=a[b+n+h].mul(q.twiddles[3*h*l]),f[4]=a[b+p+h].mul(q.twiddles[4*h*l]),f[7]=f[1].add(f[4]),f[10]=f[1].sub(f[4]),f[8]=f[2].add(f[3]),f[9]=f[2].sub(f[3]),a[b+h].re+=f[7].re+f[8].re,a[b+h].im+=f[7].im+f[8].im,f[5]=Jmat.Complex(0),f[5].re=f[0].re+f[7].re*c.re+f[8].re*d.re,f[5].im=f[0].im+f[7].im*c.re+f[8].im*d.re,f[6]=Jmat.Complex(0),f[6].re=f[10].im*c.im+f[9].im*d.im,f[6].im=-f[10].re*c.im-f[9].re*d.im,a[b+g+h]=f[5].sub(f[6]),a[b+p+h]=f[5].add(f[6]),f[11]=Jmat.Complex(0),
f[11].re=f[0].re+f[7].re*d.re+f[8].re*c.re,f[11].im=f[0].im+f[7].im*d.re+f[8].im*c.re,f[12]=Jmat.Complex(0),f[12].re=-f[10].im*d.im+f[9].im*c.im,f[12].im=f[10].re*d.im-f[9].re*c.im,a[b+m+h]=f[11].add(f[12]),a[b+n+h]=f[11].sub(f[12]);break;default:for(h=q.nfft,k=[],c=0;c<g;++c){d=c;for(m=0;m<f;++m)k[m]=Jmat.Complex(a[b+d]),d+=g;d=c;for(m=0;m<f;++m){var w=0;a[b+d]=k[0];for(n=1;n<f;++n)w+=l*d,w>=h&&(w-=h),p=k[n].mul(q.twiddles[w]),a[b+d]=a[b+d].add(p);d+=g}}}};c=function(a,b){b=new d(a,b);for(var c=
0;c<a;++c){var e=2*-Math.PI*c/a;b.inverse&&(e*=-1);b.twiddles[c]=new Jmat.Complex(Math.cos(e),Math.sin(e))}c=b.factors;e=0;var f=4,g=Math.floor(Math.sqrt(a));do{for(;0!=a%f;){switch(f){case 4:f=2;break;case 2:f=3;break;default:f+=2}f>g&&(f=a)}a=Math.floor(a/f);c[e+0]=f;c[e+1]=a;e+=2}while(1<a);return b}(a.length,c);e(b,0,a,0,1,1,c.factors,0,c)};
Jmat.Complex.fft=function(a,b){for(var c=[],d=0;d<a.length;d++)c[d]=Jmat.Complex(0);Jmat.Complex.kiss_fft_(a,c,b);b=1/Math.sqrt(a.length);for(d=0;d<a.length;d++)c[d]=c[d].mulr(b);return c};/*

License of Jmat.Matrix.zsvdc_: this function is from linpack, from http://www.netlib.org/linpack/
The license is not mentioned directly in the source code or the website, but
has been said to now be a variant of the BSD license: see
https://bugzilla.redhat.com/show_bug.cgi?id=1000829.
Here is the original author comment from zsvdc.f:
    linpack. this version dated 03/19/79 .
             correction to shift calculation made 2/85.
    g.w. stewart, university of maryland, argonne national lab.
*/
Jmat.Matrix=function(a,b,c){if(this instanceof Jmat.Matrix){this.h=a;this.w=b;this.e=[];for(var d=0;d<a;d++)this.e[d]=[]}else return Jmat.Matrix.make.apply(this,arguments)};
Jmat.Matrix.make=function(a,b,c){if(!a)return new Jmat.Matrix(0,0);if(a instanceof Jmat.Matrix)return Jmat.Matrix.copy(a);if("string"==typeof a)return Jmat.Matrix.parse(a);if(a.constructor===Array&&void 0!=b)throw"no further arguments needed if first is array. Use 2D array if first is array, or otherwise w and h first";var d=function(a,b,c){return a&&void 0!=a[b]?Jmat.Real.cast(Array.isArray(a[b])?a[b][c]:a[b]):0},e=function(a){return a&&void 0!=a[0]?void 0==a[0].length?1:a[0].length:0},f=function(a,
b,c,e,f){if(0<=e&&c.length<a*b){var g=Jmat.Matrix.zero(a,b);if(0<=e&&1==c.length-e){for(var h=0;h<b&&h<a;h++)g.e[h][h]=Jmat.Complex.cast(c[e]);return g}if(0<=e&&c.length-e==Math.min(a,b)){for(h=0;h<b&&h<a;h++)g.e[h][h]=Jmat.Complex.cast(c[h+e]);return g}return null}g=new Jmat.Matrix(a,b);for(a=0;a<g.h;a++)for(h=0;h<g.w;h++)if(0>e){var k=g.e[a],l=h;if(f){var m=f;var n=a,w=h;m=new Jmat.Complex(d(c,n,w),d(m,n,w))}else m=c,n=a,w=h,m=m&&void 0!=m[n]?Jmat.Complex.cast(Array.isArray(m[n])?m[n][w]:m[n]):
Jmat.Complex();k[l]=m}else g.e[a][h]=Jmat.Complex.cast(c[a*b+h+e]);return g};if("undefined"!==typeof a&&a.length||"undefined"!==typeof b&&b.length){var g=Math.max(a&&a.length||0,b&&b.length||0);e=Math.max(e(a),e(b));return f(g,e,a,-1,b)}if(void 0!=a&&void 0==b)return f=new Jmat.Matrix(1,1),f.e[0][0]=Jmat.Complex.cast(a),f;if(void 0!=a&&void 0!=b){if(void 0==c)return new Jmat.Matrix(a,b);g=a;e=b;return c&&c.length?f(g,e,c,0):f(g,e,arguments,2)}return new Jmat.Matrix(0,0)};
Jmat.Matrix.toString=function(a,b){if(!a)return""+a;for(var c="[",d=0;d<a.h;d++){c+="[";for(var e=0;e<a.w;e++)c+=Jmat.Complex.toString(a.e[d][e],b),e+1<a.w&&(c+=", ");c+="]";d+1<a.h&&(c+=", ")}return c+"]"};Jmat.Matrix.prototype.toString=function(a){return Jmat.Matrix.toString(this,a)};Jmat.Matrix.toCurly=function(a,b){return Jmat.Matrix.toString(a,b).replace(/\[/g,"{").replace(/\]/g,"}")};Jmat.Matrix.prototype.toCurly=function(a){return Jmat.Matrix.toCurly(this,a)};
Jmat.Matrix.toSemi=function(a,b){if(!a)return""+a;for(var c="[",d=0;d<a.h;d++){for(var e=0;e<a.w;e++)c+=Jmat.Complex.toString(a.e[d][e],b),e+1<a.w&&(c+=" ");d+1<a.h&&(c+="; ")}return c+"]"};Jmat.Matrix.prototype.toSemi=function(a){return Jmat.Matrix.toSemi(this,a)};
Jmat.Matrix.parse=function(a){for(var b=[],c=[b],d="",e=1;e<a.length-1&&0<c.length;e++){var f=a.charAt(e);"["==f?(f=[],c[c.length-1].push(f),c.push(f)):"]"==f?(""!=d&&(c[c.length-1].push(Jmat.Complex.parse(d)),d=""),c.pop()):","==f?""!=d&&(c[c.length-1].push(Jmat.Complex.parse(d)),d=""):d+=f}""!=d&&c[c.length-1].push(Jmat.Complex.parse(d));return Jmat.Matrix.make(b)};
Jmat.Matrix.render=function(a,b){if(!a)return""+a;if(!Jmat.Matrix.isValid(a)){a=Jmat.Matrix.copy(a);for(var c=0;c<a.h;c++)for(var d=0;d<a.w;d++)a.e[c][d]||(a.e[c][d]=Jmat.Complex(NaN))}b=void 0==b?Jmat.Matrix.isInteger(a)?0:3:b;var e="",f=Jmat.Matrix.isReal(a),g=[],h=[];for(c=0;c<a.h;c++)for(g.push([]),d=0;d<a.w;d++){0==c&&h.push([0,0]);var k=[a.e[c][d].re.toFixed(b),Math.abs(a.e[c][d].im).toFixed(b)];h[d]=[Math.max(k[0].length,h[d][0]),Math.max(k[1].length,h[d][1])];g[c].push(k)}for(c=0;c<a.h;c++){b=
"";b+="|"+(c+1==a.h?"_":" ");for(d=0;d<a.w;d++){for(k=g[c][d][0];k.length<h[d][0];)k=" "+k;if(!f){for(var l=0>a.e[c][d].im,m=g[c][d][1];m.length<h[d][1];)m="0"+m;m=(l?"-":"+")+m;k+=m+"i"}b+=k+(c+1==a.h&&d+1==a.w?"_":" ")}b+="|";if(0==c){for(d=" _";d.length+2<b.length;)d+=" ";d+="_";e+=d+"\n"}e+=b+"\n"}return e};Jmat.Matrix.prototype.render=function(a){return Jmat.Matrix.render(this,a)};Jmat.Matrix.cast=function(a){return a instanceof Jmat.Matrix?a:Jmat.Matrix.make(a)};
Jmat.Matrix.copy=function(a){for(var b=new Jmat.Matrix(a.h,a.w),c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b.e[c][d]=a.e[c][d]?Jmat.Complex(a.e[c][d].re,a.e[c][d].im):a.e[c][d];return b};Jmat.Matrix.identity=function(a,b){b=b||a;for(var c=new Jmat.Matrix(a,b),d=0;d<a;d++)for(var e=0;e<b;e++)c.e[d][e]=Jmat.Complex(e==d?1:0);return c};Jmat.Matrix.zero=function(a,b){b=b||a;for(var c=new Jmat.Matrix(a,b),d=0;d<a;d++)for(var e=0;e<b;e++)c.e[d][e]=Jmat.Complex(0);return c};
Jmat.Matrix.add=function(a,b){if(a.w!=b.w||a.h!=b.h)return null;for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].add(b.e[d][e]);return c};Jmat.Matrix.prototype.add=function(a){return Jmat.Matrix.add(this,a)};Jmat.Matrix.sub=function(a,b){if(a.w!=b.w||a.h!=b.h)return null;for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].sub(b.e[d][e]);return c};Jmat.Matrix.prototype.sub=function(a){return Jmat.Matrix.sub(this,a)};
Jmat.Matrix.n3mul_=function(a,b){if(a.w!=b.h)return null;for(var c=new Jmat.Matrix(a.h,b.w),d=0;d<a.h;d++)for(var e=0;e<b.w;e++){for(var f=Jmat.Complex(0),g=0;g<a.w;g++)f=f.add(a.e[d][g].mul(b.e[g][e]));c.e[d][e]=f}return c};Jmat.Matrix.n3mul_nocache_=function(a,b){if(a.w!=b.h)return null;for(var c=new Jmat.Matrix(a.h,b.w),d=0;d<a.h;d++)for(var e=0;e<b.w;e++){for(var f=Jmat.Complex(0),g=0;g<a.w;g++)f=f.add(a.e[d][g].mul(b.e[g][e]));c.e[d][e]=f}return c};
Jmat.Matrix.n3mul_=function(a,b){if(a.w!=b.h)return null;for(var c=new Jmat.Matrix(a.h,b.w),d=[],e=0;e<b.w;e++){for(var f=0;f<a.w;f++)d[f]=b.e[f][e];for(var g=0;g<a.h;g++){var h=Jmat.Complex(0);for(f=0;f<a.w;f++)h=h.add(a.e[g][f].mul(d[f]));c.e[g][e]=h}}return c};Jmat.Matrix.n3mul_transpose_=function(a,b){if(a.w!=b.w)return null;for(var c=new Jmat.Matrix(a.h,b.h),d=0;d<a.h;d++)for(var e=0;e<b.h;e++){for(var f=Jmat.Complex(0),g=0;g<a.w;g++)f=f.add(a.e[d][g].mul(b.e[e][g]));c.e[d][e]=f}return c};
Jmat.Matrix.strassen_=function(a,b){var c=Jmat.Matrix;if(a.w!=b.h)return null;if(2>a.w||2>a.h||2>b.w)return c.n3mul_(a,b);var d=Math.min(a.h,Math.min(a.w,b.w));d&1&&d--;var e=Math.floor(d/2),f=c.submatrix(a,0,e,0,e),g=c.submatrix(a,0,e,e,2*e),h=c.submatrix(a,e,2*e,0,e),k=c.submatrix(a,e,2*e,e,2*e),l=c.submatrix(b,0,e,0,e),m=c.submatrix(b,0,e,e,2*e),n=c.submatrix(b,e,2*e,0,e),p=c.submatrix(b,e,2*e,e,2*e);e=f.add(k).mul(l.add(p));var q=h.add(k).mul(l),t=f.mul(m.sub(p)),v=k.mul(n.sub(l)),y=f.add(g).mul(p);
f=h.sub(f).mul(l.add(m));g=g.sub(k).mul(n.add(p));g=e.add(v).sub(y).add(g);y=t.add(y);v=q.add(v);q=e.sub(q).add(t).add(f);e=c(a.h,b.w);c.insertInPlace(e,g,0,0);c.insertInPlace(e,y,0,g.w);c.insertInPlace(e,v,g.h,0);c.insertInPlace(e,q,g.h,g.w);if(d!=a.w||d!=a.h||d!=b.w)for(c=[],q=0;q<b.w;q++){for(y=0;y<a.w;y++)c[y]=b.e[y][q];for(t=0;t<a.h;t++){v=Jmat.Complex(0);y=0;for(q<d&&t<d?y=d:e.e[t][q]=Jmat.Complex(0);y<a.w;y++)v=v.add(a.e[t][y].mul(c[y]));e.e[t][q]=e.e[t][q].add(v)}}return e};
Jmat.Matrix.mul=function(a,b){return 350>Math.min(a.w,Math.min(a.h,b.w))?Jmat.Matrix.n3mul_(a,b):Jmat.Matrix.strassen_(a,b)};Jmat.Matrix.prototype.mul=function(a){return Jmat.Matrix.mul(this,a)};Jmat.Matrix.mulT=function(a,b){return 500>Math.min(a.w,Math.min(a.h,b.h))?Jmat.Matrix.n3mul_transpose_(a,b):Jmat.Matrix.strassen_(a,b.transpose())};Jmat.Matrix.prototype.mulT=function(a){return Jmat.Matrix.mulT(this,a)};Jmat.Matrix.mulTG=function(a,b){return Jmat.Matrix.mulT(a,b.conj())};
Jmat.Matrix.prototype.mulTG=function(a){return Jmat.Matrix.mulTG(this,a)};Jmat.Matrix.mulc=function(a,b){for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].mul(b);return c};Jmat.Matrix.prototype.mulc=function(a){return Jmat.Matrix.mulc(this,a)};Jmat.Matrix.mulr=function(a,b){for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].mulr(b);return c};Jmat.Matrix.prototype.mulr=function(a){return Jmat.Matrix.mulr(this,a)};
Jmat.Matrix.elmul=function(a,b){if(a.w!=b.w||a.h!=b.h)return null;for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].mul(b.e[d][e]);return c};Jmat.Matrix.div=function(a,b){if(a.w!=b.h)return null;var c=new Jmat.Matrix(a.h,b.w);b=Jmat.Matrix.inv(b);for(var d=0;d<a.h;d++)for(var e=0;e<b.w;e++){for(var f=Jmat.Complex(0),g=0;g<a.w;g++)f=f.add(a.e[d][g].mul(b.e[g][e]));c.e[d][e]=f}return c};Jmat.Matrix.prototype.div=function(a){return Jmat.Matrix.div(this,a)};
Jmat.Matrix.eldiv=function(a,b){if(a.w!=b.w||a.h!=b.h)return null;for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].div(b.e[d][e]);return c};Jmat.Matrix.leftdiv=function(a,b){if(a.w!=b.h)return null;var c=new Jmat.Matrix(a.h,b.w);b=Jmat.Matrix.inv(b);for(var d=0;d<b.h;d++)for(var e=0;e<a.w;e++){for(var f=Jmat.Complex(0),g=0;g<b.w;g++)f=f.add(b.e[d][g].mul(a.e[g][e]));c.e[d][e]=f}return c};
Jmat.Matrix.prototype.leftdiv=function(a){return Jmat.Matrix.leftdiv(this,a)};Jmat.Matrix.divc=function(a,b){for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].div(b);return c};Jmat.Matrix.prototype.divc=function(a){return Jmat.Matrix.divc(this,a)};Jmat.Matrix.divr=function(a,b){for(var c=new Jmat.Matrix(a.h,a.w),d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d][e].divr(b);return c};Jmat.Matrix.prototype.divr=function(a){return Jmat.Matrix.divr(this,a)};
Jmat.Matrix.isReal=function(a){for(var b=0;b<a.h;b++)for(var c=0;c<a.w;c++)if(0!=a.e[b][c].im)return!1;return!0};Jmat.Matrix.isValid=function(a){if(!(a&&a.w&&a.h&&a.e&&a.e.length))return!1;for(var b=0;b<a.h;b++)for(var c=0;c<a.w;c++){var d=a.e[b][c];if(d){if(Infinity==d.re||-Infinity==d.re||d.re!=d.re||Infinity==d.im||-Infinity==d.im||d.im!=d.im)return!1}else return!1}return!0};Jmat.Matrix.isNaN=function(a){for(var b=0;b<a.h;b++)for(var c=0;c<a.w;c++)if(Jmat.Complex.isNaN(a.e[b][c]))return!0;return!1};
Jmat.Matrix.isInfOrNaN=function(a){for(var b=0;b<a.h;b++)for(var c=0;c<a.w;c++)if(Jmat.Complex.isInfOrNaN(a.e[b][c]))return!0;return!1};Jmat.Matrix.isSquare=function(a){return a.w==a.h};Jmat.Matrix.DEFPROPEPS=1E-14;Jmat.Matrix.isSingular=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;var c=Jmat.Matrix.conditionNumber(a);return Jmat.Matrix.isSquare(a)&&c.abs()>=1/b};
Jmat.Matrix.isInvertible=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;return Jmat.Matrix.isSquare(a)&&!Jmat.Matrix.isSingular(a,b)};Jmat.Matrix.isIdentity=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=0;d<a.w;d++)if(!Jmat.Complex.nearr(a.e[c][d],d==c?1:0,b))return!1;return!0};
Jmat.Matrix.isDiagonal=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=0;d<a.w;d++)if(d!=c&&!Jmat.Complex.nearr(a.e[c][d],0,b))return!1;return!0};Jmat.Matrix.isZero=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;for(var c=0;c<a.h;c++)for(var d=0;d<a.w;d++)if(!Jmat.Complex.nearr(a.e[c][d],0,b))return!1;return!0};
Jmat.Matrix.isSymmetric=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=c+1;d<a.w;d++)if(!Jmat.Complex.near(a.e[c][d],a.e[d][c],b))return!1;return!0};Jmat.Matrix.isHermitian=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=c;d<a.w;d++)if(!Jmat.Complex.near(a.e[c][d],Jmat.Complex.conj(a.e[d][c]),b))return!1;return!0};
Jmat.Matrix.isSkewSymmetric=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=c;d<a.w;d++)if(!Jmat.Complex.near(a.e[c][d],Jmat.Complex.neg(a.e[d][c]),b))return!1;return!0};Jmat.Matrix.isSkewHermitian=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=c;d<a.w;d++)if(!Jmat.Complex.near(a.e[c][d],Jmat.Complex.conj(a.e[d][c]).neg(),b))return!1;return!0};
Jmat.Matrix.isUpperTriangular=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=0;d<c;d++)if(!Jmat.Complex.nearr(a.e[c][d],0,b))return!1;return!0};Jmat.Matrix.isLowerTriangular=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=c+1;d<a.w;d++)if(!Jmat.Complex.nearr(a.e[c][d],0,b))return!1;return!0};
Jmat.Matrix.isStrictlyUpperTriangular=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=0;d<=c;d++)if(!Jmat.Complex.nearr(a.e[c][d],0,b))return!1;return!0};Jmat.Matrix.isStrictlyLowerTriangular=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=c;d<a.w;d++)if(!Jmat.Complex.nearr(a.e[c][d],0,b))return!1;return!0};
Jmat.Matrix.isUpperUnitriangular=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isUpperTriangular(a))return!1;for(var c=0;c<a.h;c++)if(!Jmat.Complex.nearr(a.e[c][c],1,b))return!1;return!0};Jmat.Matrix.isLowerUnitriangular=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isLowerTriangular(a))return!1;for(var c=0;c<a.h;c++)if(!Jmat.Complex.nearr(a.e[c][c],1,b))return!1;return!0};
Jmat.Matrix.isUpperHessenberg=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=0;d+1<c;d++)if(!Jmat.Complex.nearr(a.e[c][d],0,b))return!1;return!0};Jmat.Matrix.isLowerHessenberg=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=c+2;d<a.w;d++)if(!Jmat.Complex.nearr(a.e[c][d],0,b))return!1;return!0};
Jmat.Matrix.isTridiagonal=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++)for(var d=0;d<a.w;d++)if(d!=c&&d+1!=c&&d!=c+1&&!Jmat.Complex.nearr(a.e[c][d],0,b))return!1;return!0};Jmat.Matrix.isOrthogonal=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;a=a.mulT(a);return Jmat.Matrix.isIdentity(a,b)};
Jmat.Matrix.isUnitary=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;a=a.mulTG(a);return Jmat.Matrix.isIdentity(a,b)};Jmat.Matrix.isNormal=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;var c=a.transjugate();return Jmat.Matrix.near(a.mul(c),c.mul(a),b)};
Jmat.Matrix.isPermutation=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c<a.h;c++){for(var d=0,e=0,f=0,g=0;g<a.w;g++)Jmat.Complex.nearr(a.e[c][g],0,b)?Jmat.Complex.nearr(a.e[c][g],1,b)?f++:e++:d++;if(1!=e||0<f)return!1}for(g=0;g<a.w;g++){for(c=f=e=d=0;c<a.h;c++)Jmat.Complex.nearr(a.e[c][g],0,b)?Jmat.Complex.nearr(a.e[c][g],1,b)?f++:e++:d++;if(1!=e||0<f)return!1}return!0};
Jmat.Matrix.isToeplitz=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=0;c+1<a.h;c++)for(var d=0;d+1<a.w;d++)if(!Jmat.Complex.near(a.e[c][d],a.e[c+1][d+1],b))return!1;return!0};Jmat.Matrix.isHankel=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=1;c<a.h;c++)for(var d=0;d+1<a.w;d++)if(!Jmat.Complex.near(a.e[c][d],a.e[c-1][d+1],b))return!1;return!0};
Jmat.Matrix.isFrobenius=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!Jmat.Matrix.isSquare(a))return!1;for(var c=-1,d=0;d<a.h;d++)for(var e=0;e<a.w;e++){if(e==d&&!Jmat.Complex.nearr(a.e[d][e],1,b)||e>d&&!Jmat.Complex.nearr(a.e[d][e],0,b))return!1;if(e<d&&!Jmat.Complex.nearr(a.e[d][e],0,b)){if(0<=c&&e!=c)return!1;c=e}}return!0};
Jmat.Matrix.isInteger=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;for(var c=0;c<a.h;c++)for(var d=0;d<a.w;d++){var e=a.e[c][d];if(!Jmat.Real.near(e.im,0,b)||Math.abs(Math.round(e.re)-e.re)>b)return!1}return!0};Jmat.Matrix.isBinary=function(a,b){b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;for(var c=0;c<a.h;c++)for(var d=0;d<a.w;d++){var e=a.e[c][d];if(!Jmat.Real.near(e,0,b)&&!Jmat.Real.near(e,1,b))return!1}return!0};
Jmat.Matrix.isInvolutory=function(a,b){return Jmat.Matrix.isSquare(a)?Jmat.Matrix.isIdentity(a.mul(a),b):!1};Jmat.Matrix.isIdempotent=function(a,b){return Jmat.Matrix.isSquare(a)?Jmat.Matrix.near(a,a.mul(a),b):!1};Jmat.Matrix.isNilpotent=function(a,b){var c=Jmat.Matrix;b=void 0==b?Jmat.Matrix.DEFPROPEPS:b;if(!c.isSquare(a))return!1;for(var d=a.w,e=1;c.trace(a).eqr(0,b);){if(c.isZero(a,b))return!0;if(e>=d)break;a=a.mul(a);e*=2}return!1};
Jmat.Matrix.getProperties=function(a,b){var c=Jmat.Matrix,d={};d.dimensions=""+a.h+"x"+a.w;d.height=a.h;d.width=a.w;d.square=c.isSquare(a);d.zero=c.isZero(a);d.real=c.isReal(a);d.rank=c.rank(a);d.frobeniusNorm=c.norm(a);d.spectralNorm=c.norm2(a);d.conditionNumber=c.conditionNumber(a);d.nan=c.isNaN(a);d.identity=c.isIdentity(a,b);d.diagonal=c.isDiagonal(a,b);d.tridiagonal=c.isTridiagonal(a,b);d.symmetric=c.isSymmetric(a,b);d.hermitian=c.isHermitian(a,b);d.skewHermitian=c.isSkewHermitian(a,b);d.skewSymmetric=
c.isSkewSymmetric(a,b);d.upperTriangular=c.isUpperTriangular(a,b);d.lowerTriangular=c.isLowerTriangular(a,b);d.strictlyUpperTriangular=c.isStrictlyUpperTriangular(a,b);d.strictlyLowerTriangular=c.isStrictlyLowerTriangular(a,b);d.upperUnitriangular=c.isUpperUnitriangular(a,b);d.lowerUnitriangular=c.isLowerUnitriangular(a,b);d.upperHessenberg=c.isUpperHessenberg(a,b);d.lowerHessenberg=c.isLowerHessenberg(a,b);d.singular=c.isSingular(a,b);d.invertible=c.isInvertible(a,b);d.determinant=c.determinant(a,
b);d.trace=c.trace(a,b);d.orthogonal=c.isOrthogonal(a,b);d.unitary=c.isUnitary(a,b);d.normal=c.isNormal(a,b);d.permutation=c.isPermutation(a,b);d.toeplitz=c.isToeplitz(a,b);d.hankel=c.isHankel(a,b);d.frobenius=c.isFrobenius(a,b);d.integer=c.isInteger(a,b);d.binary=c.isBinary(a,b);d.involutory=c.isInvolutory(a,b);d.idempotent=c.isIdempotent(a,b);if(d.hermitian)if(a=c.definiteness(a),a==c.INDEFINITE)d.indefinite=!0;else if(a==c.POSITIVE_DEFINITE)d.positiveDefinite=d.positiveSemidefinite=!0;else if(a==
c.NEGATIVE_DEFINITE)d.negativeDefinite=d.negativeSemidefinite=!0;else if(a==c.POSITIVE_SEMI_DEFINITE||d.zero)d.positiveSemidefinite=!0;else if(a==c.NEGATIVE_SEMI_DEFINITE||d.zero)d.negativeSemidefinite=!0;return d};
Jmat.Matrix.summary=function(a,b){b=Jmat.Matrix.getProperties(a,b);var c=function(a){a=a.replace(/([A-Z])/g," $1").toLowerCase();a=a.replace("hessenberg","Hessenberg");a=a.replace("frobenius","Frobenius");a=a.replace("toeplitz","Toeplitz");a=a.replace("hankel","Hankel");return a=a.replace("frobenius","Frobenius")},d="height width zero real nan rank frobeniusNorm spectralNorm conditionNumber integer binary".split(" "),e="identity symmetric hermitian skewSymmetric skewHermitian diagonal tridiagonal upperTriangular lowerTriangular strictlyUpperTriangular strictlyLowerTriangular upperUnitriangular lowerUnitriangular upperHessenberg lowerHessenberg singular invertible determinant trace orthogonal unitary normal permutation toeplitz hankel indefinite positiveDefinite negativeDefinite positiveSemidefinite negativeSemidefinite frobenius involutory idempotent".split(" "),
f={square:"non-square",real:"complex"};b.small2x2=2>=a.w&&2>=a.h;b.small1x1=1>=a.w&&1>=a.h;b.realsym=b.real&&b.symmetric;b.realskewsym=b.real&&b.skewSymmetric;a={strictlyUpperTriangular:["zero"],strictlyLowerTriangular:["zero"],upperUnitriangular:["identity"],lowerUnitriangular:["identity"],upperTriangular:["diagonal","strictlyUpperTriangular","upperUnitriangular"],lowerTriangular:["diagonal","frobenius","strictlyLowerTriangular","lowerUnitriangular"],upperHessenberg:["upperTriangular","tridiagonal"],
lowerHessenberg:["lowerTriangular","tridiagonal"],diagonal:["small1x1","identity","zero"],tridiagonal:["small2x2","diagonal"],orthogonal:["normal","identity"],unitary:["normal"],normal:["identity","zero"],hermitian:["normal","realsym"],skewHermitian:["realskewsym"],symmetric:["diagonal"],skewSymmetric:["zero"],permutation:["identity"],invertible:["identity"],singular:["zero"],real:["integer"],toeplitz:["identity","zero"],hankel:["zero"],frobenius:["identity"],positiveDefinite:["identity"],negativeSemidefinite:["zero",
"negativeDefinite"],positiveSemidefinite:["zero","positiveDefinite"],integer:["binary"],binary:["identity","zero"],involutory:["identity"],idempotent:["identity"]};for(var g=b.dimensions+", "+(b.square?"square":f.square),h=0;h<d.length+e.length;h++){var k=h<d.length?d[h]:e[h-d.length];if(!0===b[k]){if(a[k]){for(var l=!1,m=0;m<a[k].length;m++)!0===b[a[k][m]]&&(l=!0);if(l)continue}g+=", "+c(k)}!1===b[k]&&f[k]&&(g+=", "+c(f[k]))}return g=""+g+" matrix with rank "+b.rank+(b.square?", determinant "+b.determinant:
", no determinant")+" and condition number "+b.conditionNumber+"."};Jmat.Matrix.prototype.summary=function(a){return Jmat.Matrix.summary(this,a)};Jmat.Matrix.render_summary=function(a,b){return a.render()+"\n"+a.summary(b)};Jmat.Matrix.prototype.render_summary=function(a){return Jmat.Matrix.render_summary(this,a)};Jmat.Matrix.transpose_naive_=function(a){for(var b=new Jmat.Matrix(a.w,a.h),c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b.e[d][c]=a.e[c][d];return b};
Jmat.Matrix.transpose_cache_friendly_=function(a){for(var b=new Jmat.Matrix(a.w,a.h),c=[[0,0,a.w,a.h]];0<c.length;){var d=c.pop(),e=d[0],f=d[1],g=d[2];d=d[3];var h=g-e,k=d-f;if(h>=k&&16<h)c.push([e+g>>1,f,g,d]),c.push([e,f,e+g>>1,d]);else if(16<k)c.push([e,f+d>>1,g,d]),c.push([e,f,g,f+d>>1]);else for(;f<d;f++)for(h=e;h<g;h++)b.e[h][f]=a.e[f][h]}return b};Jmat.Matrix.transpose=function(a){return 25E4<a.w*a.h?Jmat.Matrix.transpose_cache_friendly_(a):Jmat.Matrix.transpose_naive_(a)};
Jmat.Matrix.prototype.transpose=function(){return Jmat.Matrix.transpose(this)};Jmat.Matrix.neg=function(a){for(var b=new Jmat.Matrix(a.h,a.w),c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b.e[c][d]=a.e[c][d].neg();return b};Jmat.Matrix.prototype.neg=function(){return Jmat.Matrix.neg(this)};Jmat.Matrix.conj=function(a){for(var b=new Jmat.Matrix(a.h,a.w),c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b.e[c][d]=Jmat.Complex.conj(a.e[c][d]);return b};Jmat.Matrix.prototype.conj=function(){return Jmat.Matrix.conj(this)};
Jmat.Matrix.transjugate=function(a){return Jmat.Matrix.conj(Jmat.Matrix.transpose(a))};Jmat.Matrix.prototype.transjugate=function(){return Jmat.Matrix.transjugate(this)};
Jmat.Matrix.doolittle_lup_=function(a){if(a.h!=a.w)return null;var b=Jmat.Complex;a=Jmat.Matrix.copy(a);for(var c=[],d=0,e=0;e<a.h;e++){for(var f=e,g=a.e[f][e].abs(),h=e+1;h<a.h;h++)a.e[h][e].abs()>g&&(g=a.e[h][e].abs(),f=h);c[e]=f;if(f!=e){for(h=0;h<a.h;h++)g=a.e[f][h],a.e[f][h]=a.e[e][h],a.e[e][h]=g;d^=1}for(h=e+1;h<a.h;h++)a.e[h][e]=a.e[h][e].div(a.e[e][e]),b.isNaN(a.e[h][e])&&(a.e[h][e]=b(0));for(h=e+1;h<a.h;h++)for(f=e+1;f<a.w;f++)a.e[h][f]=a.e[h][f].sub(a.e[h][e].mul(a.e[e][f]))}return[a,c,
d]};Jmat.Matrix.lu=function(a){var b=Jmat.Matrix,c=Jmat.Complex,d=b.doolittle_lup_(a);if(!d)return d;a=d[0];d=d[1];for(var e=b.identity(a.w),f=b.zero(a.w),g=0;g<a.h;g++)for(var h=0;h<a.w;h++)h>=g?f.e[g][h]=a.e[g][h]:e.e[g][h]=a.e[g][h];b=b.zero(a.w);g=[];for(h=0;h<a.h;h++)g[h]=h;for(h=0;h<a.h;h++){var k=g[h];g[h]=g[d[h]];g[d[h]]=k}for(h=0;h<a.h;h++)b.e[g[h]][h]=c(1);return{p:b,l:e,u:f}};
Jmat.Matrix.cholesky=function(a){var b=Jmat.Matrix,c=Jmat.Complex;if(!b.isHermitian(a))return null;b=b.zero(a.w);for(var d=0;d<a.h;d++)for(var e=0;e<=d;e++){for(var f=c(0),g=0;g<e;g++)f=f.add(b.e[d][g].mul(b.e[e][g]));f=a.e[d][e].sub(f);b.e[d][e]=d==e?c.sqrt(f):b.e[e][e].inv().mul(f)}return b};
Jmat.Matrix.ldl=function(a){var b=Jmat.Matrix;if(!b.isHermitian(a))return null;var c=b.identity(a.w);b=b.zero(a.w);for(var d=0;d<a.h;d++){for(var e=[],f=0;f<d;f++)e[f]=c.e[d][f].mul(b.e[f][f]);e[d]=a.e[d][d];for(f=0;f<d;f++)e[d]=e[d].sub(c.e[d][f].mul(e[f]));b.e[d][d]=e[d];for(f=d+1;f<a.h;f++){c.e[f][d]=a.e[f][d];for(var g=0;g<d;g++)c.e[f][d]=c.e[f][d].sub(c.e[f][g].mul(e[g]));c.e[f][d]=c.e[f][d].div(e[d])}}return{l:c,d:b}};
Jmat.Matrix.subrow=function(a,b){if(2>a.h)return null;for(var c=new Jmat.Matrix(a.h-1,a.w),d=0;d<a.h-1;d++)for(var e=0;e<a.w;e++)c.e[d][e]=a.e[d<b?d:d+1][e];return c};Jmat.Matrix.subcol=function(a,b){if(2>a.w)return null;for(var c=new Jmat.Matrix(a.h,a.w-1),d=0;d<a.h;d++)for(var e=0;e<a.w-1;e++)c.e[d][e]=a.e[d][e<b?e:e+1];return c};
Jmat.Matrix.minorsub=function(a,b,c){if(2>a.h||2>a.w)return null;for(var d=new Jmat.Matrix(a.h-1,a.w-1),e=0;e<a.h-1;e++)for(var f=0;f<a.w-1;f++)d.e[e][f]=a.e[e<b?e:e+1][f<c?f:f+1];return d};Jmat.Matrix.submatrix=function(a,b,c,d,e){if(0>d||0>b||d>a.w||b>a.h||0>e||0>c||e>a.w||c>a.h)return null;e-=d;c-=b;if(0>=e||0>=c||e>a.w||c>a.h)return null;for(var f=new Jmat.Matrix(c,e),g=0;g<c;g++)for(var h=0;h<e;h++)f.e[g][h]=a.e[b+g][d+h];return f};
Jmat.Matrix.minor=function(a,b,c){if(2>a.h||2>a.w||a.w!=a.h)return Jmat.Complex(NaN);a=Jmat.Matrix.minorsub(a,b,c);return Jmat.Matrix.determinant(a)};Jmat.Matrix.cofactor=function(a,b,c){return Jmat.Matrix.minor(a,b,c).mulr(0==(b+c&1)?1:-1)};
Jmat.Matrix.determinant=function(a){if(a.w!=a.h)return NaN;if(1==a.w)return a.e[0][0];if(2==a.w)return a.e[0][0].mul(a.e[1][1]).sub(a.e[0][1].mul(a.e[1][0]));for(var b=Jmat.Matrix.doolittle_lup_(a),c=Jmat.Complex(1),d=0;d<a.w;d++)c=c.mul(b[0].e[d][d]);b[2]&1&&(c=c.neg());return c};Jmat.Matrix.adj=function(a){if(a.w!=a.h)return NaN;if(1==a.w)return Jmat.Matrix.identity(1,1);for(var b=new Jmat.Matrix(a.h,a.w),c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b.e[c][d]=Jmat.Matrix.cofactor(a,d,c);return b};
Jmat.Matrix.inv=function(a,b){if(a.w!=a.h)return null;b=b||1E-15;var c=Jmat.Matrix.determinant(a);return c.abs()<b?null:Jmat.Matrix.mulc(Jmat.Matrix.adj(a),Jmat.Complex.inv(c))};Jmat.Matrix.pseudoinverse_=function(a){a=Jmat.Matrix.svd(a);for(var b=Math.min(a.s.w,a.s.h),c=0;c<b;c++)a.s.e[c][c]=1E-15>Math.abs(a.s.e[c][c].re)?a.s.e[c][c]:Jmat.Complex.inv(a.s.e[c][c]);return a.v.mulT(a.s).mulTG(a.u)};Jmat.Matrix.pseudoinverse=function(a){if(a.w==a.h){var b=Jmat.Matrix.inv(a,1E-10);if(Jmat.Matrix.isValid(b))return b}return Jmat.Matrix.pseudoinverse_(a)};
Jmat.Matrix.getFirstNonZeroDigit_=function(a){if(0==a)return 0;0>a&&(a=-a);for(var b=0;100>b;b++)if(1>a)a*=10;else if(10<=a)a/=10;else return Math.floor(a);return 0};Jmat.Matrix.getDebugNumber=function(a){for(var b=a.w+10*a.h,c=.1,d=0;d<a.h;d++)for(var e=0;e<a.w;e++){var f=Jmat.Matrix.getFirstNonZeroDigit_(a.e[d][e].re);b+=f*c;c/=10}c*=10;b=Math.round(b/c)*c;return Jmat.Complex(b)};Jmat.Matrix.sumsq=function(a){for(var b=0,c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b+=a.e[c][d].abssq();return Jmat.Complex(b)};
Jmat.Matrix.norm=function(a){a=Math.sqrt(Jmat.Matrix.sumsq(a).re);return Jmat.Complex(a)};Jmat.Matrix.normalize=function(a){var b=Jmat.Matrix.norm(a);return a.divr(b.re)};Jmat.Matrix.maxcolnorm=function(a){for(var b=0,c=0;c<a.w;c++){for(var d=0,e=0;e<a.h;e++)d+=a.e[e][c].abssq();d>b&&(b=d)}return Jmat.Complex(b)};Jmat.Matrix.maxrownorm=function(a){for(var b=0,c=0;c<a.h;c++){for(var d=0,e=0;e<a.w;e++)d+=a.e[c][e].abssq();d>b&&(b=d)}return Jmat.Complex(b)};Jmat.Matrix.norm2=function(a){return Jmat.Matrix.svd(a).s.e[0][0]};
Jmat.Matrix.vectorNorm=function(a,b){var c=Jmat.Complex;if(c.isReal(b)){for(var d=0,e=0;e<a.h;e++)for(var f=0;f<a.w;f++){var g=a.e[e][f];b.eqr(0)?c.nearr(g,0,1E-15)||d++:d=b.eqr(1)?d+g.abs():b.eqr(2)?d+g.abssq():b.eqr(Infinity)?Math.max(g.abs(),d):d+Math.pow(g.abssq(),b.re/2)}if(Infinity==d&&0<b.re)return Jmat.Matrix.vectorNorm(a,c(Infinity));b.eqr(2)?d=Math.sqrt(d):b.eqr(0)||b.eqr(1)||b.eqr(Infinity)||(d=Math.pow(d,1/b.re));return c(d)}d=c(0);for(e=0;e<a.h;e++)for(f=0;f<a.w;f++)g=c.abssq(a.e[e][f]),
d=d.add(g.pow(b.divr(2)));return d.eqr(0)?d:c.pow(d,b.inv())};Jmat.Matrix.lpqNorm=function(a,b,c){for(var d=Jmat.Matrix,e=d(1,a.w),f=0;f<a.w;f++)e.e[0][f]=d.vectorNorm(d.col(a,f),b);return d.vectorNorm(e,c)};Jmat.Matrix.schattenNorm=function(a,b){if(b.eqr(2))return Jmat.Matrix.norm(a);if(b.eqr(Infinity))return Jmat.Matrix.norm2(a);var c=Jmat.Matrix;a=c.svd(a);a=c.diagToRow(a.s);return c.vectorNorm(a,b)};
Jmat.Matrix.chebNorm=function(a){for(var b=0,c=0;c<a.w;c++)for(var d=0;d<a.h;d++)b=Math.max(a.e[d][c].abs());return Jmat.Complex(b)};Jmat.Matrix.dist=function(a,b){return Jmat.Matrix.norm(a.sub(b)).re};Jmat.Matrix.cheb=function(a,b){for(var c=0,d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c=Math.max(c,Jmat.Complex.cheb(a.e[d][e],b.e[d][e]));return c};Jmat.Matrix.manhattan=function(a,b){for(var c=0,d=0;d<a.h;d++)for(var e=0;e<a.w;e++)c+=Jmat.Complex.manhattan(a.e[d][e],b.e[d][e]);return c};
Jmat.Matrix.conditionNumber=function(a){var b=Jmat.Matrix.svd(a);a=Math.min(a.w,a.h);b=b.s.e[0][0].div(b.s.e[a-1][a-1]);Jmat.Complex.isNaN(b)&&(b=Jmat.Complex(Infinity));return b};Jmat.Matrix.rank=function(a,b){b=void 0==b?1E-14:b;a=Jmat.Matrix.svd(a).s;for(var c=0,d=Math.min(a.w,a.h),e=0;e<d;e++)Jmat.Real.near(a.e[e][e].re,0,b)||c++;return Jmat.Complex(c)};Jmat.Matrix.trace=function(a){for(var b=Jmat.Complex.ZERO,c=0;c<a.w&&c<a.h;c++)b=b.add(a.e[c][c]);return b};
Jmat.Matrix.col=function(a,b){for(var c=new Jmat.Matrix(a.h,1),d=0;d<a.h;d++)c.e[d][0]=a.e[d][b];return c};Jmat.Matrix.row=function(a,b){for(var c=new Jmat.Matrix(1,a.w),d=0;d<a.w;d++)c.e[0][d]=a.e[b][d];return c};Jmat.Matrix.setCol=function(a,b,c){for(var d=0;d<a.h;d++)a.e[d][c]=b.e[d][0]};Jmat.Matrix.setRow=function(a,b,c){for(var d=0;d<a.w;d++)a.e[c][d]=b.e[0][d]};
Jmat.Matrix.overlap=function(a,b,c,d){for(var e=Jmat.Matrix.zero(Math.max(c+b.h,a.h)-Math.min(0,c),Math.max(d+b.w,a.w)-Math.min(0,d)),f=0;f<a.h;f++)for(var g=0;g<a.w;g++){var h=0>d?g-d:g,k=0>c?f-c:f;e.e[k][h]=a.e[f][g]}for(f=0;f<b.h;f++)for(g=0;g<b.w;g++)h=0>d?g:g+d,k=0>c?f:f+c,e.e[k][h]=e.e[k][h].add(b.e[f][g]);return e};Jmat.Matrix.insertInPlace=function(a,b,c,d){for(var e=0;e<b.h;e++)for(var f=0;f<b.w;f++){var g=f+d,h=e+c;0<=g&&g<a.w&&0<=h&&h<a.h&&(a.e[h][g]=b.e[e][f])}};
Jmat.Matrix.insert=function(a,b,c,d){a=Jmat.Matrix.copy(a);Jmat.Matrix.insertInPlace(a,b,c,d);return a};Jmat.Matrix.augment=function(a,b,c,d){c=void 0==c?0:c;d=void 0==d?a.w:d;for(var e=Jmat.Matrix.zero(Math.max(c+b.h,a.h)-Math.min(0,c),Math.max(d+b.w,a.w)-Math.min(0,d)),f=0;f<a.h;f++)for(var g=0;g<a.w;g++){var h=0>d?g-d:g,k=0>c?f-c:f;e.e[k][h]=a.e[f][g]}for(f=0;f<b.h;f++)for(g=0;g<b.w;g++)h=0>d?g:g+d,k=0>c?f:f+c,e.e[k][h]=b.e[f][g];return e};
Jmat.Matrix.proj=function(a,b){var c=Jmat.Matrix,d=c.sumsq(b);if(0==d.re)return c.zero(a.h,a.w);a=c.dot(a,b).div(d);return b.mulc(a)};Jmat.Matrix.gramSchmidtStep_=function(a,b,c){var d=Jmat.Matrix;a=d.col(a,b);for(var e=0;e<b;e++)a=a.sub(d.proj(a,c[e]));return a};
Jmat.Matrix.gramSchmidt=function(a,b){for(var c=Jmat.Matrix,d=0;d<a.w;d++)c.col(a,d);var e=[];for(d=0;d<a.w;d++)e[d]=c.gramSchmidtStep_(a,d,e);if(b)for(d=0;d<e.length;d++)e[d]=c.normalize(e[d]);b=new c(a.h,a.w);for(c=0;c<a.h;c++)for(d=0;d<a.w;d++)b.e[c][d]=e[d].e[c][0];return b};
Jmat.Matrix.getHouseholderVector_=function(a,b){var c=Jmat.Matrix,d=Jmat.Complex,e=a.e[0][0].eqr(0)?d(-1):d.sign(a.e[0][0]);e=c.identity(a.h,1).mulc(e.mul(c.norm(a))).add(a);var f=c.isZero(e,1E-30);f||(e=e.divc(c.norm(e)));f?a=d(0):b?a=d(2):(b=c.mul(c.row(c.transjugate(a),0),e),a=c.mul(c.transjugate(e),c.col(a,0)),a=b.e[0][0].div(a.e[0][0]).addr(1));return[e,a]};
Jmat.Matrix.getGivensParams_=function(a,b){if(b.eqr(0))return[Jmat.Complex(1),Jmat.Complex(0),a];var c=Jmat.Complex.hypot(a,b);a=a.div(c);b=b.div(c).neg();return[a,b,c]};Jmat.Matrix.givensPre_=function(a,b,c,d,e){for(var f=0;f<a.w;f++){var g=a.e[b][f],h=a.e[c][f];a.e[b][f]=g.mul(d.conj()).add(h.mul(e.neg().conj()));a.e[c][f]=g.mul(e).add(h.mul(d))}};Jmat.Matrix.givensPost_=function(a,b,c,d,e){for(var f=0;f<a.h;f++){var g=a.e[f][b],h=a.e[f][c];a.e[f][b]=g.mul(d).add(h.mul(e.neg()));a.e[f][c]=g.mul(e.conj()).add(h.mul(d.conj()))}};
Jmat.Matrix.hessenberg=function(a){var b=Jmat.Matrix;if(a.h!=a.w)return null;for(var c=Jmat.Matrix.isReal(a),d=b.copy(a),e=Matrix.identity(a.h),f=0;f+2<a.w;f++){var g=b.submatrix(d,f+1,d.h,f,f+1),h=b.getHouseholderVector_(g,c);g=h[0];h=h[1];g=Matrix.identity(g.h).sub(g.mulTG(g).mulc(h));h=b.submatrix(d,f+1,d.h,f,d.w);h=g.mul(h);d=b.insert(d,h,f+1,f);h=b.submatrix(d,0,d.h,f+1,d.w);h=h.mul(g);d=b.insert(d,h,0,f+1);h=b.submatrix(e,0,e.h,f+1,e.w);h=h.mul(g);e=b.insert(e,h,0,f+1)}for(a=0;a<d.h;a++)for(g=
0;g<Math.max(a-1,0);g++)d.e[a][g]=Jmat.Complex(0);return{p:e,h:d}};Jmat.Matrix.toHessenberg=function(a){return Jmat.Matrix.hessenberg(a).h};Jmat.Matrix.schur=function(a){var b=Jmat.Matrix,c=Jmat.Matrix.hessenberg(a),d=c.h;c=c.p;var e=a.h;a=b.identity(a.h);for(b=0;2<=e;){var f=a.mulc(d.e[e-1][e-1]),g=Jmat.Matrix.qr_hessenberg_(d.sub(f));d=g.r.mul(g.q).add(f);c=c.mul(g.q);1E-15>d.e[e-2][e-1].abs()&&(e--,b=0);b++;if(1E3<b)break}return{p:c,t:d}};
Jmat.Matrix.qr_hessenberg_=function(a){var b=Jmat.Matrix,c=Jmat.Complex,d=Math.min(a.h-1,a.w),e=b.copy(a);a=b.identity(a.h,a.h);for(var f=0;f<d;f++){var g=b.getGivensParams_(e.e[f][f],e.e[f+1][f]);b.givensPre_(e,f,f+1,g[0],g[1]);e.e[f+1][f]=c(0);b.givensPost_(a,f,f+1,g[0],g[1])}return{q:a,r:e}};
Jmat.Matrix.qr_general_=function(a){var b=Jmat.Matrix,c=Jmat.Matrix.isReal(a),d=a.h,e=a.w,f=[],g=[];if(a.h<a.w)return null;a=b.copy(a);for(var h=0;h<e;h++){var k=b.submatrix(a,h,a.h,h,h+1);k=b.getHouseholderVector_(k,c);f[h]=k[0];g[h]=k[1];k=b.submatrix(a,h,d,h,e);k=k.sub(f[h].mulTG(f[h]).mul(k).mulc(g[h]));a=b.insert(a,k,h,h)}c=b.identity(d,d);for(h=e-1;0<=h;h--)e=b.submatrix(c,h,d,0,d),e=e.sub(f[h].mulTG(f[h]).mul(e).mulc(g[h])),c=b.insert(c,e,h,0);return{q:c,r:a}};
Jmat.Matrix.qr=function(a){return Jmat.Matrix.isUpperHessenberg(a,1E-18)?Jmat.Matrix.qr_hessenberg_(a):Jmat.Matrix.qr_general_(a)};Jmat.Matrix.eig11=function(a){if(1!=a.w||1!=a.h)return null;var b={};b.l=[Jmat.Complex(a.e[0][0])];b.v=new Jmat.Matrix(1,1);b.v.e[0][0]=Jmat.Complex(1);return b};
Jmat.Matrix.eigval22=function(a){if(2!=a.w||2!=a.h)return null;var b=Jmat.Complex(1),c=a.e[0][0].neg().sub(a.e[1][1]);a=a.e[0][0].mul(a.e[1][1]).sub(a.e[0][1].mul(a.e[1][0]));var d=Jmat.Complex.sqrt(c.mul(c).sub(b.mul(a).mulr(4)));a=c.neg().add(d).div(b.mulr(2));b=c.neg().sub(d).div(b.mulr(2));return b.abssq()>a.abssq()?[b,a]:[a,b]};
Jmat.Matrix.eig22=function(a){if(2!=a.w||2!=a.h)return null;var b=Jmat.Matrix.eigval22(a),c=b[0];b=b[1];var d=a.e[0][1].div(c.sub(a.e[0][0])),e=Jmat.Complex(1);a=a.e[0][1].div(b.sub(a.e[0][0]));var f=Jmat.Complex(1),g={};g.l=[c,b];g.v=new Jmat.Matrix(2,2);g.v.e[0][0]=d;g.v.e[1][0]=e;g.v.e[0][1]=a;g.v.e[1][1]=f;return g};
Jmat.Matrix.eigvalHessenberg_=function(a){var b=Jmat.Complex,c=Jmat.Matrix,d=a.w,e=b(0),f=b(0),g;b(0);b(0);b(0);var h=[];for(g=0;g<d;g++)h[g]=b(0);for(;0<d;)for(var k=0;30>=k;k++){if(30==k)return null;for(g=d-1;1<=g;g--)if(b.abs1r(a.e[g][g-1])<=1.2E-16*(b.abs1r(a.e[g-1][g-1])+b.abs1r(a.e[g][g]))){a.e[g][g-1]=b(0);break}if(g==d-1){h[d-1]=a.e[d-1][d-1].add(f);d--;break}if(10==k||20==k)e.re=Math.abs(a.e[d-1][d-2].re)+Math.abs(a.e[d-2][d-3].re),e.im=Math.abs(a.e[d-1][d-2].im)+Math.abs(a.e[d-2][d-3].im);
else if(e=a.e[d-1][d-1],g=a.e[d-2][d-1].mul(a.e[d-1][d-2]),!g.eqr(0)){var l=a.e[d-2][d-2].sub(e).divr(2);var m=b.sqrt(l.mul(l).add(g));0>l.re*m.re+l.im*m.im&&(m=m.neg());g=g.div(l.add(m));e=e.sub(g)}for(g=0;g<d;g++)a.e[g][g]=a.e[g][g].sub(e);f=f.add(e);g=[];for(l=0;l+1<d;l++)g[l]=c.getGivensParams_(a.e[l][l],a.e[l+1][l]),c.givensPre_(a,l,l+1,g[l][0],g[l][1]),a.e[l+1][l]=b(0),a.e[l][l]=g[l][2];for(l=0;l+1<d;l++)c.givensPost_(a,l,l+1,g[l][0],g[l][1])}return h};
Jmat.Matrix.eigval=function(a){var b=Jmat.Matrix;if(a.w!=a.h||1>a.w)return null;var c=a.w;if(1==c)return[a.e[0][0]];if(2==c)return b.eigval22(a);a=b.toHessenberg(a);b=b.eigvalHessenberg_(a);b.sort(function(a,b){return b.abssq()-a.abssq()});return b};
Jmat.Matrix.eigenVectorFor=function(a,b,c){var d=Jmat.Matrix;if(a.w!=a.h||1>a.w)return null;var e=a.w;c=void 0==c?1:c;var f=d.copy(a);for(a=0;a<e;a++)f.e[a][a]=f.e[a][a].sub(b);if(b=d.solve(f,d.zero(e,1),.01))2==c&&(b=b.divc(d.norm(b))),1==c&&(b.e[e-1][0].eqr(0)||(b=b.divc(b.e[e-1][0])));else for(b=d.zero(e,1),a=0;a<e;a++)b.e[a][0]=Jmat.Complex(NaN,NaN);return b};
Jmat.Matrix.jacobi_=function(a,b,c){for(var d=[],e=[],f=a.w,g=0;g<f;g++){d[g]=[];for(var h=0;h<f;h++)d[g][h]=a.e[g][h].re}Jmat.Real.matrix_jacobi(d,e,f,b);if(1==c||void 0==c)for(g=0;g<f;g++)if(0!=e[g][f-1])for(h=0;h<f;h++)e[g][h]/=e[g][f-1];e=Jmat.Matrix(e).transpose();a=Jmat.Matrix(f,1);for(b=0;b<f;b++)a.e[b][0]=Jmat.Complex(d[b][b]);return{l:a,v:e}};
Jmat.Matrix.eig=function(a,b){var c=Jmat.Matrix;if(a.w!=a.h||1>a.w)return null;var d=a.w;if(1==d)return c.eig11(a);if(2==d)return c.eig22(a);if(c.isReal(a)&&c.isSymmetric(a))return Jmat.Matrix.jacobi_(a,b);for(var e=c.eigval(a),f=0;f<e.length;f++)Jmat.Complex.nearr(e[f],0,1E-15)&&(e[f]=Jmat.Complex(0));e.sort(function(a,b){return b.abssq()-a.abssq()});f=null;f=new c(d,d);for(var g=0;g<d;g++){var h=c.eigenVectorFor(a,e[g],b);c.setCol(f,h,g)}return{l:e,v:f}};
Jmat.Matrix.evd=function(a){a=Jmat.Matrix.eig(a);return{v:a.v,d:Jmat.Matrix.arrayToDiag(a.l)}};Jmat.Matrix.definiteness_=function(a,b){b=void 0==b?1E-12:b;a=Jmat.Matrix.eigval(a);if(!a)return null;for(var c=[!1,!1,!1],d=0;d<a.length;d++)Jmat.Real.near(a[d].re,0,b)?c[1]=!0:0<a[d].re?c[2]=!0:c[0]=!0;return c};Jmat.Matrix.INDEFINITE=0;Jmat.Matrix.POSITIVE_DEFINITE=1;Jmat.Matrix.POSITIVE_SEMI_DEFINITE=2;Jmat.Matrix.NEGATIVE_DEFINITE=3;Jmat.Matrix.NEGATIVE_SEMI_DEFINITE=4;
Jmat.Matrix.definiteness=function(a,b){if(!Jmat.Matrix.isHermitian(a,b))return null;a=Jmat.Matrix.definiteness_(a,b);return!a[2]||a[0]||a[1]?!a[0]||a[2]||a[1]?a[0]?a[2]?a[0]&&a[2]?Jmat.Matrix.INDEFINITE:null:Jmat.Matrix.NEGATIVE_SEMI_DEFINITE:Jmat.Matrix.POSITIVE_SEMI_DEFINITE:Jmat.Matrix.NEGATIVE_DEFINITE:Jmat.Matrix.POSITIVE_DEFINITE};Jmat.Matrix.arrayToCol=function(a){for(var b=new Jmat.Matrix(a.length,1),c=0;c<a.length;c++)b.e[c][0]=Jmat.Complex.cast(a[c]);return b};
Jmat.Matrix.arrayToRow=function(a){for(var b=new Jmat.Matrix(1,a.length),c=0;c<a.length;c++)b.e[0][c]=Jmat.Complex.cast(a[c]);return b};Jmat.Matrix.arrayToDiag=function(a){for(var b=Jmat.Matrix.zero(a.length,a.length),c=0;c<a.length;c++)b.e[c][c]=Jmat.Complex.cast(a[c]);return b};Jmat.Matrix.diag=function(a){var b=a.w*a.h;b=Jmat.Matrix.zero(b,b);for(var c=0,d=0;d<a.h;d++)for(var e=0;e<a.w;e++)b.e[c][c]=a.e[d][e],c++;return b};
Jmat.Matrix.diagToCol=function(a){for(var b=Math.min(a.h,a.w),c=Jmat.Matrix(b,1),d=0;d<b;d++)c.e[d][0]=a.e[d][d];return c};Jmat.Matrix.diagToRow=function(a){for(var b=Math.min(a.h,a.w),c=Jmat.Matrix(1,b),d=0;d<b;d++)c.e[0][d]=a.e[d][d];return c};Jmat.Matrix.get1=function(a,b){return a.e[Math.floor(b/a.w)][b%a.w]};Jmat.Matrix.prototype.get1=function(a){return Jmat.Matrix.get1(this,a)};Jmat.Matrix.set1=function(a,b,c){a.e[Math.floor(b/a.w)][b%a.w]=c};
Jmat.Matrix.cross=function(a,b){if(3!=a.w*a.h||3!=b.w*b.h)return Jmat.Matrix(NaN);var c=new Jmat.Matrix(a.h,a.w);Jmat.Matrix.set1(c,0,a.get1(1).mul(b.get1(2)).sub(a.get1(2).mul(b.get1(1))));Jmat.Matrix.set1(c,1,a.get1(2).mul(b.get1(0)).sub(a.get1(0).mul(b.get1(2))));Jmat.Matrix.set1(c,2,a.get1(0).mul(b.get1(1)).sub(a.get1(1).mul(b.get1(0))));return c};
Jmat.Matrix.dot=function(a,b){if(a.w!=b.w||a.h!=b.h)if(a.w!=b.h||a.h!=b.w||1!=a.w&&1!=a.h)return Jmat.Matrix(NaN);for(var c=a.w*a.h,d=Jmat.Complex(0),e=0;e<c;e++)d=d.add(a.get1(e).mul(b.get1(e).conj()));return d};Jmat.Matrix.inner=function(a,b){return a.transjugate().mul(b)};Jmat.Matrix.outer=function(a,b){return a.mul(b.transjugate())};
Jmat.Matrix.zsvdc_=function(a,b,c,d,e,f,g,h,k,l,m,n){var p,q;if(c&&d){var t=function(a){return Math.abs(a.re)+Math.abs(a.im)};var v=function(a,b){return b.eqr(0)?Jmat.Complex(0):b.mulr(a.abs()/b.abs())};var y=function(a,b,c){for(var d=Jmat.Complex(0),e=0;e<a;e++){var f=b[c+e];d=d.add(f.mul(f.conj()))}return Jmat.Complex.sqrt(d)};var x=function(a,b,c,d,e,f){for(var g=0;g<a;g++)e[f+g]=e[f+g].add(c[d+g].mul(b))};var w=function(a,b,c,d,e){for(var f=Jmat.Complex(0),g=0;g<a;g++)f=f.add(b[c+g].conj().mul(d[e+
g]));return f};var z=function(a,b,c,d){for(var e=0;e<a;e++)c[d+e]=c[d+e].mul(b)},A=function(a,b){var c=Math.abs(a),d=Math.abs(b);var e=Math.sqrt(a*a+b*b);var f=c>d?a:b;e=0==f?0:0>f?-Math.abs(e):Math.abs(e);a=0==e?1:a/e;b=0==e?0:b/e;return[e,c>d?b:0==e?0:0==a?1:1/a,a,b]},D=function(a,b,c,d,e,f,g){for(var h=0;h<a;h++){var k=b[c+h],l=d[e+h];b[c+h]=k.mulr(f).add(l.mulr(g));d[e+h]=l.mulr(f).sub(k.mulr(g))}},J=function(a,b,c,d,e){for(var f=0;f<a;f++){var g=b[f+c];b[f+c]=d[f+e];d[f+e]=g}},G=!1,F=!1;var I=
Math.floor(n%100/10);var B=1<I?Math.min(c,d):c;0!=I&&(G=!0);0!=n%10&&(F=!0);I=0;var C=Math.min(c-1,d);var H=Math.max(0,Math.min(d-2,c));var K=Math.max(C,H);for(n=0;n<K;n++){var u=n+1;if(n<C){e[n]=Jmat.Complex(y(c-n,a,n+n*b));if(!(1E-150>t(e[n]))){1E-150>t(a[n+n*b])||(e[n]=v(e[n],a[n+n*b]));var r=Jmat.Complex(1).div(e[n]);z(c-n,r,a,n+n*b);a[n+n*b]=a[n+n*b].addr(1)}e[n]=e[n].neg()}for(q=u;q<d;q++)n<C&&!(1E-150>t(e[n]))&&(r=w(c-n,a,n+n*b,a,n+q*b).neg().div(a[n+n*b]),x(c-n,r,a,n+n*b,a,n+q*b)),f[q]=a[n+
q*b].conj();if(G&&n<C)for(p=n;p<c;p++)g[p+n*h]=a[p+n*b];if(n<H){f[n]=Jmat.Complex(y(d-n-1,f,u));1E-150>t(f[n])||(1E-150>t(f[u])||(f[n]=v(f[n],f[u])),r=Jmat.Complex(1).div(f[n]),z(d-n-1,r,f,u),f[u]=Jmat.Complex(1).add(f[u]));f[n]=f[n].conj().neg();if(u<c&&!(1E-150>t(f[n]))){for(q=u;q<c;q++)m[q]=Jmat.Complex(0);for(q=u;q<d;q++)x(c-n-1,f[q],a,u+q*b,m,u);for(q=u;q<d;q++)x(c-n-1,f[q].neg().div(f[u]).conj(),m,u,a,u+q*b)}if(F)for(p=u;p<d;p++)k[p+n*l]=f[p]}}m=Math.min(d,c+1);C<d&&(e[C]=a[C+C*b]);c<m&&(e[m-
1]=Jmat.Complex(0));H+1<m&&(f[H]=a[H+(m-1)*b]);f[m-1]=Jmat.Complex(0);if(G){for(q=C;q<B;q++){for(p=0;p<c;p++)g[p+q*h]=Jmat.Complex(0);g[q+q*h]=Jmat.Complex(1)}for(a=0;a<C;a++)if(n=C-a-1,0==t(e[n])){for(p=0;p<c;p++)g[p+n*h]=Jmat.Complex(0);g[n+n*h]=Jmat.Complex(1)}else{for(q=u=n+1;q<B;q++)r=w(c-n,g,n+n*h,g,n+q*h).neg().div(g[n+n*h]),x(c-n,r,g,n+n*h,g,n+q*h);z(c-n,Jmat.Complex(-1),g,n+n*h);g[n+n*h]=g[n+n*h].inc();for(p=0;p<n;p++)g[p+n*h]=Jmat.Complex(0)}}if(F)for(a=0;a<d;a++){n=d-a-1;u=n+1;if(n<H&&
!(1E-150>t(f[n])))for(q=u;q<d;q++)r=w(d-u,k,u+n*l,k,u+q*l).neg().div(k[u+n*l]),x(d-u,r,k,u+n*l,k,u+q*l);for(p=0;p<d;p++)k[p+n*l]=Jmat.Complex(0);k[n+n*l]=Jmat.Complex(1)}for(p=0;p<m;p++){1E-150>t(e[p])||(r=Jmat.Complex.abs(e[p]),B=e[p].div(r),e[p]=r,p+1<m&&(f[p]=f[p].div(B)),G&&z(c,B,g,p*h));if(p+1==m)break;1E-150>t(f[p])||(r=Jmat.Complex.abs(f[p]),B=r.div(f[p]),f[p]=r,e[p+1]=e[p+1].mul(B),F&&z(d,B,k,(p+1)*l))}t=m;for(B=0;0!=m;){if(30<=B){I=m;break}for(a=1;a<=m;a++){n=m-a;if(0==n)break;r=e[n-1].abs()+
e[n].abs();x=r+f[n-1].abs();if(x==r){f[n-1]=Jmat.Complex(0);break}}if(n==m-1)u=4;else{u=n+1;a=m+1;for(w=u;w<=a;w++){var E=m-w+u;if(E==n)break;r=0;E!=m&&(r+=f[E-1].abs());E!=n+1&&(r+=f[E-2].abs());x=r+e[E-1].abs();if(x==r){e[E-1]=Jmat.Complex(0);break}}E==n?u=3:E==m?u=1:(u=2,n=E)}n++;if(1==u)for(x=m-1,u=f[m-2].re,f[m-2]=Jmat.Complex(0),a=n;a<=x;a++)r=x-a+n,p=e[r-1].re,b=A(p,u),p=b[0],u=b[1],w=b[2],b=b[3],e[r-1]=Jmat.Complex(p),r!=n&&(u=-b*f[r-2].re,f[r-2]=f[r-2].mulr(w)),F&&D(d,k,(r-1)*l,k,(m-1)*l,
w,b);else if(2==u)for(u=f[n-2].re,f[n-2]=Jmat.Complex(0),r=n;r<=m;r++)p=e[r-1].re,b=A(p,u),p=b[0],u=b[1],w=b[2],b=b[3],e[r-1]=Jmat.Complex(p),u=-b*f[r-1].re,f[r-1]=f[r-1].mulr(w),G&&D(c,g,(r-1)*h,g,(n-2)*h,w,b);else if(3==u){x=Math.max(Math.max(Math.max(Math.max(e[m-1].abs(),e[m-2].abs()),f[m-2].abs()),e[n-1].abs()),f[n-1].abs());u=e[m-1].re/x;w=e[m-2].re/x;a=f[m-2].re/x;r=e[n-1].re/x;x=f[n-1].re/x;w=((w+u)*(w-u)+a*a)/2;a*=u*a*u;b=0;if(0!=w||0!=a)b=Math.sqrt(w*w+a),0>w&&(b=-b),b=a/(w+b);u=(r+u)*(r-
u)+b;a=r*x;x=m-1;for(r=n;r<=x;r++)b=A(u,a),u=b[0],a=b[1],w=b[2],b=b[3],r!=n&&(f[r-2]=Jmat.Complex(u)),u=w*e[r-1].re+b*f[r-1].re,f[r-1]=f[r-1].mulr(w).sub(e[r-1].mulr(b)),a=b*e[r].re,e[r]=e[r].mulr(w),F&&D(d,k,(r-1)*l,k,r*l,w,b),b=A(u,a),u=b[0],a=b[1],w=b[2],b=b[3],e[r-1]=Jmat.Complex(u),u=w*f[r-1].re+b*e[r].re,e[r]=f[r-1].mulr(-b).add(e[r].mulr(w)),a=b*f[r].re,f[r]=f[r].mulr(w),G&&r<c&&D(c,g,(r-1)*h,g,r*h,w,b);f[m-2]=Jmat.Complex(u);B++}else if(4==u){0>e[n-1].re&&(e[n-1]=e[n-1].neg(),F&&z(d,Jmat.Complex(-1),
k,(n-1)*l));for(;n!=t&&!(e[n].re<=e[n-1].re);)r=e[n-1],e[n-1]=e[n],e[n]=r,F&&n<d&&J(d,k,(n-1)*l,k,n*l),G&&n<c&&J(c,g,(n-1)*h,g,n*h),n++;B=0;m--}}return I}};
Jmat.Matrix.svd=function(a){for(var b=[],c=0;c<a.h;c++)for(var d=0;d<a.w;d++)b[c+d*a.h]=a.e[c][d];var e=[],f=[],g=[];Jmat.Matrix.zsvdc_(b,a.h,a.h,a.w,e,[],f,a.h,g,a.w,[],11);for(c=0;c<e.length;c++)1E-15>Math.abs(e[c])&&(e[c]=0);b={u:new Jmat.Matrix(a.h,a.h),s:new Jmat.Matrix(a.h,a.w),v:new Jmat.Matrix(a.w,a.w)};for(c=0;c<a.h;c++)for(d=0;d<a.h;d++)b.u.e[c][d]=f[c+d*a.h];for(c=0;c<a.h;c++)for(d=0;d<a.w;d++)b.s.e[c][d]=d==c?Jmat.Complex(e[d]):Jmat.Complex(0);for(c=0;c<a.w;c++)for(d=0;d<a.w;d++)b.v.e[c][d]=
g[c+d*a.w];return b};Jmat.Matrix.polar=function(a){var b=Jmat.Matrix.svd(a);a=b.u.mulTG(b.v);b=b.v.mul(b.s).mulTG(b.v);return{u:a,p:b}};Jmat.Matrix.eq=function(a,b){if(a.w!=b.w||a.h!=b.h)return!1;for(var c=0;c<a.h;c++)for(var d=0;d<a.w;d++)if(!a.e[c][d].eq(b.e[c][d]))return!1;return!0};Jmat.Matrix.near=function(a,b,c){if(a.w!=b.w||a.h!=b.h)return!1;for(var d=0;d<a.h;d++)for(var e=0;e<a.w;e++)if(!Jmat.Complex.near(a.e[d][e],b.e[d][e],c))return!1;return!0};
Jmat.Matrix.relnear=function(a,b,c){if(a.w!=b.w||a.h!=b.h)return!1;for(var d=0;d<a.h;d++)for(var e=0;e<a.w;e++)if(!Jmat.Complex.relnear(a.e[d][e],b.e[d][e],c))return!1;return!0};
Jmat.Matrix.solve=function(a,b,c){var d=Jmat.Matrix;if(a.h==b.h){c=void 0==c?1E-12:c;if(d.isZero(b))return b=d.svd(a),Jmat.Complex.nearr(b.s.e[b.s.h-1][b.s.h-1],0,c)?d.col(b.v,a.w-1):null;b=d.augment(a,b);c=d.rref(b);a=d(a.w,1,0);for(var e=d=0;e<c.h;e++){for(var f=d;f<c.w;f++)if(!c.e[e][f].eqr(0)){if(f==c.w-1)return null;a.e[f][0]=c.e[e][b.w-1];d=f+1;break}if(f==c.w-1)break}return a}};Jmat.Matrix.leastSquares=function(a,b){return Jmat.Matrix.pseudoinverse(a).mul(b)};
Jmat.Matrix.rref=function(a){var b=Jmat.Complex,c=a.h,d=a.w;a=Jmat.Matrix.copy(a);for(var e=function(a,b,c){for(var e=0;e<d;e++){var f=a.e[b][e];a.e[b][e]=a.e[c][e];a.e[c][e]=f}},f=function(a,b,c,e){for(;b<d;b++)a.e[c][b]=a.e[c][b].mul(e)},g=function(a,b,c,d,e){for(var f=a.e[0].length;b<f;b++)a.e[e][b]=a.e[e][b].sub(a.e[c][b].mul(d))},h=[],k=0,l=0;l<d;l++){var m=Jmat.Real.argmax(k,c,function(b){return a.e[b][l].abssq()});if(!a.e[m][l].eqr(0)){m!=k&&e(a,k,m);f(a,l,k,a.e[k][l].inv());for(m=k+1;m<c;m++)a.e[m][l].eqr(0)||
(g(a,l+1,k,a.e[m][l],m),a.e[m][l]=b(0));h.push(l);k++;if(k>=c)break}}for(l=0;l<h.length;l++)for(c=h[l],e=l-1;0<=e;e--)a.e[e][c].eqr(0)||(g(a,c+1,l,a.e[e][c],e),a.e[e][c]=b(0));return a};
Jmat.Matrix.random=function(a,b,c,d,e,f){var g=Jmat.Complex,h=Jmat.Real;b=b||a||Math.floor(10*h.random()+2);a=a||Math.floor(10*h.random()+2);f=void 0==f?1:f;d=void 0==d?0:d;e=void 0==e?1:e;c=c||{real:!0};var k=c.real||c.integer,l=c.integer,m=c.binary,n=c.hermitian;c.square&&(b=a);c=function(a){if(1<=f||h.random()<f){if(m)return.5<h.random()?g(1):g(0);a=a?g(h.random()*(e-d)+d):g.random(d,e);return l?g(Math.floor(a.re)):a}return g(0)};for(var p=Jmat.Matrix(a,b),q=0;q<a;q++)for(var t=0;t<b;t++)p.e[q][t]=
n&&q>t?p.e[t][q].conj():n&&t==q?c(!0):c(k);return p};Jmat.Matrix.makeRot2D=function(a){var b=Jmat.Complex.cos(a);a=Jmat.Complex.sin(a);return Jmat.Matrix([[b,a.neg()],[a,b]])};
Jmat.Matrix.makeRot3D=function(a,b){var c=Jmat.Complex.cos(b);b=Jmat.Complex.sin(b);var d=c.rsub(1),e=a.get1(0),f=a.get1(1);a=a.get1(2);var g=Jmat.Complex.sqrt(e.mul(e).add(f.mul(f)).add(a.mul(a)));e=e.div(g);f=f.div(g);a=a.div(g);return Jmat.Matrix([[c.add(e.mul(e).mul(d)),e.mul(f).mul(d).sub(a.mul(b)),e.mul(a).mul(d).add(f.mul(b))],[f.mul(e).mul(d).add(a.mul(b)),c.add(f.mul(f).mul(d)),f.mul(a).mul(d).sub(e.mul(b))],[a.mul(e).mul(d).sub(f.mul(b)),a.mul(f).mul(d).add(e.mul(b)),c.add(a.mul(a).mul(d))]])};
Jmat.Matrix.matrixfft_=function(a,b){var c=new Jmat.Matrix(a.h,a.w);if(1<a.w)for(var d=0;d<a.h;d++)for(var e=Jmat.Complex.fft(a.e[d],b),f=0;f<a.w;f++)c.e[d][f]=e[f];else c=a;var g=new Jmat.Matrix(a.h,a.w);if(1<a.h)for(d=0;d<a.w;d++)for(e=Jmat.Matrix.transpose(Jmat.Matrix.col(c,d)),e=Jmat.Complex.fft(e.e[0],b),f=0;f<a.h;f++)g.e[f][d]=e[f];else g=c;return g};Jmat.Matrix.fft=function(a){return Jmat.Matrix.matrixfft_(a,0)};Jmat.Matrix.ifft=function(a){return Jmat.Matrix.matrixfft_(a,1)};
Jmat.Matrix.exp=function(a){if(a.h!=a.w)return null;for(var b=a.add(Jmat.Matrix.identity(a.w,a.w)),c=a,d=1,e=2;20>=e;e++)d*=e,c=c.mul(a),b=b.add(c.mulr(1/d));return b};Jmat.Matrix.cos=function(a){if(a.h!=a.w)return null;var b=Jmat.Matrix.identity(a.w,a.w);a=a.mul(a);for(var c=null,d=1,e=1,f=0;20>f;f++)d=0==f?2:d*(2*f+1)*(2*f+2),e=-e,c=null==c?a:c.mul(a),b=b.add(c.mulr(e/d));return b};
Jmat.Matrix.sin=function(a){if(a.h!=a.w)return null;for(var b=a,c=a.mul(a),d=1,e=1,f=0;20>f;f++)d*=(2*f+2)*(2*f+3),e=-e,a=a.mul(c),b=b.add(a.mulr(e/d));return b};Jmat.Matrix.sqrt=function(a){return a.h!=a.w?null:Jmat.Matrix.fun(a,function(a){return Jmat.Complex.sqrt(a)})};Jmat.Matrix.log=function(a){return Jmat.Matrix.fun(a,function(a){return Jmat.Complex.log(a)})};Jmat.Matrix.powc=function(a,b){return Jmat.Matrix.fun(a,function(a){return a.pow(b)})};
Jmat.Matrix.fun=function(a,b){if(a.h!=a.w)return null;var c=Jmat.Matrix.evd(a);a=c.v;c=c.d;for(var d=0;d<c.w;d++)c.e[d][d]=b(c.e[d][d]);return a.mul(c).mul(Jmat.Matrix.inv(a))};
Jmat.Matrix.convolve=function(a,b,c){var d=Jmat.Complex,e=Math.floor(b.h/2),f=Math.floor(b.w/2);if(c){c=a.h+b.h-1;for(var g=a.w+b.w-1,h=Jmat.Matrix(c,g),k=0;k<c;k++)for(var l=0;l<g;l++){for(var m=d(0),n=0;n<b.h;n++)for(var p=0;p<b.w;p++){var q=k-2*e+n,t=l-2*f+p;0>t||t>=a.w||0>q||q>=a.h||(m=m.add(a.e[q][t].mul(b.e[n][p])))}h.e[k][l]=m}}else for(h=Jmat.Matrix(a.h,a.w),k=0;k<a.h;k++)for(l=0;l<a.w;l++){m=d(0);for(n=0;n<b.h;n++)for(p=0;p<b.w;p++)q=k-e+n,t=l-f+p,0>t||t>=a.w||0>q||q>=a.h||(m=m.add(a.e[q][t].mul(b.e[n][p])));
h.e[k][l]=m}return h};Jmat.Complex.polyroots=function(a){var b=Jmat.Complex,c=Jmat.Matrix;if(1>=a.length)return[];for(var d=a[a.length-1].inv(),e=a.length-1,f=c(e,e,0),g=1;g<e;g++)f.e[g][g-1]=b(1);for(g=0;g<e;g++)f.e[g][e-1]=d.mul(a[g]).neg();return c.eigval(f)};Jmat.Quaternion=function(a,b,c,d){if(this instanceof Jmat.Quaternion)this.w=a,this.x=b,this.y=c,this.z=d;else return Jmat.Quaternion.make(a,b,c,d)};Jmat.Quaternion.make=function(a,b,c,d){return void 0==a?new Jmat.Quaternion(0,0,0,0):"number"==typeof a?new Jmat.Quaternion(a,b||0,c||0,d||0):"string"==typeof a?Jmat.Quaternion.parse(a):void 0!=a.re?new Jmat.Quaternion(a.re,a.im||0,b&&b.re||0,b&&b.im||0):a.e&&2==a.w&&2==a.h?Jmat.Quaternion.from2x2(a):a.e&&4==a.w&&4==a.h?Jmat.Quaternion.from4x4(a):Jmat.Quaternion.copy(a)};
Jmat.Quaternion.cast=function(a){return a&&void 0!=a.w?a:void 0==a?Jmat.Quaternion(0):Jmat.Quaternion(a)};Jmat.Quaternion.copy=function(a){return new Jmat.Quaternion(a.w,a.x,a.y,a.z)};
Jmat.Quaternion.toString=function(a,b){if(!a)return 0==a?"invalid0":""+a;var c=b?Jmat.Complex.formatFloat_(a.w,b):""+a.w,d=b?Jmat.Complex.formatFloat_(a.x,b):""+a.x,e=b?Jmat.Complex.formatFloat_(a.x,b):""+a.y;b=b?Jmat.Complex.formatFloat_(a.x,b):""+a.z;var f="";0!=a.w&&(f+=c);0!=a.x&&(f+=(0==f.length||0>a.x?d:"+"+d)+"i");0!=a.y&&(f+=(0==f.length||0>a.y?e:"+"+e)+"j");0!=a.z&&(f+=(0==f.length||0>a.z?b:"+"+b)+"k");return f};
Jmat.Quaternion.prototype.toString=function(a){return Jmat.Quaternion.toString(this,a)};
Jmat.Quaternion.parse=function(a){a=a.replace(/ /g,"");var b=a.split(/\b/);a=[];for(var c=!1,d=0;d<b.length;d++){var e=b[d];0!=d&&(c||"-"!=e[0]&&"+"!=e[0])||a.push("");a[a.length-1]+=e;c="e"==e[e.length-1]||"E"==e[e.length-1]}var f=c=b=0,g=0;for(d=0;d<a.length;d++){e=a[d];var h=e[e.length-1];if("i"==h||"j"==h||"k"==h){e=e.substr(0,e.length-1);if(""==e||"+"==e)e="1";"-"==e&&(e="-1");"i"==h&&(c=parseFloat(e));"j"==h&&(f=parseFloat(e));"k"==h&&(g=parseFloat(e))}else b=parseFloat(e)}return new Jmat.Quaternion(b,
c,f,g)};Jmat.Quaternion.add=function(a,b){return new Jmat.Quaternion(a.w+b.w,a.x+b.x,a.y+b.y,a.z+b.z)};Jmat.Quaternion.prototype.add=function(a){return new Jmat.Quaternion(this.w+a.w,this.x+a.x,this.y+a.y,this.z+a.z)};Jmat.Quaternion.sub=function(a,b){return new Jmat.Quaternion(a.w-b.w,a.x-b.x,a.y-b.y,a.z-b.z)};Jmat.Quaternion.prototype.sub=function(a){return new Jmat.Quaternion(this.w-a.w,this.x-a.x,this.y-a.y,this.z-a.z)};
Jmat.Quaternion.mul=function(a,b){return new Jmat.Quaternion(a.w*b.w-a.x*b.x-a.y*b.y-a.z*b.z,a.w*b.x+a.x*b.w+a.y*b.z-a.z*b.y,a.w*b.y-a.x*b.z+a.y*b.w+a.z*b.x,a.w*b.z+a.x*b.y-a.y*b.x+a.z*b.w)};Jmat.Quaternion.prototype.mul=function(a){return Jmat.Quaternion.mul(this,a)};Jmat.Quaternion.mulr=function(a,b){return new Jmat.Quaternion(a.w*b,a.x*b,a.y*b,a.z*b)};Jmat.Quaternion.prototype.mulr=function(a){return new Jmat.Quaternion(this.w*a,this.x*a,this.y*a,this.z*a)};
Jmat.Quaternion.divr=function(a,b){return new Jmat.Quaternion(a.w/b,a.x/b,a.y/b,a.z/b)};Jmat.Quaternion.prototype.divr=function(a){return new Jmat.Quaternion(this.w/a,this.x/a,this.y/a,this.z/a)};Jmat.Quaternion.addr=function(a,b){return new Jmat.Quaternion(a.w+b,a.x,a.y,a.z)};Jmat.Quaternion.prototype.addr=function(a){return new Jmat.Quaternion(this.w+a,this.x,this.y,this.z)};Jmat.Quaternion.subr=function(a,b){return new Jmat.Quaternion(a.w-b,a.x,a.y,a.z)};
Jmat.Quaternion.prototype.subr=function(a){return new Jmat.Quaternion(this.w-a,this.x,this.y,this.z)};Jmat.Quaternion.rsub=function(a,b){return new Jmat.Quaternion(b-a.w,-a.x,-a.y,-a.z)};Jmat.Quaternion.prototype.rsub=function(a){return new Jmat.Quaternion(a-this.w,-this.x,-this.y,-this.z)};Jmat.Quaternion.neg=function(a){return Jmat.Quaternion(-a.w,-a.x,-a.y,-a.z)};Jmat.Quaternion.prototype.neg=function(){return Jmat.Quaternion(-this.w,-this.x,-this.y,-this.z)};
Jmat.Quaternion.conj=function(a){return Jmat.Quaternion(a.w,-a.x,-a.y,-a.z)};Jmat.Quaternion.prototype.conj=function(){return Jmat.Quaternion(this.w,-this.x,-this.y,-this.z)};Jmat.Quaternion.abs=function(a){return Jmat.Quaternion(a.abs())};Jmat.Quaternion.prototype.abs=function(){return Math.sqrt(this.abssq())};Jmat.Quaternion.abssq=function(a){return Jmat.Quaternion(a.abssq())};
Jmat.Quaternion.prototype.abssq=function(){return-Infinity==this.w||-Infinity==this.x||-Infinity==this.y||-Infinity==this.z?Infinity:this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z};Jmat.Quaternion.dist=function(a,b){return a.sub(b).abs()};Jmat.Quaternion.cheb=function(a,b){return Math.max(Math.max(Jmat.Real.dist(a.w,b.w),Jmat.Real.dist(a.x,b.x)),Math.max(Jmat.Real.dist(a.y,b.y),Jmat.Real.dist(a.z,b.z)))};
Jmat.Quaternion.manhattan=function(a,b){return Math.abs(a.w-b.w)+Math.abs(a.x-b.x)+Math.abs(a.y-b.y)+Math.abs(a.z-b.z)};Jmat.Quaternion.absv=function(a){return Jmat.Quaternion(a.absv())};Jmat.Quaternion.prototype.absv=function(){return Math.sqrt(this.absvsq())};Jmat.Quaternion.absvsq=function(a){return Jmat.Quaternion(a.abssq())};Jmat.Quaternion.prototype.absvsq=function(){return-Infinity==this.x||-Infinity==this.y||-Infinity==this.z?Infinity:this.x*this.x+this.y*this.y+this.z*this.z};
Jmat.Quaternion.arg=function(a){return Jmat.Quaternion(a.arg())};Jmat.Quaternion.prototype.arg=function(){return Math.atan2(this.absv(),this.w)};Jmat.Quaternion.inv=function(a){return a.conj().divr(a.abssq())};Jmat.Quaternion.prototype.inv=function(){return this.conj().divr(this.abssq())};Jmat.Quaternion.div=function(a,b){return a.mul(b.inv())};Jmat.Quaternion.prototype.div=function(a){return this.mul(a.inv())};Jmat.Quaternion.leftdiv=function(a,b){return a.inv().mul(b)};
Jmat.Quaternion.prototype.leftdiv=function(a){return this.inv().mul(a)};Jmat.Quaternion.sign=function(a){var b=a.abs();return 0==b?a:a.divr(b)};Jmat.Quaternion.normalize=Jmat.Quaternion.sign;Jmat.Quaternion.prototype.normalize=function(){return Jmat.Quaternion.sign(this)};Jmat.Quaternion.to2x2=function(a){var b=Jmat.Complex;return[[b(a.w,a.x),b(a.y,a.z)],[b(-a.y,a.z),b(a.w,-a.x)]]};Jmat.Quaternion.from2x2=function(a){var b=a.e?a.e:a;a=b[0][0];b=b[0][1];return new Jmat.Quaternion(a.re,a.im,b.re,b.im)};
Jmat.Quaternion.to4x4=function(a){return[[a.w,a.x,a.y,a.z],[-a.x,a.w,-a.z,a.y],[-a.y,a.z,a.w,-a.x],[-a.z,-a.y,a.x,a.w]]};Jmat.Quaternion.from4x4=function(a){a=a.e?a.e:a;return new Jmat.Quaternion(a[0][0].re,a[0][1].re,a[0][2].re,a[0][3].re)};Jmat.Quaternion.to3x3rot=function(a){var b=a.w*a.w,c=a.x*a.x,d=a.y*a.y,e=a.z*a.z;return[[b+c-d-e,2*a.x*a.y-2*a.w*a.z,2*a.x*a.z+2*a.w*a.y],[2*a.x*a.y+2*a.w*a.z,b-c+d-e,2*a.y*a.z-2*a.w*a.x],[2*a.x*a.z-2*a.w*a.y,2*a.y*a.z+2*a.w*a.x,b-c-d+e]]};
Jmat.Quaternion.from3x3rot=function(a){a=a.e?a.e:a;var b=1+a[0][0].re+a[1][1].re+a[2][2].re;if(1E-7<b)return b=2*Math.sqrt(b),new Jmat.Quaternion(.25*b,(a[2][1].re-a[1][2].re)/b,(a[0][2].re-a[2][0].re)/b,(a[1][0].re-a[0][1].re)/b);if(a[0][0].re>a[1][1].re&&a[0][0].re>a[2][2].re)return b=2*Math.sqrt(1+a[0][0].re-a[1][1].re-a[2][2].re),new Jmat.Quaternion((a[2][1].re-a[1][2].re)/b,.25*b,(a[1][0].re+a[0][1].re)/b,(a[0][2].re-a[2][0].re)/b);if(a[1][1].re>a[2][2].re)return b=2*Math.sqrt(1+a[1][1].re-a[0][0].re-
a[2][2].re),new Jmat.Quaternion((a[0][2].re-a[2][0].re)/b,(a[1][0].re+a[0][1].re)/b,.25*b,(a[2][1].re+a[1][2].re)/b);b=2*Math.sqrt(1+a[2][2].re-a[0][0].re-a[1][1].re);return new Jmat.Quaternion((a[1][0].re-a[0][1].re)/b,(a[0][2].re+a[2][0].re)/b,(a[2][1].re+a[1][2].re)/b,.5*b)};Jmat.Quaternion.prototype.getVector=function(){return[[this.x],[this.y],[this.z]]};Jmat.Quaternion.prototype.qvector=function(){return new Jmat.Quaternion(0,this.x,this.y,this.z)};
Jmat.Quaternion.exp=function(a){var b=Math.exp(a.w),c=a.absv(),d=b*Math.sin(c)/c;return new Jmat.Quaternion(b*Math.cos(c),d*a.x,d*a.y,d*a.z)};Jmat.Quaternion.log=function(a){var b=a.abs(),c=a.absv();if(0==c)return new Jmat.Quaternion(Math.log(a.w),0,0,0);c=Math.acos(a.w/b)/c;return new Jmat.Quaternion(Math.log(b),c*a.x,c*a.y,c*a.z)};Jmat.Quaternion.logy=function(a,b){return Jmat.Quaternion.log(a).div(Jmat.Quaternion.log(b))};Jmat.Quaternion.logr=function(a,b){return Jmat.Quaternion.log(a).divr(Math.log(b))};
Jmat.Quaternion.log2=function(a){return Jmat.Quaternion.log(a).divr(Math.LN2)};Jmat.Quaternion.log10=function(a){return Jmat.Quaternion.log(a).divr(Math.LN10)};Jmat.Quaternion.pow=function(a,b){var c=Jmat.Quaternion;return c.exp(c.log(a).mul(b))};Jmat.Quaternion.prototype.pow=function(a){return Jmat.Quaternion.pow(this,a)};Jmat.Quaternion.powr=function(a,b){var c=Jmat.Quaternion;return c.exp(c.log(a).mulr(b))};Jmat.Quaternion.prototype.powr=function(a){return Jmat.Quaternion.powr(this,a)};
Jmat.Quaternion.sqrt=function(a){return a.powr(.5)};Jmat.Quaternion.eq=function(a,b){return a&&b?a.w==b.w&&a.x==b.x&&a.y==b.y&&a.z==b.z:a==b};Jmat.Quaternion.prototype.eq=function(a){return a&&this.w==a.w&&this.x==a.x&&this.y==a.y&&this.z==a.z};Jmat.Quaternion.eqr=function(a,b){return a&&b?a.w==b&&0==a.x&&0==a.y&&0==a.z:a==b};Jmat.Quaternion.prototype.eqr=function(a){return this.w==a&&0==this.x&&0==this.y&&0==this.z};
Jmat.Quaternion.near=function(a,b,c){return a.w-c<=b.w&&a.w+c>=b.w&&a.x-c<=b.x&&a.x+c>=b.x&&a.y-c<=b.y&&a.x+c>=b.y&&a.z-c<=b.z&&a.x+c>=b.z};Jmat.Quaternion.relnear=function(a,b,c){return a.eq(b)?!0:a.sub(b).abs()<Math.max(a.abs(),b.abs())*c};Jmat.Quaternion.ONE=new Jmat.Quaternion(1,0,0,0);Jmat.Quaternion.I=new Jmat.Quaternion(0,1,0,0);Jmat.Quaternion.J=new Jmat.Quaternion(0,0,1,0);Jmat.Quaternion.K=new Jmat.Quaternion(0,0,0,1);
Jmat.Quaternion.sin=function(a){var b=a.absv(),c=Math.sin(a.w)*Jmat.Real.cosh(b),d=Math.cos(a.w)*Jmat.Real.sinh(b);return new Jmat.Quaternion(c,d*a.x/b,d*a.y/b,d*a.z/b)};Jmat.Quaternion.cos=function(a){var b=a.absv();if(0==b)return Jmat.Quaternion(Math.cos(a.w),0,0,0);var c=Math.cos(a.w)*Jmat.Real.cosh(b),d=Math.sin(a.w)*Jmat.Real.sinh(b);return new Jmat.Quaternion(c,-d*a.x/b,-d*a.y/b,-d*a.z/b)};Jmat.Quaternion.tan=function(a){var b=Jmat.Quaternion;return b.sin(a).div(b.cos(a))};
Jmat.Quaternion.asin=function(a){var b=0==a.absvsq()?Jmat.Quaternion.I:a.qvector().divr(a.absv());return b.mul(Jmat.Quaternion.asinh(a.mul(b))).neg()};Jmat.Quaternion.acos=function(a){return(0==a.absvsq()?Jmat.Quaternion.I:a.qvector().divr(a.absv())).mul(Jmat.Quaternion.acosh(a)).neg()};Jmat.Quaternion.atan=function(a){var b=0==a.absvsq()?Jmat.Quaternion.I:a.qvector().divr(a.absv());return b.conj().mul(Jmat.Quaternion.atanh(a.mul(b)))};
Jmat.Quaternion.sinh=function(a){a=Jmat.Quaternion.exp(a);var b=Jmat.Quaternion.inv(a);return a.sub(b).divr(2)};Jmat.Quaternion.cosh=function(a){a=Jmat.Quaternion.exp(a);var b=Jmat.Quaternion.inv(a);return a.add(b).divr(2)};Jmat.Quaternion.tanh=function(a){a=Jmat.Quaternion.exp(a);var b=Jmat.Quaternion.inv(a);return a.sub(b).div(a.add(b))};Jmat.Quaternion.asinh=function(a){return Jmat.Quaternion.log(a.add(Jmat.Quaternion.sqrt(a.mul(a).addr(1))))};Jmat.Quaternion.acosh=function(a){return Jmat.Quaternion.log(a.add(Jmat.Quaternion.sqrt(a.subr(1)).mul(Jmat.Quaternion.sqrt(a.addr(1)))))};
Jmat.Quaternion.atanh=function(a){return Jmat.Quaternion.log(a.addr(1).div(a.rsub(1))).mulr(.5)};Jmat.Quaternion.isReal=function(a){return 0==a.x&&0==a.y&&0==a.z};Jmat.Quaternion.isNaN=function(a){return isNaN(a.w)||isNaN(a.x)||isNaN(a.y)||isNaN(a.z)};Jmat.Quaternion.isInf=function(a){return Infinity==Math.abs(a.w)||Infinity==Math.abs(a.x)||Infinity==Math.abs(a.y)||Infinity==Math.abs(a.z)};Jmat.Quaternion.isInfOrNaN=function(a){return!a||Jmat.Quaternion.isNaN(a)||Jmat.Quaternion.isInf(a)};
Jmat.Quaternion.lambertwb=function(a,b){return Jmat.Complex.lambertwb_generic_(Jmat.Quaternion,a,b)};Jmat.Quaternion.lambertw=function(a){return Jmat.Quaternion.lambertwb(0,a)};Jmat.Quaternion.lambertwm=function(a){return Jmat.Quaternion.lambertwb(-1,a)};Jmat.Complex.hypergeometric0F1=function(a,b){var c=Jmat.Complex;if(c.isNegativeInt(a))return c(Infinity,Infinity);if(-80>b.re&&a.abssq()<b.abssq()/3){var d=c.gamma(a).divr(2*c.SQRTPI.re),e=c.sqrt(b.neg());b=c.exp(e.muli(-2)).mul(e.muli(-1).pow(a.rsub(.5)));var f=c.hypergeometric([a.subr(.5),a.rsub(1.5)],[],e.muli(4).inv().neg()),g=c.exp(e.muli(2)).mul(e.muli(1).pow(a.rsub(.5)));a=c.hypergeometric([a.subr(.5),a.rsub(1.5)],[],e.muli(4).inv());return d.mul(b.mul(f).add(g.mul(a)))}d=c.ONE;c=c.ZERO;for(f=
0;30>f;f++){0<f&&(d.eqr(0)||(d=d.div(a.addr(f-1))),d=d.mul(b).divr(f));if(d.eqr(0))break;c=c.add(d)}return c};Jmat.Complex.hypergeometric1F1_series_=function(a,b,c){var d=Jmat.Complex,e=a.div(b).mul(c).divr(1);d=d(1);for(var f=1;200>f;f++){1<f&&(e=e.mul(a.addr(f-1)),e.eqr(0)||(e=e.div(b.addr(f-1))),e=e.mul(c),e=e.divr(f));if(e.eqr(0)||1E-28>e.abssq()/d.abssq())break;d=d.add(e)}return d};
Jmat.Complex.hypergeometric1F1_asymp_=function(a,b,c){var d=Jmat.Complex;if(d.isNegativeInt(b))return d(NaN);for(var e=d.ONE,f=d.ONE,g=d.ONE,h=d.ONE,k=1;30>k&&!(g=g.mul(a.addr(k-1)).mul(a.sub(b).addr(k)).divr(k).div(c.neg()),h=h.mul(b.sub(a).addr(k-1)).mul(a.rsub(k)).divr(k).div(c),e=e.add(g),f=f.add(h),1E-28>g.abssq()&&1E-28>h.abssq());k++);if(1E-10<g.abssq()||1E-10<h.abssq())return d(NaN);g=0>=c.arg()?-1:1;if(100>c.abs())return g=d.gammaDiv_(b,b.sub(a)).mul(d.exp(a.muli(g*Math.PI))).div(c.pow(a)),
a=d.gammaDiv_(b,a).mul(d.exp(c)).mul(c.pow(a.sub(b))),g.mul(e).add(a.mul(f));g=d.loggammaDiv_(b,b.sub(a)).add(a.muli(g*Math.PI)).sub(d.log(c).mul(a));a=d.loggammaDiv_(b,a).add(c).add(d.log(c).mul(a.sub(b)));return d.exp(g.add(d.log(e))).add(d.exp(a.add(d.log(f))))};
Jmat.Complex.hypergeometric1F1_rational_=function(a,b,c){var d=Jmat.Complex;c=c.neg();var e=c.mul(c),f=e.mul(c),g=b.mul(b.inc()),h=d(1),k=d(1).add(a.inc().mul(c).div(b).divr(2)),l=d(1).add(a.addr(2).mul(c).div(b.inc()).divr(2)).add(a.inc().mul(a.addr(2)).mul(e).div(g).divr(12)),m=a.mul(c).div(b),n=d(1),p=k.sub(m),q=a.addr(2).mul(c).div(b.inc()).divr(2).inc();e=a.mul(a.inc()).mul(e).div(g).divr(2);m=l.sub(m.mul(q)).add(e);for(q=3;50>q;q++){g=2*q;var t=a.rsub(q-2).div(b.addr(q-1).mulr(2*(g-3)));e=a.addr(q).mul(a.addr(q-
1)).div(b.addr(q-1).mul(b.addr(q-2)).mulr(4*(g-3)*(g-1)));var v=a.addr(q-2).mul(a.addr(q-1)).mul(a.rsub(q-2)).div(b.addr(q-3).mul(b.addr(q-2)).mul(b.addr(q-1)).mulr(8*(g-3)*(g-3)*(g-5))).neg();g=a.addr(q-1).mul(b.rsub(q-1)).div(b.addr(q-2).mul(b.addr(q-1)).mulr(2*(g-3))).neg();t=t.mul(c).inc();e=e.mul(c).add(g).mul(c);g=v.mul(f);v=m.mul(t).add(p.mul(e)).add(n.mul(g));t=l.mul(t).add(k.mul(e)).add(h.mul(g));n=p;p=m;m=v;h=k;k=l;l=t}a=p.div(k);b=v.div(t);d=1E-10<a.sub(b).abs()?d(NaN):b;return d};
Jmat.Complex.hypergeometric1F1=function(a,b,c){var d=Jmat.Complex;if(b.sub(a).abssq()<a.abssq())return d.hypergeometric1F1(b.sub(a),b,c.neg()).mul(d.exp(c));if(a.eq(b))return d.exp(c);if(d.isNegativeInt(b)&&!(d.isNegativeInt(a)&&a.re>=b.re))return d(Infinity);if(a.eqr(0)||c.eqr(0))return d(1);if(c.eqr(Infinity))return d(Infinity,Infinity);if(8>c.mul(a).div(b).abs())return d.hypergeometric1F1_series_(a,b,c);var e=d.hypergeometric1F1_asymp_(a,b,c);d.isNaN(e)&&(e=d.hypergeometric1F1_rational_(a,b,c));
return e};
Jmat.Complex.hypergeometric2F1=function(a,b,c,d){var e=Jmat.Complex;if(1.0001<d.abs()){var f=d.div(d.dec());if(.75>f.abs())return e.ONE.sub(d).pow(a.neg()).mul(e.hypergeometric2F1(a,c.sub(b),c,f));f=e.isNegativeIntOrZero;if(f(a)||f(b)||f(b)||e.isInt(a.sub(b))||f(c.sub(a))||f(c.sub(b)))a=a.addr(1E-8),b=b.subr(2E-8),c=c.addr(3E-8);var g=d.inv();f=d.neg().pow(a.neg());d=d.neg().pow(b.neg());var h=e.gammaDiv22_(c,b.sub(a),b,c.sub(a)),k=e.gammaDiv22_(c,a.sub(b),a,c.sub(b)),l=e.hypergeometric2F1(a,e.ONE.sub(c).add(a),
e.ONE.sub(b).add(a),g);a=e.hypergeometric2F1(b,e.ONE.sub(c).add(b),e.ONE.sub(a).add(b),g);b=h.mul(f).mul(l);a=k.mul(d).mul(a);return b.add(a)}f=d.div(d.dec());if(f.abs()<d.abs())return e.ONE.sub(d).pow(a.neg()).mul(e.hypergeometric2F1(a,c.sub(b),c,f));f=30;.5<d.abs()&&(f=60);.75<d.abs()&&(f=100);k=a.mul(b).div(c).mul(d);g=e(1);for(h=1;h<f;h++){1<h&&(k=k.mul(a.addr(h-1)),k=k.mul(b.addr(h-1)),k.eqr(0)||(k=k.div(c.addr(h-1))),k=k.mul(d),k=k.divr(h));if(k.eqr(0))break;if(e.near(k,e.ZERO,1E-15))break;
g=g.add(k)}return g};Jmat.Complex.generalized_hypergeometric_=function(a,b,c){for(var d=c,e=0;e<a.length;e++)d=d.mul(a[e]);for(e=0;e<b.length;e++)d=d.div(b[e]);for(var f=Jmat.Complex(1),g=1;40>g;g++){if(1<g){for(e=0;e<a.length;e++)d=d.mul(a[e].addr(g-1));for(e=0;e<b.length;e++)d=d.eqr(0)?d:d.div(b[e].addr(g-1));d=d.mul(c);d=d.divr(g)}if(d.eqr(0))break;f=f.add(d)}return f};
Jmat.Complex.hypergeometric=function(a,b,c){return c.eqr(0)?Jmat.Complex(1):0==a.length&&0==b.length?Jmat.Complex.exp(c):1==a.length&&0==b.length?Jmat.Complex.pow(c.rsub(1),a[0].neg()):0==a.length&&1==b.length?Jmat.Complex.hypergeometric0F1(b[0],c):1==a.length&&1==b.length?Jmat.Complex.hypergeometric1F1(a[0],b[0],c):2==a.length&&1==b.length?Jmat.Complex.hypergeometric2F1(a[0],a[1],b[0],c):Jmat.Complex.generalized_hypergeometric_(a,b,c)};
Jmat.Complex.regularized_hypergeometric=function(a,b,c){for(var d=Jmat.Complex,e=d(1),f=!1,g=0;g<b.length;g++){if(!f&&d.isInt(b[g])&&0>=b[g].re){f=[];for(var h=[],k=0;k<a.length;k++)f[k]=d.isInt(a[k])?a[k].addr(1E-7):a[k];for(k=0;k<b.length;k++)h[k]=d.isInt(b[k])?b[k].addr(1E-7):b[k];a=f;b=h;f=!0}e=e.mul(d.gamma(b[g]))}return d.hypergeometric(a,b,c).div(e)};
Jmat.Complex.legendrep=function(a,b,c,d){var e=Jmat.Complex;if(b.eqr(0)&&e.isInt(a)&&0<=a.re){if(0==a.re)return e(1);if(1==a.re)return c;if(2==a.re)return c.mul(c).mulr(3).subr(1).divr(2)}d=d||2;if(!(1>d||3<d)){var f=c.addr(1).pow(b.divr(2));d=3==d?c.subr(1).pow(b.divr(2)):c.rsub(1).pow(b.divr(2));a=e.regularized_hypergeometric([a.neg(),a.addr(1)],[b.rsub(1)],c.rsub(1).divr(2));return f.div(d).mul(a)}};
Jmat.Complex.legendreq=function(a,b,c,d){var e=Jmat.Complex;d=d||2;if(!(1>d||3<d)){var f=function(a){if(0==a.im&&Jmat.Real.isInt(2*a.re)){var b=Jmat.Real.mod(Math.round(2*a.re),4);if(0==b)return e(1,0);if(1==b)return e(0,1);if(2==b)return e(-1,0);if(3==b)return e(0,-1)}return e.exp(a.muli(Math.PI))};if(3==d){d=a.add(b).addr(1);var g=e(Jmat.Real.SQRTPI).mul(e.gamma(d)),h=e(2).pow(a.addr(1));f=f(b);var k=c.pow(d);b=c.addr(1).pow(b.divr(2)).mul(c.subr(1).pow(b.divr(2)));a=e.regularized_hypergeometric([d.divr(2),
d.addr(1).divr(2)],[a.addr(1.5)],c.mul(c).inv());return g.div(h).mul(f).div(k).mul(b).mul(a)}e.isInt(b)&&(b=b.addr(1E-8));g=e(Math.PI).div(e.sin(b.mulr(Math.PI)).mulr(2));h=e.cos(b.mulr(Math.PI));f=e.legendrep(a,b,c,d);k=e.gammaDiv_(b.add(a).addr(1),e(1).sub(b).add(a));a=e.legendrep(a,b.neg(),c,d);return g.mul(h.mul(f).sub(k.mul(a)))}};Jmat.Complex.loggamma=function(a){return Jmat.Complex.loggamma_(a)};
Jmat.Real.loggamma=function(a){if(0>a)return a==Math.floor(a)?Infinity:Math.log(Math.PI/Math.abs(Math.sin(Math.PI*a)))-Jmat.Real.loggamma(1-a);if(1==a||2==a)return 0;if(Infinity==a)return Infinity;if(-Infinity==a)return NaN;if(1>a&&0<=a)return Math.log(Math.abs(Jmat.Real.gamma(a)));if(-20<a&&20>a)return Math.log(Math.abs(Real.gamma(a)));var b=.9189385332046727+(a-.5)*Math.log(a);var c=a*a*a,d=c*a*a,e=d*a*a;b=b-a+1/(12*a)-1/(360*c)+1/(1260*d);b-=1/(1680*e);return b+=1/(e*a*a*1188)};
Jmat.Complex.gamma_inv=function(a){if(Jmat.Complex.isPositive(a)&&.85<a.re)return a=Math.log((a.re+.036533814484900416)/Math.sqrt(2*Math.PI)),Jmat.Complex(a/Jmat.Real.lambertw(a/Math.E)+.5);var b=Jmat.Complex.finvert_newton(a,Jmat.Complex.gamma,function(a){return Jmat.Complex.gamma(a).mul(Jmat.Complex.digamma(a))});return Jmat.Complex.near(Jmat.Complex.gamma(b),a,.01)?b:Jmat.Complex(NaN)};
Jmat.Complex.digamma=function(a){var b=Jmat.Real.frac(a.re);if(.001>b||.999<b||.499<b&&.501>b){if(-98>a.re)return Jmat.Complex.loggamma(a.addr(3E-4)).sub(Jmat.Complex.loggamma(a.addr(1E-4))).divr(2E-4);b=Jmat.Complex.gamma(a.addr(1E-4)).sub(Jmat.Complex.gamma(a.subr(1E-4))).divr(2E-4).div(Jmat.Complex.gamma(a));return Jmat.Complex.isInfOrNaN(b)&&!Jmat.Complex.isInf(a)&&0!=a.im?Jmat.Complex.loggamma(a.addr(3E-4)).sub(Jmat.Complex.loggamma(a.addr(1E-4))).divr(2E-4):b}return Jmat.Complex.loggamma(a.addr(1E-4)).sub(Jmat.Complex.loggamma(a.subr(1E-4))).divr(2E-4)};
Jmat.Complex.trigamma=function(a){var b=Jmat.Real.frac(a.re);if(.001>b||.999<b||.499<b&&.501>b){var c=Jmat.Complex.gamma(a.addr(-2E-4));b=Jmat.Complex.gamma(a.addr(-1E-4));var d=Jmat.Complex.gamma(a),e=Jmat.Complex.gamma(a.addr(1E-4));a=Jmat.Complex.gamma(a.addr(2E-4));c=c.sub(d).divr(2E-4).div(b);b=d.sub(a).divr(2E-4).div(e)}else c=Jmat.Complex.loggamma(a.addr(-2E-4)),b=Jmat.Complex.loggamma(a),d=Jmat.Complex.loggamma(a.addr(2E-4)),c=c.sub(b).divr(2E-4),b=b.sub(d).divr(2E-4);return c.sub(b).divr(2E-4)};
Jmat.Complex.polygamma=function(a,b){if(a.eqr(0))return Jmat.Complex.digamma(b);if(a.eqr(1))return Jmat.Complex.trigamma(b);b=Jmat.Complex.hurwitzzeta(a.inc(),b);return Jmat.Complex(-1).pow(a.inc()).mul(Jmat.Complex.factorial(a)).mul(b)};
Jmat.Complex.incgamma_lower=function(a,b){if(0<b.re){var c=b.pow(a).div(a).mul(Jmat.Complex.hypergeometric1F1(a,a.inc(),b.neg()));if(!Jmat.Complex.isNaN(c))return c}c=Jmat.Complex(0);for(var d=Jmat.Complex(1),e=b.pow(a),f=1,g=5<b.abs()?50:30,h=0;h<g;h++)0<h&&(d/=h,f=-f,e=e.mul(b)),c=c.add(Jmat.Complex(f*d).mul(e).div(a.addr(h)));return c};Jmat.Real.incgamma_lower=function(a,b){for(var c=0,d=1,e=Math.pow(b,a),f=1,g=0;30>g;g++)0<g&&(d/=g,f=-f,e*=b),c+=f*d*e/(a+g);return c};
Jmat.Complex.incgamma_upper=function(a,b){Jmat.Complex.isNegativeIntOrZero(a)&&(a=a.addr(1E-7));return Jmat.Complex.gamma(a).sub(Jmat.Complex.incgamma_lower(a,b))};Jmat.Real.incgamma_upper=function(a,b){Jmat.Real.isNegativeIntOrZero(a)&&(a+=1E-7);return Jmat.Real.gamma(a)-Jmat.Complex.incgamma_lower(a,b)};Jmat.Complex.gamma_p_cache_=[];
Jmat.Complex.gamma_p=function(a,b){if(Jmat.Complex.isNegativeIntOrZero(a))return Jmat.Complex(1);var c=Jmat.Complex.calcCache_(a,Jmat.Complex.gamma,Jmat.Complex.gamma_p_cache_);return Jmat.Complex.incgamma_lower(a,b).div(c)};Jmat.Real.gamma_p_cache_=[];Jmat.Real.gamma_p=function(a,b){if(Jmat.Real.isNegativeIntOrZero(a))return 1;var c=Jmat.Real.calcCache_(a,Jmat.Real.gamma,Jmat.Real.gamma_p_cache_);return Jmat.Real.incgamma_lower(a,b)/c};
Jmat.Complex.gamma_q=function(a,b){return Jmat.Complex.isNegativeIntOrZero(a)?Jmat.Complex(0):Jmat.Complex.ONE.sub(Jmat.Complex.gamma_p(a,b))};Jmat.Real.gamma_q=function(a,b){return Jmat.Real.isNegativeIntOrZero(a)?0:1-Jmat.Real.gamma_p(a,b)};Jmat.Complex.gamma_p_inv=function(a,b){return!Jmat.Complex.isReal(b)||!Jmat.Complex.isReal(a)||0>b.re||1<b.re||0>a.re?Jmat.Complex(NaN):Jmat.Complex(Jmat.Real.gamma_p_inv(a.re,b.re))};
Jmat.Real.gamma_p_inv=function(a,b){if(0>b||1<b||0>a)return NaN;var c=a+1,d=c*c,e=a+2,f=a*a,g=f*a,h=a+3,k=[0,1];k[2]=1/(a+1);k[3]=(3*a+5)/(2*d*e);k[4]=(8*f+33*a+31)/(3*d*c*e*h);k[5]=(125*g*a+1179*g+3971*f+5661*a+2888)/(24*d*d*e*e*h*(a+4));c=Math.pow(b*Jmat.Real.gamma(c),1/a);k=Jmat.Real.powerSeries(k,k.length,0,c);var l=Jmat.Real.gamma(a);return Jmat.Real.finvert_newton(b,function(b){return Jmat.Real.gamma_p(a,b)},function(b){return Math.exp(-b)*Math.pow(b,a-1)/l},k,4)};
Jmat.Complex.gamma_q_inva=function(a,b){return Jmat.Complex.rootfind_bisection(Jmat.Complex(0),Jmat.Complex(100),function(c){return Jmat.Complex.gamma_q(c,b).sub(a)})};Jmat.Real.gamma_q_inva=function(a,b){return Jmat.Real.rootfind_bisection(0,100,function(c){return Jmat.Real.gamma_q(c,b)-a})};
Jmat.Complex.gammaDiv_=function(a,b){var c=Jmat.Complex;if(a.eq(b))return c.ONE;if(c.isInfOrNaN(a)||c.isInfOrNaN(b))return c(NaN);if(c.isNegativeIntOrZero(b)&&(0<a.re||!c.isInt(a)))return c.ZERO;if(c.isInt(a)&&c.isInt(b)){if(0>=a.re&&0>=b.re){var d=Jmat.Real.isOdd(a.re-b.re)?-1:1;return c.gammaDiv_(b.rsub(1),a.rsub(1)).mulr(d)}if(0<a.re&&0<b.re&&16>Jmat.Real.dist(a.re,b.re)){if(a.re>b.re){d=b.re;for(var e=b.re+1;e<a.re;e++)d*=e}else for(d=1/a.re,e=a.re+1;e<b.re;e++)d/=e;return c(d)}}return c.gamma(a).div(c.gamma(b))};
Jmat.Complex.gammaDiv12_=function(a,b,c){var d=Jmat.Complex;return d.isNegativeIntOrZero(b)?d.isNegativeIntOrZero(c)&&(0<a.re||!d.isInt(a))?d.ZERO:d.gammaDiv_(a,b).div(d.gamma(c)):d.gammaDiv_(a,c).div(d.gamma(b))};Jmat.Complex.gammaDiv21_=function(a,b,c){var d=Jmat.Complex;return d.isNegativeIntOrZero(a)?d.gammaDiv_(a,c).mul(d.gamma(b)):d.gammaDiv_(b,c).mul(d.gamma(a))};
Jmat.Complex.gammaDiv22_=function(a,b,c,d){var e=Jmat.Complex;return e.isNegativeIntOrZero(a)==e.isNegativeIntOrZero(c)?e.gammaDiv_(a,c).mul(e.gammaDiv_(b,d)):e.gammaDiv_(a,d).mul(e.gammaDiv_(b,c))};
Jmat.Complex.loggammaDiv_=function(a,b){var c=Jmat.Complex;if(a.eq(b))return c.ZERO;if(c.isInfOrNaN(a)||c.isInfOrNaN(b))return c(NaN);if(c.isNegativeIntOrZero(b)&&(0<a.re||!c.isInt(a)))return c(-Infinity);if(c.isInt(a)&&c.isInt(b)&&0>=a.re&&0>=b.re){var d=Jmat.Real.isOdd(a.re-b.re)?-1:1;a=c.loggammaDiv_(b.rsub(1),a.rsub(1));-1==d&&(a=a.add(c.newi(Math.PI)));return a}return c.loggamma(a).sub(c.loggamma(b))};
Jmat.Complex.loggammaDiv12_=function(a,b,c){var d=Jmat.Complex;return d.isNegativeIntOrZero(b)?d.isNegativeIntOrZero(c)&&(0<a.re||!d.isInt(a))?d(-Infinity):d.loggammaDiv_(a,b).sub(d.loggamma(c)):d.loggammaDiv_(a,c).sub(d.loggamma(b))};Jmat.Complex.loggammaDiv21_=function(a,b,c){var d=Jmat.Complex;return d.isNegativeIntOrZero(a)?d.loggammaDiv_(a,c).add(d.loggamma(b)):d.loggammaDiv_(b,c).add(d.loggamma(a))};
Jmat.Complex.loggammaDiv2_=function(a,b,c,d){var e=Jmat.Complex;return e.isNegativeIntOrZero(a)==e.isNegativeIntOrZero(c)?e.loggammaDiv_(a,c).add(e.loggammaDiv_(b,d)):e.loggammaDiv_(a,d).add(e.loggammaDiv_(b,c))};
Jmat.Real.gammaDiv_=function(a,b){var c=Jmat.Real;if(a==b)return 1;if(c.isInfOrNaN(a)||c.isInfOrNaN(b))return NaN;if(c.isNegativeIntOrZero(b)&&(0<a.re||!c.isInt(a)))return 0;if(c.isNegativeIntOrZero(a)&&c.isNegativeIntOrZero(b)){var d=c.isOdd(a-b)?-1:1;return c.gammaDiv_(1-b,1-a)*d}return 10<a&&10<b?Math.exp(c.loggamma(a)-c.loggamma(b)):c.gamma(a)/c.gamma(b)};
Jmat.Real.gammaDiv12_=function(a,b,c){var d=Jmat.Real;return d.isNegativeIntOrZero(b)?d.isNegativeIntOrZero(c)&&(0<a||!d.isInt(a))?0:d.gammaDiv_(a,b)/d.gamma(c):d.gammaDiv_(a,c)/d.gamma(b)};Jmat.Real.gammaDiv21_=function(a,b,c){var d=Jmat.Real;return d.isNegativeIntOrZero(a)?d.gammaDiv_(a,c)*d.gamma(b):d.gammaDiv_(b,c)*d.gamma(a)};
Jmat.Real.gammaDiv22_=function(a,b,c,d){var e=Jmat.Real;return e.isNegativeIntOrZero(a)==e.isNegativeIntOrZero(c)?e.gammaDiv_(a,c)*e.gammaDiv_(b,d):e.gammaDiv_(a,d)*e.gammaDiv_(b,c)};Jmat.Real.loggammaDiv_=function(a,b){var c=Jmat.Real;return a==b?0:c.isInfOrNaN(a)||c.isInfOrNaN(b)?NaN:c.isNegativeIntOrZero(b)&&(0<a||!c.isInt(a))?-Infinity:c.isInt(a)&&c.isInt(b)&&0>=a&&0>=b?c.loggammaDiv_(1-b,1-a):c.loggamma(a)-c.loggamma(b)};
Jmat.Real.loggammaDiv12_=function(a,b,c){var d=Jmat.Real;return d.isNegativeIntOrZero(b)?d.isNegativeIntOrZero(c)&&(0<a||!d.isInt(a))?Jmat.Complex(-Infinity):d.loggammaDiv_(a,b)-d.loggamma(c):d.loggammaDiv_(a,c)-d.loggamma(b)};Jmat.Real.loggammaDiv21_=function(a,b,c){var d=Jmat.Real;return d.isNegativeIntOrZero(a)?d.loggammaDiv_(a,c)+d.loggamma(b):d.loggammaDiv_(b,c)+d.loggamma(a)};
Jmat.Real.loggammaDiv2_=function(a,b,c,d){var e=Jmat.Real;return e.isNegativeIntOrZero(a)==e.isNegativeIntOrZero(c)?e.loggammaDiv_(a,c)+e.loggammaDiv_(b,d):e.loggammaDiv_(a,d)+e.loggammaDiv_(b,c)};Jmat.Complex.permutation=function(a,b){return Jmat.Complex.gammaDiv_(a.inc(),a.sub(b).inc())};
Jmat.Complex.binomial=function(a,b){if(Jmat.Complex.isPositiveIntOrZero(a)&&Jmat.Complex.isPositiveIntOrZero(b)&&b.re<=a.re&&30>a.re)return Jmat.Complex(Jmat.Real.pascal_triangle(a.re,b.re));var c=Jmat.Complex.gammaDiv12_(a.inc(),b.inc(),a.sub(b).inc());100<c.re&&Jmat.Complex.isPositiveInt(a)&&Jmat.Complex.isPositiveInt(b)&&a.re>b.re&&(c=Jmat.Complex.round(c));return c};
Jmat.Real.binomial=function(a,b){if(Jmat.Real.isPositiveIntOrZero(a)&&Jmat.Real.isPositiveIntOrZero(b)&&b<=a&&30>a)return Jmat.Real.pascal_triangle(a,b);var c=Jmat.Real.gammaDiv12_(a+1,b+1,a-b+1);100<c&&Jmat.Real.isPositiveInt(a)&&Jmat.Real.isPositiveInt(b)&&a>b&&(c=Math.round(c));return c};
Jmat.Complex.stirling2=function(a,b){if(!Jmat.Complex.isInt(b))return Jmat.Complex(NaN);var c=Jmat.Complex.ZERO,d=Jmat.Real.isOdd(b.re)?-1:1,e=Jmat.Complex(0);for(e.re=0;e.re<=b.re;e.re++)c=c.add(Jmat.Complex.binomial(b,e).mul(e.pow(a)).mulr(d)),d*=-1;return c.div(Jmat.Complex.factorial(b))};Jmat.Complex.beta=function(a,b){return 50>a.re&&-50<a.re&&50>b.re&&-50<b.re?Jmat.Complex.gammaDiv21_(a,b,a.add(b)):Jmat.Complex.exp(Jmat.Complex.loggammaDiv21_(a,b,a.add(b)))};
Jmat.Real.beta=function(a,b){return 50>a&&-50<a&&50>b&&-50<b?Jmat.Real.gammaDiv21_(a,b,a+b):Math.exp(Jmat.Real.loggammaDiv21_(a,b,a+b))};
Jmat.Complex.incbeta=function(a,b,c){if(a.eqr(1))return Jmat.Complex.beta(b,c);if(Jmat.Complex.isPositive(a)&&.75>a.re&&Jmat.Complex.isPositive(b)&&Jmat.Complex.isPositive(c)){c=Jmat.Complex.ONE.sub(c);for(var d,e,f=0;30>f;f++){0==f?(d=Jmat.Complex(1),e=Jmat.Complex(0)):(d=d.mul(c.addr(f-1)),d=d.mul(a),d=d.divr(f));if(d.eqr(0))break;e=e.add(d.div(b.addr(f)))}return a.pow(b).mul(e)}return a.pow(b).div(b).mul(Jmat.Complex.hypergeometric2F1(b,Jmat.Complex.ONE.sub(c),b.inc(),a))};
Jmat.Real.incbeta=function(a,b,c){return Jmat.Real.beta_i(a,b,c)*Jmat.Real.beta(b,c)};
Jmat.Complex.beta_i=function(a,b,c){if(Jmat.Complex.isNegativeIntOrZero(b)&&!Jmat.Complex.isNegativeIntOrZero(c))return Jmat.Complex(1);if(Jmat.Complex.isNegativeIntOrZero(c)&&!Jmat.Complex.isNegativeIntOrZero(b))return Jmat.Complex(0);if(Jmat.Complex.isNegativeIntOrZero(c.add(b))&&a.eqr(1))return Jmat.Complex(1);if(0<a.re&&1>a.re){var d=Jmat.Complex(1E-30),e=b.add(c).mul(a).div(b.inc()).neg(),f=e.inc();f.eqr(0)&&(f=d);f=f.inv();for(var g=Jmat.Complex(1),h=f,k=1;30>k&&(e=c.subr(k).mulr(k).mul(a).div(b.addr(2*
k-1).mul(b.addr(2*k))),f=e.mul(f).inc(),f.eqr(0)&&(f=d),f=f.inv(),g=e.div(g).inc(),g.eqr(0)&&(g=d),h=h.mul(g).mul(f),e=b.addr(k).mul(b.add(c).addr(k)).mul(a).div(b.addr(2*k).mul(b.addr(2*k+1))).neg(),f=e.mul(f).inc(),f.eqr(0)&&(f=d),f=f.inv(),g=e.div(g).inc(),g.eqr(0)&&(g=d),h=h.mul(g).mul(f),!Jmat.Complex.nearr(f.mul(g),1,1E-15));k++);return a.pow(b).mul(a.rsub(1).pow(c)).div(b.mul(Jmat.Complex.beta(b,c))).mul(h)}return Jmat.Complex.incbeta(a,b,c).div(Jmat.Complex.beta(b,c))};
Jmat.Real.beta_i=function(a,b,c){if(Jmat.Real.isNegativeIntOrZero(b)&&!Jmat.Real.isNegativeIntOrZero(c))return 1;if(Jmat.Real.isNegativeIntOrZero(c)&&!Jmat.Real.isNegativeIntOrZero(b))return 0;if(Jmat.Real.isNegativeIntOrZero(c+b)&&1==a)return 1;if(a>(b+1)/(b+c+2))return 1-Jmat.Real.beta_i(1-a,c,b);var d=1+-(b+c)*a/(b+1);0==d&&(d=1E-30);d=1/d;for(var e=1,f=d,g=1;30>g;g++){var h=g*(c-g)*a/((b+2*g-1)*(b+2*g));d=1+h*d;0==d&&(d=1E-30);d=1/d;e=1+h/e;0==e&&(e=1E-30);f*=e*d;h=-(b+g)*(b+c+g)*a/((b+2*g)*(b+
2*g+1));d=1+h*d;0==d&&(d=1E-30);d=1/d;e=1+h/e;0==e&&(e=1E-30);f*=e*d;if(1E-15>Math.abs(d*e-1))break}return Math.pow(a,b)*Math.pow(1-a,c)/(b*Jmat.Real.beta(b,c))*f};Jmat.Complex.beta_i_inv=function(a,b,c){return 0!=a.im||0!=b.im||0!=c.im?Jmat.Complex(NaN):Jmat.Complex(Jmat.Real.beta_i_inv(a.re,b.re,c.re))};Jmat.Real.beta_i_inv=function(a,b,c){if(0>a||1<a||0>b||0>c)return NaN;for(var d,e=0,f=1,g=0;60>g&&(d=(e+f)/2,Jmat.Real.beta_i(d,b,c)>a?f=d:e=d,!Jmat.Real.near(e,f,1E-15));g++);return d};
Jmat.Complex.bessel0big_=function(a){var b=Jmat.Complex,c=[-.0703125,.112152099609375,-.5725014209747314,.6074042001273483,-110.0171402692467,303.8090510922384,-118838.4262567832,625295.1493434797,-4.259392165047669E8,3.646840080706556E9,-3.833534661393944E12,4.854014686852901E13],d=[.0732421875,-.2271080017089844,1.727727502584457,-24.38052969955606,551.3358961220206,-18257.75547429318,832859.3040162893,-5.006958953198893E7,3.836255180230433E9,-3.649010818849833E11,4.218971570284096E13,-5827244631566907],
e=a.abs(),f=50<=e?8:35<=e?10:12;e=b.ONE;for(var g=b(-.125).div(a),h=a.inv(),k=h.mul(h),l=b.ONE,m=0;m<f;m++)l=l.mul(k),e=e.add(l.mulr(c[m])),g=g.add(l.mul(h).mulr(d[m]));c=b.sqrt(a.mulr(Math.PI/2).inv());d=a.subr(.25*Math.PI);a=c.mul(e.mul(b.cos(d)).sub(g.mul(b.sin(d))));b=c.mul(e.mul(b.sin(d)).add(g.mul(b.cos(d))));return[a,b]};
Jmat.Complex.besselj0_=function(a){var b=Jmat.Complex;if(a.eqr(0))return b(1);0>a.re&&(a=a.neg());if(12>a.abs()){var c=b.ONE;b=b.ONE;a=a.mul(a);for(var d=1;40>=d&&!(b=b.mul(a).mulr(-.25/(d*d)),c=c.add(b),b.abssq()<1E-30*c.abssq());d++);return c}return Jmat.Complex.bessel0big_(a)[0]};
Jmat.Complex.bessely0_=function(a){var b=Jmat.Complex;if(a.eqr(0))return b(-Infinity);var c=0>a.re;c&&(a=a.neg());if(12>a.abs()){var d=b.besselj0_(a);var e=0,f=b.ONE;var g=b.ZERO;for(var h=a.mul(a),k=1;40>=k;k++){e+=1/k;f=f.mulr(-.25/(k*k)).mul(h);var l=f.mulr(e);g=g.add(l);if(l.abssq()<1E-30*g.abssq())break}e=b(2/Math.PI);g=e.mul(b.log(a.divr(2)).add(b.EM)).mul(d).sub(e.mul(g))}else g=Jmat.Complex.bessel0big_(a),d=g[0],g=g[1];c&&(g=0>=a.im?g.add(b(0,2).mul(d)):g.sub(b(0,2).mul(d)));return g};
Jmat.Complex.bessel1big_=function(a){var b=Jmat.Complex,c=[.1171875,-.144195556640625,.6765925884246826,-6.883914268109947,121.5978918765359,-3302.272294480852,127641.2726461746,-6656367.718817688,4.502786003050393E8,-3.83385752074279E10,4.011838599133198E12,-5.060568503314727E14],d=[-.1025390625,.2775764465332031,-1.993531733751297,27.24882731126854,-603.8440767050702,19718.37591223663,-890297.8767070678,5.310411010968522E7,-4.043620325107754E9,3.827011346598605E11,-4.406481417852278E13,6065091351222699],
e=a.abs(),f=50<=e?8:35<=e?10:12;e=b.ONE;for(var g=b(.375).div(a),h=a.inv(),k=h.mul(h),l=b.ONE,m=0;m<f;m++)l=l.mul(k),e=e.add(l.mulr(c[m])),g=g.add(l.mul(h).mulr(d[m]));c=b.sqrt(a.mulr(Math.PI/2).inv());d=a.subr(.75*Math.PI);a=c.mul(e.mul(b.cos(d)).sub(g.mul(b.sin(d))));b=c.mul(e.mul(b.sin(d)).add(g.mul(b.cos(d))));return[a,b]};
Jmat.Complex.besselj1_=function(a){var b=Jmat.Complex;if(a.eqr(0))return b(0);var c,d=0>a.re;d&&(a=a.neg());if(12>a.abs()){b=c=b.ONE;for(var e=a.mul(a),f=1;40>=f&&!(b=b.mul(e).mulr(-.25/(f*(f+1))),c=c.add(b),b.abssq()<1E-30*c.abssq());f++);c=c.mul(a).mulr(.5)}else c=Jmat.Complex.bessel1big_(a)[0];d&&(c=c.neg());return c};
Jmat.Complex.bessely1_=function(a){var b=Jmat.Complex;if(a.eqr(0))return b(-Infinity);var c=0>a.re;c&&(a=a.neg());if(12>a.abs()){var d=b.besselj1_(a);var e=0;for(var f=b.ONE,g=b.ONE,h=a.mul(a),k=1;40>=k;k++){e+=1/k;f=f.mulr(-.25/(k*(k+1))).mul(h);var l=f.mulr(2*e+1/(k+1));g=g.add(l);if(l.abssq()<1E-30*g.abssq())break}e=b(2/Math.PI).mul(b.log(a.divr(2)).add(b.EM).mul(d).sub(a.inv()).sub(a.mul(g).mulr(.25)))}else e=Jmat.Complex.bessel1big_(a),d=e[0],e=e[1];c&&(e=0>=a.im?e.add(b(0,2).mul(d)).neg():e.sub(b(0,
2).mul(d)).neg());return e};Jmat.Complex.bessel_sqrt_=function(a){return Jmat.Complex.isNegative(a)?Jmat.Complex.sqrt(a).neg():Jmat.Complex.sqrt(a)};Jmat.Complex.bessel_sqrt2piz_=function(a){return Jmat.Complex.bessel_sqrt_(a.rdiv(2/Math.PI))};
Jmat.Complex.besselj_miller_=function(a,b){if(b.eqr(0))return Jmat.Complex(0);if(a.eqr(1))return Jmat.Complex.besselj1_(b);if(a.re<b.abs()/4){for(var c=Jmat.Complex.besselj0_(b),d=Jmat.Complex.besselj1_(b),e=1;e<a.re;e++){var f=d.mulr(2*e).div(b).sub(c);c=d;d=f}return d}c=Jmat.Complex.besselj0_(b);var g=Jmat.Complex(1),h=Jmat.Complex.ZERO;e=Math.ceil(Math.max(b.abs(),a.abs()));for(e=a.re+e;0<e;e--)f=g.mulr(2*e).div(b).sub(h),h=g,g=f,e-1==a.re&&(d=f);a=c.div(g);return d.mul(a)};
Jmat.Complex.besselj_series_=function(a,b){var c=Jmat.Complex,d=c.isNegativeInt(a);d&&(a=a.neg());for(var e=c(0),f=1,g=c.gamma(a.inc()),h=0;50>h;h++){var k=c(h+1),l=c.gamma(k).mul(g);l=c(f).div(l).mul(b.divr(2).pow(c(2*h).add(a)));f=-f;e=e.add(l);g=g.mul(a.add(k))}d&&Jmat.Real.isOdd(a.re)&&(e=e.neg());return e};
Jmat.Complex.besselj_hankelexpansion_=function(a,b){var c=Jmat.Complex,d=Math.PI,e=3<Math.abs(b.arg());e&&(b=b.neg());for(var f=Jmat.Complex.ONE,g=c.ONE,h=b.sub(a.mulr(d/2)).subr(d/4),k=c.ZERO,l=c.ZERO,m=a.mul(a).mulr(4),n=Math.max(4,Math.min(60,Math.abs(a.re))),p,q=0;q<n;q++){0<q&&(p=m.subr((2*q-1)*(2*q-1)),f=f.mul(p).divr(8*q),g=g.mul(b));p=2>q%4?1:-1;p=f.div(g).mulr(p);if(1E-28>p.abssq())break;0==q%2?l=l.add(p):k=k.add(p)}if(.01<p.abssq())return c(NaN);l=c.cos(h).mul(l);k=c.sin(h).mul(k);b=c.bessel_sqrt2piz_(b).mul(l.sub(k));
e&&(b=b.mul(c.exp(a.muli(d))));return b};Jmat.Complex.besselj_hypergeom_=function(a,b){var c=Jmat.Complex,d=1;c.isNegativeInt(a)&&(c.isOdd(a)&&(d=-1),a=a.neg());c.isNegativeInt(a.addr(.5))&&(a=5>a.abssq()?a.addr(1E-12):a.addr(1E-5));var e=c.hypergeometric1F1(a.addr(.5),a.mulr(2).inc(),b.muli(2));a=c.log(b.mulr(.5)).mul(a).sub(c.loggamma(a.inc())).add(b.muli(-1));return c.exp(a.add(c.log(e))).mulr(d)};
Jmat.Complex.besselj_large_nu_=function(a,b){var c=Jmat.Complex,d=c.bessel_sqrt2piz_(a).divr(2);b=c.E.mul(b).div(a).divr(2);return d.mul(b.pow(a))};
Jmat.Complex.besselj=function(a,b){var c=Jmat.Complex;return c.isInf(a)||c.isInf(b)?c(0):b.eqr(0)?0==a.re?0==a.im?c(1):c(NaN):0>a.re?c(Infinity,Infinity):c(0):a.eqr(0)?c.besselj0_(b):a.eqr(1)?c.besselj1_(b):a.eqr(.5)?c.bessel_sqrt2piz_(b).mul(c.sin(b)):a.eqr(-.5)?c.bessel_sqrt2piz_(b).mul(c.cos(b)):300<a.re&&Math.abs(a.im)<a.re&&2500>b.abssq()||-300>a.re&&c.isInt(a)&&2500>b.abssq()?c(0):50<a.re&&c.isReal(b)&&a.re>16*b.abs()?Jmat.Complex.besselj_large_nu_(a,b):c.isInt(a)&&50>Math.abs(a.re)?0>a.re?
c.besselj_miller_(a.neg(),b).mulr(c.isOdd(a)?-1:1):c.besselj_miller_(a,b):25>b.abs()?c.besselj_series_(a,b):b.abssq()>a.abssq()?c.besselj_hankelexpansion_(a,b):a.re>2*b.abs()?Jmat.Complex.besselj_large_nu_(a,b):c.besselj_hypergeom_(a,b)};Jmat.Complex.bessely_miller_=function(a,b){for(var c=Jmat.Complex.bessely0_(b),d=Jmat.Complex.bessely1_(b),e=1;e<a.re;e++){var f=d.mulr(2*e).div(b).sub(c);c=d;d=f}return d};
Jmat.Complex.bessely_with_besselj_=function(a,b){var c=Jmat.Complex;if(c.isInt(a.addr(.5)))return c.besselj(a.neg(),b).mulr(c.isOdd(a.addr(.5))?-1:1);var d=c.besselj(a,b),e=c.cos(a.mulr(Math.PI));c.isInt(e.addr(.5))&&(e=c(0));b=c.besselj(a.neg(),b);a=c.sin(a.mulr(Math.PI));return d.mul(e).sub(b).div(a)};
Jmat.Complex.bessely_hankelexpansion_=function(a,b){var c=Jmat.Complex,d=Math.PI,e=3<Math.abs(b.arg());e&&(b=b.neg());for(var f=Jmat.Complex.ONE,g=c.ONE,h=b.sub(a.mulr(d/2)).subr(d/4),k=c.ZERO,l=c.ZERO,m=a.mul(a).mulr(4),n=Math.max(4,Math.min(60,Math.abs(a.re))),p,q=0;q<n;q++){0<q&&(p=m.subr((2*q-1)*(2*q-1)),f=f.mul(p).divr(8*q),g=g.mul(b));p=2>q%4?1:-1;p=f.div(g).mulr(p);if(1E-28>p.abssq())break;0==q%2?l=l.add(p):k=k.add(p)}if(.01<p.abssq())return c(NaN);l=c.sin(h).mul(l);k=c.cos(h).mul(k);f=c.bessel_sqrt2piz_(b).mul(l.add(k));
e&&(b=c.besselj(a,b),f=f.mul(c.exp(a.muli(-d))).add(c.cos(a.mulr(d)).mul(b).muli(2)));return f};
Jmat.Complex.bessely=function(a,b){var c=Jmat.Complex;if(c.isInf(a))return c.isInf(b)?c(NaN):c.isPositive(b)?c(-Infinity):c(Infinity,Infinity);if(c.isInf(b))return c(0);if(b.eqr(0))return 0==a.re?0==a.im?c(-Infinity):c(NaN):c(Infinity,Infinity);if(a.eqr(0))return c.bessely0_(b);if(a.eqr(1))return c.bessely1_(b);if(c.isInt(a)){var d=0>b.re;d&&(b=b.neg());var e=0>a.re?c.bessely_miller_(a.neg(),b).mulr(c.isOdd(a)?-1:1):c.bessely_miller_(a,b);d&&(d=c.besselj(a,b),e=0>=b.im?e.add(c(0,2).mul(d)):e.sub(c(0,
2).mul(d)),c.isOdd(a)&&(e=e.neg()));return e}return 20>b.abs()?c.bessely_with_besselj_(a,b):b.abssq()>a.abssq()?c.bessely_hankelexpansion_(a,b):c(NaN)};Jmat.Complex.hankelh1=function(a,b){var c=Jmat.Complex;return c.isInf(a)?c(Infinity,Infinity):c.isInf(b)?c(0):b.eqr(0)?0==a.re&&0!=a.im?c(NaN):c(Infinity,Infinity):0>a.im?c.exp(a.mul(c.newi(-Math.PI))).mul(c.hankelh1(a.neg(),b)):c.besselj(a,b).add(c.bessely(a,b).mul(c.I))};
Jmat.Complex.hankelh2=function(a,b){var c=Jmat.Complex;return c.isInf(a)?c(Infinity,Infinity):c.isInf(b)?c(0):b.eqr(0)?0==a.re&&0!=a.im?c(NaN):c(Infinity,Infinity):0<a.im?c.exp(a.mul(c.newi(Math.PI))).mul(c.hankelh2(a.neg(),b)):c.besselj(a,b).sub(c.bessely(a,b).mul(c.I))};
Jmat.Complex.besseli=function(a,b){var c=Jmat.Complex;if(c.isInf(a))return c.isInf(b)?c(NaN):c(0);if(b.eqr(Infinity))return c(Infinity);if(c.isInf(b))return c(Infinity,Infinity);if(b.eqr(0))return 0==a.re?0==a.im?c(1):c(NaN):0>a.re?c(Infinity,Infinity):c(0);c=c.I.pow(a.neg()).mul(c.besselj(a,b.mul(c.I)));0==b.im&&0==a.im&&Jmat.Real.near(c.im,0,1E-10)&&(c.im=0);return c};
Jmat.Complex.besselk=function(a,b){var c=Jmat.Complex;if(c.isInf(a))return c.isInf(b)?c(NaN):c.isPositive(b)?c(Infinity):c(Infinity,Infinity);if(b.eqr(Infinity))return c(0);if(c.isInf(a))return c(Infinity,Infinity);if(b.eqr(0))return 0==a.re?0==a.im?c(Infinity):c(NaN):c(Infinity,Infinity);c=0<=b.im?c.I.pow(a.inc()).mulr(Math.PI/2).mul(c.hankelh1(a,c.I.mul(b))):c.newi(-1).pow(a.inc()).mulr(Math.PI/2).mul(c.hankelh2(a,c.newi(-1).mul(b)));0==b.im&&0==a.im&&Jmat.Real.near(c.im,0,.001)&&(c.im=0);return c};
Jmat.Complex.spherical_besselj=function(a,b){var c=Jmat.Complex,d=c.sqrt(c(Math.PI/2).div(b));a=c.besselj(a.addr(.5),b);return d.mul(a)};Jmat.Complex.spherical_bessely=function(a,b){var c=Jmat.Complex,d=c.sqrt(c(Math.PI/2).div(b));a=c.bessely(a.addr(.5),b);return d.mul(a)};Jmat.Complex.spherical_hankelh1=function(a,b){var c=Jmat.Complex,d=c.sqrt(c(Math.PI/2).div(b));a=c.hankelh1(a.addr(.5),b);return d.mul(a)};
Jmat.Complex.spherical_hankelh2=function(a,b){var c=Jmat.Complex,d=c.sqrt(c(Math.PI/2).div(b));a=c.hankelh2(a.addr(.5),b);return d.mul(a)};
Jmat.Complex.struveh=function(a,b){var c=Jmat.Complex;if(30<c.abs(b)&&50>c.abs(b)){var d=b.divr(2).pow(a.addr(1));a=c.regularized_hypergeometric([c(1)],[c(1.5),a.addr(1.5)],b.mul(b).divr(-4));return d.mul(a)}if(30<c.abs(b)){d=c(.5);for(var e=c.gamma(d),f=a.addr(.5),g=c.gamma(f),h=c(1),k=b.mul(b).divr(4),l=c=c(0),m=0;30>m;m++){c=c.add(e.div(g).div(h));if(c.eq(l))break;l=c;e=e.mul(d);d=d.addr(1);f=f.subr(1);g=g.div(f);h=h.mul(k)}d=b.mulr(.5).pow(a.subr(1)).divr(Math.PI);return d.mul(c)}d=c(1.5);e=c.gamma(d);
f=c(a.addr(1.5));g=c.gamma(f);var n=c(1);h=c(1);k=b.mul(b).divr(4);l=c=c(0);for(m=0;100>m;m++){c=c.add(n.mul(h).div(e).div(g));if(c.eq(l))break;l=c;e=e.mul(d);g=g.mul(f);d=d.addr(1);f=f.addr(1);n=n.neg();h=h.mul(k)}d=b.mulr(.5).pow(a.addr(1));return d.mul(c)};Jmat.Complex.struvek=function(a,b){var c=Jmat.Complex;return c.struveh(a,b).sub(c.bessely(a,b))};Jmat.Complex.struvel=function(a,b){var c=Jmat.Complex;return c.exp(a.muli(.5*-Math.PI)).muli(-1).mul(c.struveh(a,b.muli(1)))};
Jmat.Complex.struvem=function(a,b){var c=Jmat.Complex;return c.struvel(a,b).sub(c.besseli(a,b))};Jmat.Complex.angerj=function(a,b){var c=Jmat.Complex;return c.integrate(c(0),c(Math.PI),function(d){return c.cos(a.mul(d).sub(b.mul(c.sin(d))))}).divr(Math.PI)};Jmat.Complex.webere=function(a,b){var c=Jmat.Complex;return c.integrate(c(0),c(Math.PI),function(d){return c.sin(a.mul(d).sub(b.mul(c.sin(d))))}).divr(Math.PI)};
Jmat.Complex.airyloop_=function(a,b,c,d){for(var e=1.3541179394264005,f=.8929795115692493,g=a.mul(a).mul(a),h=Jmat.Complex.ONE,k=1,l=Jmat.Complex.ZERO,m=0;30>m;m++){0<m&&(k*=m,e*=m+2/3-1,f*=m+4/3-1,b/=9,c/=9,h=h.mul(g),a=a.mul(g));var n=h.mulr(b/k/e),p=a.mulr(c/k/f);if(Jmat.Complex.isNaN(n)||Jmat.Complex.isNaN(p))break;if(n.eqr(0)&&p.eqr(0))break;l=l.add(n).add(p.mulr(d))}return l};
Jmat.Complex.airy=function(a){if(8<a.abs()){if(Math.abs(a.arg())<2*Math.PI/3){var b=a.powr(.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.exp(a.neg()).div(b.mulr(2))}a=a.neg();b=a.powr(.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.sin(a.addr(Math.PI/4)).div(b)}return Jmat.Complex.airyloop_(a,Math.pow(3,-2/3),Math.pow(3,-4/3),-1)};
Jmat.Complex.bairy=function(a){if(10<a.abs()){if(Math.abs(a.arg())<Math.PI/3){var b=a.powr(.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.exp(a).div(b)}a=a.neg();b=a.powr(.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.cos(a.addr(Math.PI/4)).div(b)}return Jmat.Complex.airyloop_(a,Math.pow(3,-1/6),Math.pow(3,-5/6),1)};
Jmat.Complex.airy_deriv_loop_=function(a,b,c,d){var e=2.6789385347077475,f=.9027452929509336,g=a.mul(a).mul(a),h=Jmat.Complex.ONE;a=a.mul(a);for(var k=1,l=Jmat.Complex.ZERO,m=0;30>m;m++){0<m&&(k*=m,e*=m+1/3-1,f*=m+5/3-1,b/=9,c/=9,h=h.mul(g),a=a.mul(g));var n=h.mulr(b/k/e),p=a.mulr(c/k/f);if(Jmat.Complex.isNaN(n)||Jmat.Complex.isNaN(p))break;if(n.eqr(0)&&p.eqr(0))break;l=l.add(n.mulr(d)).add(p)}return l};
Jmat.Complex.airy_deriv=function(a){if(8<a.abs()){if(Math.abs(a.arg())<2*Math.PI/3){var b=a.powr(-.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.exp(a.neg()).div(b.mulr(2)).neg()}a=a.neg();b=a.powr(-.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.cos(a.addr(Math.PI/4)).div(b).neg()}return Jmat.Complex.airy_deriv_loop_(a,Math.pow(3,-1/3),Math.pow(3,-5/3),-1)};
Jmat.Complex.bairy_deriv=function(a){if(10<a.abs()){if(Math.abs(a.arg())<Math.PI/3){var b=a.powr(-.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.exp(a).div(b)}a=a.neg();b=a.powr(-.25).mul(Jmat.Complex.SQRTPI);a=a.powr(1.5).mulr(2/3);return Jmat.Complex.sin(a.addr(Math.PI/4)).div(b)}return Jmat.Complex.airy_deriv_loop_(a,Math.pow(3,1/6),Math.pow(3,-7/6),1)};
Jmat.Complex.zetaint_=function(a){for(var b=function(a,b){var c=Jmat.Complex.sin(a.mul(Jmat.Complex.atan(b)));a=b.mul(b).inc().pow(a.divr(2));b=Jmat.Complex.exp(b.mulr(2*Math.PI)).dec();b=a.mul(b);return c.eq(b)?Jmat.Complex.ONE:c.div(b)},c=Jmat.Complex.ONE;;){var d=b(a,c);if(1E-4>d.abssq()&&1E-4>d.abssq())break;if(1E3<c.re)break;c=c.mulr(2)}c=c.re;d=.01;for(var e=Jmat.Complex.ZERO,f=0;f<c;f+=d){var g=b(a,Jmat.Complex(f)).mulr(d);e=e.add(g);d*=1.01}return e.mulr(2).addr(.5).add(a.dec().inv())};
Jmat.Complex.zeta=function(a){if(a.eq(Jmat.Complex.ZERO))return Jmat.Complex(-.5);if(a.eqr(-1))return Jmat.Complex(-1/12);if(a.eqr(1))return Jmat.Complex(Infinity);if(a.eqr(3))return Jmat.Complex(1.202056903159594);if(Infinity==a.re)return Jmat.Complex(1);if(Jmat.Complex.isEven(a)&&0>a.re)return Jmat.Complex(0);var b=a.dec().abs();if(10>b){var c=a.dec(),d=c.inv();a=Jmat.Complex.ONE;var e=5>b?10:30;for(b=0;b<e;b++)d=d.add(Jmat.Complex(Jmat.Complex.stieltjes_zeta[b]).mul(a)),a=a.mul(c);return d}if(5<=
a.re){d=Jmat.Complex(0);for(b=1;32>b;b++)d=d.add(Jmat.Complex(b).pow(a).inv());return d}if(.5<=a.re){if(Jmat.Complex.near(a,Jmat.Complex(1,18.125),.1))return Jmat.Complex.zetaint_(a);d=Jmat.Complex(0);c=Jmat.Complex.TWO.pow(Jmat.Complex.ONE.sub(a));c=Jmat.Complex.ONE.div(Jmat.Complex.ONE.sub(c));for(b=e=1;128>b;b++){var f=Jmat.Complex(e).div(Jmat.Complex(b).pow(a));d=d.add(f);e=-e}return d.mul(c)}b=Jmat.Complex.ONE.sub(a);c=Jmat.Complex.TWO.pow(a);d=Jmat.Complex.PI.pow(a.subr(1));a=Jmat.Complex.sin(a.mulr(Math.PI/
2));e=Jmat.Complex.gamma(b);b=Jmat.Complex.zeta(b);return c.mul(d).mul(a).mul(e).mul(b)};
Jmat.Complex.eta=function(a){if(.5>a.re){a=a.neg();var b=Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(a.neg().subr(1))),c=Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(a.neg()));b=b.div(c).mulr(2).mul(Jmat.Complex.PI.pow(a.neg().subr(1)));var d=Jmat.Complex.sin(Jmat.Complex.PI.mul(a).divr(2));c=Jmat.Complex.gamma(a);var e=Jmat.Complex.eta(a.inc());return b.mul(a).mul(d).mul(c).mul(e)}d=function(a,b){for(var c=0,d=0;d<=a;d++){var e=Jmat.Real.factorial(b+d-1)/Jmat.Real.factorial(b-d),f=Math.pow(4,d)/Jmat.Real.factorial(2*
d);c+=e*f}return c*b};e=d(50,50);for(var f=Jmat.Complex(0),g=Jmat.Complex(1),h=0;50>h;h++)b=g.mulr(d(h,50)-e),c=Jmat.Complex(h+1).pow(a),f=f.add(b.div(c)),g=g.neg();return f.mulr(-1/e)};Jmat.Complex.lambda=function(a){return Jmat.Complex.ONE.sub(Jmat.Complex.TWO.pow(a.neg())).mul(Jmat.Complex.zeta(a))};Jmat.Complex.hurwitzzeta_generate_hasse_table_=function(a){for(var b=[],c=0;c<a;c++){b[c]=0;for(var d=1,e=0;e<=c;e++)b[e]+=d*Jmat.Real.pascal_triangle(c,e)/(c+1),d=-d}return b};
Jmat.Complex.hurwitzzeta_hasse_tables_=[];Jmat.Complex.hurwitzzeta_hasse_series_=function(a,b){Jmat.Complex.hurwitzzeta_hasse_tables_[30]||(Jmat.Complex.hurwitzzeta_hasse_tables_[30]=Jmat.Complex.hurwitzzeta_generate_hasse_table_(30));for(var c=Jmat.Complex.hurwitzzeta_hasse_tables_[30],d=Jmat.Complex.ZERO,e=0;30>e;e++)d=d.add(b.addr(e).pow(Jmat.Complex.ONE.sub(a)).mulr(c[e]));return d=d.mul(a.dec().inv())};
Jmat.Complex.hurwitzzeta_cos_series_=function(a,b){a=a.rsub(1);for(var c=Jmat.Complex.gamma(a).mulr(2).div(Jmat.Complex(2*Math.PI).pow(a)),d=Jmat.Complex.ZERO,e=1;30>e;e++){var f=Jmat.Complex.cos(a.mulr(Math.PI/2).sub(b.mulr(2*Math.PI*e)));d=d.add(f.div(Jmat.Complex(e).pow(a)))}return d.mul(c)};Jmat.Complex.hurwitzzeta_simple_series_=function(a,b){if(Jmat.Complex.isNegativeIntOrZero(b))return Jmat.Complex(Infinity);for(var c=Jmat.Complex.ZERO,d=0;30>d;d++){var e=b.addr(d).pow(a).inv();c=c.add(e)}return c};
Jmat.Complex.hurwitzzeta_euler_=function(a,b){for(var c=b.addr(25).pow(a).inv(),d=a.dec().inv().mul(b.addr(25).pow(a.dec()).inv()),e=Jmat.Complex.ZERO,f=0;25>f;f++){var g=b.addr(f).pow(a).inv();e=e.add(g)}g=a;var h=1,k=Jmat.Complex.ZERO;for(f=1;15>=f;f++){h*=2*(2*f-1)*f;g=g.mul(a.addr(2*f-1)).mul(a.addr(2*f));var l=g.div(b.addr(25).pow(a.addr(2*f+1))).neg();k=k.add(l.mulr(Jmat.Complex.bernoulli[2*f]/h))}return e.sub(k).add(c.divr(2)).add(d)};
Jmat.Complex.hurwitzzeta=function(a,b){if(a.eqr(0))return Jmat.Complex(.5).sub(b);if(a.eqr(-1))return Jmat.Complex(-1/12).add(b.mulr(.5)).add(b.mul(b).mulr(-.5));if(b.eqr(1))return Jmat.Complex.zeta(a);if(2<a.re&&0<b.re)return Jmat.Complex.hurwitzzeta_simple_series_(a,b);if(0<=a.re&&-10<b.re)return Jmat.Complex.hurwitzzeta_euler_(a,b);if(0>a.re&&0==b.im&&0<b.re&&1>=b.re)return Jmat.Complex.hurwitzzeta_cos_series_(a,b);if(2<b.re)return Jmat.Complex.hurwitzzeta_hasse_series_(a,b);if(-40<b.re&&!b.eqr(0)){var c=
0>a.re&&0==b.im?Math.ceil(-b.re):Math.ceil(2-b.re+.5),d=Jmat.Complex.ZERO;if(0<c)for(var e=0;e<c;e++){var f=b.addr(e).pow(a).inv();Jmat.Complex.isNaN(f)||(d=d.add(f))}else for(e=0;e<-c;e++)f=b.addr(e).addr(c).pow(a).inv(),Jmat.Complex.isNaN(f)||(d=d.add(f));a=Jmat.Complex.hurwitzzeta(a,b.addr(c));return 0<c?a.add(d):a.sub(d)}return Jmat.Complex(NaN)};Jmat.Complex.lerchphi_pow_=function(a,b,c){return c?a.mul(a).pow(b.divr(2)):a.pow(b)};
Jmat.Complex.lerchphi_generate_binomial_table_=function(a,b,c,d){for(var e=Jmat.Complex,f=[],g=0;g<c;g++){f[g]=e(0);for(var h=1,k=0;k<=g;k++){var l=e.lerchphi_pow_(b.addr(k),a,d);f[g]=f[g].add(l.inv().mulr(h*Jmat.Real.pascal_triangle(g,k)));h=-h}}return f};Jmat.Complex.lerchphi_binomial_table_a_=void 0;Jmat.Complex.lerchphi_binomial_table_s_=void 0;Jmat.Complex.lerchphi_binomial_table_var_=void 0;Jmat.Complex.lerchphi_binomial_table_=void 0;
Jmat.Complex.lerchphi_binomial_series_=function(a,b,c,d){var e=Jmat.Complex;e.lerchphi_binomial_table_&&e.lerchphi_binomial_table_a_.eq(c)&&e.lerchphi_binomial_table_s_.eq(b)&&e.lerchphi_binomial_table_var_==!!d||(e.lerchphi_binomial_table_=e.lerchphi_generate_binomial_table_(b,c,30),e.lerchphi_binomial_table_a_=c,e.lerchphi_binomial_table_s_=b,e.lerchphi_binomial_table_var_=!!d);b=a.neg().div(a.rsub(1));c=e.lerchphi_binomial_table_;d=e.ZERO;for(var f=e(1),g=0;30>g;g++){var h=d.add(f.mul(c[g]));if(e.near(h,
d,1E-15))break;d=h;f=f.mul(b)}return d=d.mul(a.rsub(1).inv())};Jmat.Complex.lerchphi_series_=function(a,b,c,d){for(var e=Jmat.Complex,f=e(0),g=e(1),h=0;30>h;h++){var k=e.lerchphi_pow_(c.addr(h),b,d);k=g.div(k);if(e.near(f.add(k),f,1E-15))break;f=f.add(k);g=g.mul(a)}return f};
Jmat.Complex.lerchphi_integral_=function(a,b,c,d){var e=Jmat.Complex;if(1>c.re){if(e.isNegativeIntOrZero(c))return e(Infinity,Infinity);var f=Math.ceil(1-c.re);if(1E3<f)return e(NaN);for(var g=e(0),h=e(1),k=0;k<f;k++)g=g.add(h.div(e.lerchphi_pow_(c.addr(k),b))),h=h.mul(a);return h.mul(e.lerchphi(a,b,c.addr(f),d)).add(g)}a.eqr(1)&&(a=e(1.0000000000001));var l=e.log(a);d=c.pow(b).mulr(2).inv();f=e.incgamma_upper(b.rsub(1),c.mul(l).neg());d=d.add(f.mul(l.neg().pow(b.subr(1))).div(a.pow(c)));a=e.integrate(e(0),
e(Infinity),function(a){var d=e.sin(e.atan(a.div(c)).mul(b).sub(a.mul(l))),f=c.mul(c).add(a.mul(a)).pow(b.divr(2));a=e.expm1(a.mulr(2*Math.PI));return d.div(f).div(a)},30,1).mulr(2);return d=d.add(a)};Jmat.Complex.lerchphi=function(a,b,c,d){var e=Jmat.Complex;return.75>a.abs()?Jmat.Complex.lerchphi_series_(a,b,c,d):e.lerchphi_integral_(a,b,c,d)};Jmat.Complex.PIPI6_=Jmat.Complex(Math.PI*Math.PI/6);
Jmat.Complex.dilog=function(a){if(a.eqr(0))return Jmat.Complex.ZERO;if(a.eqr(1))return Jmat.Complex.PIPI6_;if(a.eqr(Infinity)||a.eqr(-Infinity))return Jmat.Complex(-Infinity);var b=function(a){for(var b=Jmat.Complex.ZERO,d=a,e=.5>=c?30:50,f=1;f<e;f++){var g=d.divr(f*f);b=b.add(g);if(Jmat.Complex.near(g,Jmat.Complex.ZERO,1E-15))break;d=d.mul(a)}return b},c=a.abs();if(.5>c)return b(a);if(.5>1/c)return b=b(a.inv()).neg(),a=Jmat.Complex.log(a.neg()),b.sub(a.mul(a).divr(2)).sub(Jmat.Complex.PIPI6_);var d=
Jmat.Complex.ONE.sub(a),e=d.abs(),f=Jmat.Complex.ONE.sub(a).inv(),g=f.abs(),h=a.div(a.dec()),k=h.abs(),l=c,m=0;1/c<l&&(l=1/c,m=1);e<l&&(l=e,m=2);g<l&&(l=g,m=3);k<l&&(l=k,m=4);if(.8>l){if(0==m)return b(a);if(1==m)return b=b(a.inv()).neg(),a=Jmat.Complex.log(a.neg()),b.sub(a.mul(a).divr(2)).sub(Jmat.Complex.PIPI6_);if(2==m)return b=b(d).neg(),d=Jmat.Complex.log(d),a=Jmat.Complex.log(a),b.sub(d.mul(a)).add(Jmat.Complex.PIPI6_);if(3==m)return b=b(f),d=Jmat.Complex.log(Jmat.Complex.ONE.sub(a)),a=Jmat.Complex.log(a.neg()),
b.add(d.mul(d).divr(2)).sub(a.mul(d)).sub(Jmat.Complex.PIPI6_);if(4==m)return b=b(h).neg(),a=Jmat.Complex.log(Jmat.Complex.ONE.sub(a)),b.sub(a.mul(a).divr(2))}return Jmat.Complex.dilog(a.mul(a)).divr(2).sub(Jmat.Complex.dilog(a.neg()))};
Jmat.Complex.trilog=function(a){if(a.eqr(0))return Jmat.Complex.ZERO;if(a.eqr(1))return Jmat.Complex.APERY;if(a.eqr(Infinity)||a.eqr(-Infinity))return Jmat.Complex(-Infinity);var b=function(a){for(var b=Jmat.Complex.ZERO,d=a,g=.5>c?30:50,h=1;h<g;h++){var k=d.divr(h*h*h);b=b.add(k);if(Jmat.Complex.near(k,Jmat.Complex.ZERO,1E-15))break;d=d.mul(a)}return b},c=a.abs();return.75>c?b(a):.75>1/c?(b=b(a.inv()),a=Jmat.Complex.log(a.neg()),b.sub(a.mul(a).mul(a).divr(6)).sub(Jmat.Complex.PIPI6_.mul(a))):Jmat.Complex.polylog_integral_(Jmat.Complex(3),
a)};Jmat.Real.bernoulli=[1,-.5,1/6,0,-1/30,0,1/42,0,-1/30,0,5/66,0,-691/2730,0,7/6,0,-3617/510,0,43867/798,0,-174611/330,0,854513/138,0,-8699436.274358975,0,1.4359735460008333E12,0,-8.861288553122988E9,0,1.799809983498813E8,0];Jmat.Complex.bernoulli=Jmat.Real.bernoulli;
Jmat.Real.stieltjes=[.5772156649015329,-.07281584548367673,-.00969036319287232,.002053834420303346,.0023253700654673,7.933238173010627E-4,-2.387693454301996E-4,-5.27289567057751E-4,-3.521233538030395E-4,-3.439477441808805E-5,2.053328149090648E-4,2.701844395439035E-4,1.672729121051402E-4,-2.7463806603760158E-5,-2.0920926205929996E-4,-2.834686553202414E-4,-1.9969685830896976E-4,2.6277037109918338E-5,3.073684081492528E-4,5.036054530473557E-4,4.6634356151155945E-4,1.0443776975600011E-4,-5.415995822039977E-4,
-.0012439620904082457,-.0015885112789035616,-.0010745919527384888,6.568035186371545E-4,.0034778369136185382,.00640006853170063,.007371151770472239,.003557728855573161,-.007513325997815229];Jmat.Complex.stieltjes=Jmat.Real.stieltjes;
Jmat.Real.stieltjes_zeta=[.5772156649015329,.07281584548367673,-.00484518159643616,-3.4230573671722433E-4,9.689041939447084E-5,-6.6110318108421895E-6,-3.316240908752772E-7,1.0462094584479188E-7,-8.733218100273798E-9,9.47827778276236E-11,5.658421927608708E-11,-6.768689863513697E-12,3.4921159366720317E-13,4.4104247417577536E-15,-2.3997862217709992E-15,2.1677312200726828E-16,-9.544466076366965E-18,-7.387676660538637E-20,4.800850782488065E-20,-4.139956737713306E-21,1.9168201593991233E-22,-2.0441543122262165E-24,
-4.818498501107353E-25,4.8118570515125666E-26,-2.560263310318815E-27,6.927840895304667E-29,1.6286075504855866E-30,-3.1939375611532554E-31,2.0991515893634255E-32,-8.33674529544144E-34,1.3412593772192187E-35,9.137143891298173E-37];Jmat.Complex.stieltjes_zeta=Jmat.Real.stieltjes_zeta;
Jmat.Complex.polylog_integral_=function(a,b){var c=Jmat.Complex;if(1<a.re&&Math.abs(a.im)<a.re&&.1<Math.abs(b.arg())){var d=c.gamma(a),e=function(d){d=d.pow(a.dec()).div(c.exp(d).sub(b));c.isNaN(d)&&(d=c.ZERO);return d};e=c.integrate(c(0),c(Infinity),e,50);return b.div(d).mul(e)}if(c.isNegative(a)&&.1<Math.abs(b.arg())){var f=c.log(b.neg());e=function(b){var d=b.pow(a.neg()),e=c.sin(a.mulr(Math.PI/2).sub(b.mul(f)));b=c.sinh(b.mulr(Math.PI));d=d.mul(e).div(b);c.isNaN(d)&&(d=c.ZERO);return d};return e=
c.integrate(c(0),c(Infinity),e,30)}if(0>=b.im||0<a.re&&Math.abs(a.im)<a.re)return f=c.log(b.neg()),e=function(b){var d=c.sin(a.mul(c.atan(b)).sub(b.mul(f))),e=c.ONE.add(b.mul(b)).pow(a.divr(2));b=c.sinh(b.mulr(Math.PI));d=d.div(e).div(b);c.isNaN(d)&&(d=c.ZERO);return d},e=c.integrate(c(0),c(10),e,30),b.mulr(.5).add(b.mul(e));if(0<b.im){var g=c.log(b);e=function(b){var d=c.sin(a.mul(c.atan(b)).sub(b.mul(g))),e=c.ONE.add(b.mul(b)).pow(a.divr(2));b=c.exp(b.mulr(2*Math.PI)).subr(1);d=d.div(e).div(b);
c.isNaN(d)&&(d=c.ZERO);return d};e=c.integrate(c(0),c(Infinity),e,30);d=c.incgamma_upper(c.ONE.sub(a),g.neg());var h=g.neg().pow(c.ONE.sub(a));return b.mulr(.5).add(d.div(h)).add(b.mulr(2).mul(e))}return c(NaN)};
Jmat.Complex.polylog_borwein_=function(a,b){var c=b.mul(b).div(b.dec()).abs();if(3.7<=c)return Jmat.Complex(NaN);c=Math.floor(Math.min(31,16/c));for(var d=[],e=d[0]=Jmat.Complex.ONE,f=Jmat.Complex.ONE,g=Jmat.Complex.ZERO,h=1;h<=c;h++){f=f.mul(b);var k=f.div(Jmat.Complex(h).pow(a));g=g.add(k);var l=Jmat.Complex.binomial(Jmat.Complex(c),Jmat.Complex(h)).mul(f);h%2&&(l=l.neg());e=e.add(l);d[h]=e}l=Jmat.Complex.ZERO;for(h=c+1;h<=2*c;h++)f=f.mul(b),k=f.div(Jmat.Complex(h).pow(a)),e=d[2*c-h],k=k.mul(e),
l=l.add(k);a=b.dec().inv().powr(c);l=l.mul(a);return c%2?g.sub(l):g.add(l)};Jmat.Complex.polylog_borwein_ok_=function(a,b){var c=b.mul(b).div(b.dec()).abs();return-5<=a.re&&0==b.im&&1.5>=c||0<=a.re&&Math.abs(a.im)<a.re&&2>=c||.5>=b.abs()};
Jmat.Complex.polylog_residue_=function(a,b){var c=!1,d=b;0==a.im&&0==b.im&&(b=b.add(Jmat.Complex.newi(-1E-4)),Jmat.Complex.isNegativeInt(a)||0>b.re)&&(c=!0);b=Jmat.Complex.log(b);for(var e=Jmat.Complex.gamma(Jmat.Complex.ONE.sub(a)),f=Jmat.Complex.ZERO,g=0;30>g;g++)f=0<d.im?f.add(Jmat.Complex.newi(2*g*Math.PI).sub(b).pow(a.dec())):f.add(Jmat.Complex.newi(-2*g*Math.PI).sub(b).pow(a.dec()));a=e.mul(f);c&&0!=a.im&&(a=Jmat.Complex(a.re));return a};
Jmat.Complex.polylog=function(a,b){if(Jmat.Complex.isInt(a)){if(a.eqr(0))return b.div(Jmat.Complex.ONE.sub(b));if(a.eqr(1))return Jmat.Complex.log(Jmat.Complex.ONE.sub(b)).neg();if(a.eqr(2))return Jmat.Complex.dilog(b);if(a.eqr(3))return Jmat.Complex.trilog(b);if(a.eqr(-1))return a=Jmat.Complex.ONE.sub(b),b.div(a).div(a);if(a.eqr(-2))return a=Jmat.Complex.ONE.sub(b),b.mul(b.inc()).div(a).div(a).div(a);if(a.eqr(-3)){a=Jmat.Complex.ONE.sub(b);var c=a.mul(a);return b.mul(Jmat.Complex.ONE.add(b.mulr(4)).add(b.mul(b))).div(c).div(c)}if(a.eqr(-4))return a=
Jmat.Complex.ONE.sub(b),c=a.mul(a),b.mul(b.inc()).mul(Jmat.Complex.ONE.add(b.mulr(10)).add(b.mul(b))).div(c).div(c).div(a)}if(1<a.re&&b.eqr(0))return Jmat.Complex(0);if(1<a.re&&b.eqr(1))return Jmat.Complex.zeta(a);var d=b.abs();if(.5>=d&&-10<=a.re||.75>d&&-2<=a.re||.9>d&&-1<a.re){c=Jmat.Complex.ZERO;var e=b;d=.5>=d?30:50;for(var f=1;f<d;f++){var g=e.div(Jmat.Complex(f).pow(a));c=c.add(g);if(Jmat.Complex.near(g,Jmat.Complex.ZERO,1E-15))break;e=e.mul(b)}return c}return Jmat.Complex.polylog_borwein_ok_(a,
b)?Jmat.Complex.polylog_borwein_(a,b):0>a.re?Jmat.Complex.polylog_residue_(a,b):Jmat.Complex.isNegativeInt(a)&&1<d?(c=Jmat.Complex.isOdd(a)?1:-1,Jmat.Complex.polylog(a,b.inv()).mulr(c)):Jmat.Complex.polylog_integral_(a,b)};Jmat.Complex.theta1=function(a,b){if(1<a.im)return Jmat.Complex.theta1(a.neg(),b).neg();for(var c=Jmat.Complex(0),d=Jmat.Complex(1),e=0;20>e;e++){var f=b.powr((e+.5)*(e+.5)),g=Jmat.Complex.sin(a.mulr(2*e+1));c=c.add(d.mul(f).mul(g));d=d.neg()}return c.mulr(2)};
Jmat.Complex.theta2=function(a,b){if(1<a.im)return Jmat.Complex.theta2(a.neg(),b);for(var c=Jmat.Complex(0),d=0;20>d;d++){var e=b.powr((d+.5)*(d+.5)),f=Jmat.Complex.cos(a.mulr(2*d+1));c=c.add(e.mul(f))}return c.mulr(2)};Jmat.Complex.theta3=function(a,b){if(1<a.im)return Jmat.Complex.theta3(a.neg(),b);for(var c=Jmat.Complex(0),d=0;20>d;d++){var e=b.powr(d*d),f=Jmat.Complex.cos(a.mulr(2*d));c=c.add(e.mul(f))}return c.mulr(2).addr(1)};
Jmat.Complex.theta4=function(a,b){if(1<a.im)return Jmat.Complex.theta4(a.neg(),b);for(var c=Jmat.Complex(0),d=Jmat.Complex(1),e=0;20>e;e++){var f=b.powr(e*e),g=Jmat.Complex.cos(a.mulr(2*e));c=c.add(d.mul(f).mul(g));d=d.neg()}return c.mulr(2).addr(1)};Jmat.Complex.mulSqrtBranch_=function(a,b){return Jmat.Complex.isPositive(a)&&Jmat.Complex.isPositive(b)?Jmat.Complex.sqrt(a.mul(b)):Jmat.Complex.sqrt(a).mul(Jmat.Complex.sqrt(b))};
Jmat.Complex.ellipticrf=function(a,b,c){for(var d=Jmat.Complex,e=0,f,g,h,k;;){k=a.add(b).add(c).divr(3);if(d.nearr(k,0,1E-14))return d(0);f=a.div(k).rsub(1);g=b.div(k).rsub(1);h=c.div(k).rsub(1);if(.0025>Math.max(Math.max(f.abs(),g.abs()),h.abs()))break;var l=d.sqrt(a),m=d.sqrt(b),n=d.sqrt(c);l=l.mul(m).add(m.mul(n)).add(n.mul(l));a=a.add(l).divr(4);b=b.add(l).divr(4);c=c.add(l).divr(4);e++;if(1E3<e)break}a=f.mul(g).sub(h.mul(h));f=f.mul(g).mul(h);d=d(1).sub(a.divr(10)).add(f.divr(14)).add(a.mul(a).divr(24)).sub(a.mul(f).mulr(3/
44));return k.powr(-.5).mul(d)};
Jmat.Complex.ellipticrc=function(a,b){var c=Jmat.Complex;if(0<b.re)var d=c(1);else{var e=a.sub(b);d=c.sqrt(a).div(c.sqrt(e));a=e;b=b.neg()}for(var f=0,g;;){e=a.add(b).add(b).divr(3);g=b.div(e).subr(1);if(.0012>g.abs())break;var h=c.sqrt(a).mul(c.sqrt(b)).mulr(2).add(b);a=a.add(h).divr(4);b=b.add(h).divr(4);f++;if(1E3<f)break}a=g.mul(g);b=a.mul(a);f=b.mul(a);c=c(1).add(a.mulr(.3)).add(a.mul(g).divr(7)).add(b.mulr(.375)).add(b.mul(g).mulr(9/22)).add(f.mulr(159/208)).add(f.mul(g).mulr(1.125));return e.powr(-.5).mul(d).mul(c)};
Jmat.Complex.ellipticrj=function(a,b,c,d){var e=Jmat.Complex,f=d;if(0>=f.re){if(a.re>b.re){var g=a;a=b;b=g}b.re>c.re&&(g=b,b=c,c=g);a.re>b.re&&(g=a,a=b,b=g);g=b.sub(f).rdiv(1);var h=g.mul(c.sub(b)).mul(b.sub(a));d=b.add(h);var k=e.ellipticrc(a.mul(c).div(b),f.mul(d).div(b))}for(var l=0,m,n,p,q,t=function(a){return a.mul(a)},v=e(0),y=e(1),x;;){x=a.add(b).add(c).add(d).add(d).divr(5);m=a.div(x).rsub(1);n=b.div(x).rsub(1);p=c.div(x).rsub(1);q=d.div(x).rsub(1);if(.0015>Math.max(Math.max(m.abs(),n.abs()),
Math.max(p.abs(),q.abs())))break;var w=e.sqrt(a),z=e.sqrt(b),A=e.sqrt(c),D=w.mul(z).add(z.mul(A)).add(A.mul(w));w=t(d.mul(w.add(z).add(A)).add(w.mul(z).mul(A)));z=d.mul(t(d.add(D)));v=v.add(y.mul(e.ellipticrc(w,z)));y=y.divr(4);a=a.add(D).divr(4);b=b.add(D).divr(4);c=c.add(D).divr(4);d=d.add(D).divr(4);l++;if(1E3<l)break}d=m.mul(n).mul(p);l=q.mul(q).mul(q);m=m.mul(n).add(m.mul(p)).add(n.mul(p)).sub(q.mul(q).mulr(3));n=d.add(m.mul(q).mulr(2)).add(l.mulr(4));p=d.mulr(2).add(m.mul(q)).add(l.mulr(3)).mul(q);
q=d.mul(q).mul(q);q=e(1).sub(m.mulr(3/14)).add(n.divr(6)).add(m.mul(m).mulr(9/88)).sub(p.mulr(3/22)).sub(m.mul(n).mulr(9/52)).add(q.mulr(3/26));v=v.mulr(3).add(y.mul(q).mul(x.powr(-1.5)));0>=f.re&&(a=e.ellipticrf(a,b,c),v=g.mul(h.mul(v).add(k.sub(a).mulr(3))));return v};
Jmat.Complex.ellipticrd=function(a,b,c){for(var d=Jmat.Complex,e=0,f,g,h,k,l=d(0),m=d(1);;){k=a.add(b).add(c.mulr(3)).divr(5);if(d.nearr(k,0,1E-14))return d(0);f=a.div(k).rsub(1);g=b.div(k).rsub(1);h=c.div(k).rsub(1);if(.0015>Math.max(Math.max(f.abs(),g.abs()),h.abs()))break;var n=d.sqrt(a),p=d.sqrt(b),q=d.sqrt(c);n=n.mul(p).add(p.mul(q)).add(q.mul(n));l=l.add(m.div(q.mul(c.add(n))));m=m.divr(4);a=a.add(n).divr(4);b=b.add(n).divr(4);c=c.add(n).divr(4);e++;if(1E3<e)break}a=f.mul(g).sub(h.mul(h).mulr(6));
b=f.mul(g).mulr(3).sub(h.mul(h).mulr(8)).mul(h);f=f.mul(g).sub(h.mul(h)).mulr(3).mul(h).mul(h);g=h.mul(g).mul(h).mul(h).mul(h);d=d(1).sub(a.mulr(3/14)).add(b.divr(6)).add(a.mul(a).mulr(9/88)).sub(f.mulr(3/22)).sub(a.mul(b).mulr(9/52)).add(g.mulr(3/26));return m.mul(k.powr(-1.5)).mul(d).add(l.mulr(3))};Jmat.Complex.elliptick=function(a){var b=Jmat.Complex;return b.ellipticrf(b(0),a.mul(a).rsub(1),b(1))};
Jmat.Complex.incellipticf=function(a,b){var c=Jmat.Complex,d=c.sin(a);a=c.cos(a);return d.mul(c.ellipticrf(a.mul(a),b.mul(b).mul(d).mul(d).rsub(1),c(1)))};Jmat.Complex.elliptice=function(a){var b=Jmat.Complex;a=a.mul(a);var c=b.ellipticrf(b(0),a.rsub(1),b(1));b=b.ellipticrd(b(0),a.rsub(1),b(1));return c.sub(b.mul(a).divr(3))};
Jmat.Complex.incelliptice=function(a,b,c){var d=Jmat.Complex,e=d.sin(a),f=d.cos(a),g=e.mul(e);a=g.mul(e);f=f.mul(f);var h=c.mul(c);c=d.ellipticrf(f,h.mul(g).rsub(1),d(1));d=d.ellipticrd(f,h.mul(g).rsub(1),d(1));return e.mul(c).add(b.mul(a).mul(d).mulr(3))};Jmat.Complex.ellipticpi=function(a,b){var c=Jmat.Complex,d=b.mul(b);b=c.ellipticrf(c(0),d.rsub(1),c(1));c=c.ellipticrj(c(0),d.rsub(1),c(1),a.rsub(1));return b.add(c.mul(a).divr(3))};
Jmat.Complex.incellipticpi=function(a,b,c){var d=Jmat.Complex,e=d.sin(a),f=d.cos(a),g=e.mul(e);a=g.mul(e);f=f.mul(f);var h=c.mul(c);c=d.ellipticrf(f,h.mul(g).rsub(1),d(1));d=d.ellipticrj(f,h.mul(g).rsub(1),d(1),b.mul(g).rsub(1));return e.mul(c).add(b.mul(a).mul(d).mulr(3))};
Jmat.Complex.agm=function(a,b){if(a.eq(b.neg())||a.eq(Jmat.Complex.ZERO)||b.eq(Jmat.Complex.ZERO))return Jmat.Complex(0);for(var c=Jmat.Complex.isReal(a)&&Jmat.Complex.isReal(b)&&0>a.re==0>b.re,d,e=0;60>e&&!a.eq(b);e++)d=a.add(b).divr(2),b=Jmat.Complex.mulSqrtBranch_(a,b),a=d;c&&(a.im=0);return a};Jmat.Complex.ghm=function(a,b){for(var c,d=0;60>d&&!a.eq(b);d++)c=Jmat.Complex.mulSqrtBranch_(a,b),b=Jmat.Complex.TWO.div(a.inv().add(b.inv())),a=c;return a};
Jmat.Real.tetration_loop_=function(a,b,c,d){for(var e,f=0;f<c;f++){b=d?Jmat.Real.logy(b,a):Math.pow(a,b);if(Jmat.Real.isInfOrNaN(b))break;if(Infinity==b)break;if(b==e)break;e=b;if(1E3<f)return NaN}return b};
Jmat.Real.tetration=function(a,b){var c=Jmat.Real;if(0==b)return 1;if(1==b)return a;if(2==b)return Math.pow(a,a);if(2<=a&&5<b)return Infinity;if(0==a&&c.isPositiveInt(b))return Jmat.Complex.isEven(b)?1:0;if(Infinity==b&&0<a)return a=Math.log(a),c.lambertw(-a)/-a;if(c.isPositiveInt(b))return c.tetration_loop_(a,a,b-1,!1);if(-1<b&&0>=b)return 1+b;if(0<b){var d=b-Math.floor(b);return c.tetration_loop_(a,d,Math.ceil(b),!1)}return-1>=b?(d=b-Math.floor(b),c.tetration_loop_(a,d,-Math.ceil(b),!0)):NaN};
Jmat.Complex.tetration_loop_=function(a,b,c,d){for(var e=Jmat.Complex,f,g=0;g<c;g++){b=d?e.logy(b,a):a.pow(b);if(e.isInfOrNaN(b))break;if(b.eq(f))break;f=b;if(1E3<g)return e(NaN)}return b};
Jmat.Complex.tetrational=function(a){var b=Jmat.Complex,c=[.30685281944005,.59176735125832,.3964832129017,.17078658150959,.08516537613999,.03804195209047,.01734090876306,.00755271038865,.00328476064839,.0013936174017,5.8758348148E-4,2.4379186661E-4,1.0043966462E-4,4.090111776E-5,1.654344436E-5,6.63102846E-6,2.64145664E-6,1.04446533E-6,4.1068839E-7,1.6048059E-7,6.239367E-8,2.412797E-8,9.28797E-9,3.5585E-9,1.35774E-9,5.1587E-10],d=[b(.37090658903229,1.33682167078891),b(.01830048268799,.06961107694975),
b(-.0422210796016,.02429633404907),b(-.01585164381085,-.01478953595879),b(.00264738081895,-.0065755813052),b(.00182759574799,-2.5319516391E-4),b(3.656299477E-4,2.824651581E-4),b(2.689538943E-5,1.4180498091E-4),b(-3.139436775E-5,3.583704949E-5),b(-1.376358453E-5,-1.83512708E-6),b(-1.8029098E-6,-3.14787679E-6),b(2.639887E-7,-9.2613311E-7),b(2.4961828E-7,-1.3664223E-7),b(6.37479E-9,2.270476E-8),b(-3.41142E-9,5.12289E-9),b(-1.62203E-9,3.1619E-10),b(-3.8743E-10,-2.7282E-10),b(-1.201E-11,-1.344E-10),b(2.57E-11,
-2.543E-11),b(9.35E-12,4.5E-13),b(1.7E-12,1.86E-12),b(-5E-14,7.1E-13),b(-1.6E-13,1.2E-13),b(-5E-14,-1E-14),b(-1E-14,-1E-14)],e=[b(.31813150520476413,1.3372357014306895),b(1),b(-.15131489715565175,-.2967488367322413),b(-.03697630940906762,.09873054431149697),b(.02581159797314014,-.017386962126530753),b(-.0079444196,5.7925018E-4)],f=function(a){var c=b(1.077961437528,-.94654096394782),d=b(.12233176,-.02366108);c=b.exp(e[0].mul(a).add(c));a=d.mul(c).mul(b.exp(a.mul(b.newi(2*Math.PI))));return b.powerSeries(e,
e.length,b.ZERO,c).add(a)},g=function(a){return b.log(a.addr(2)).add(b.powerSeries(c,c.length,b.ZERO,a))},h=function(a){return b.powerSeries(d,d.length,b.newi(3),a)},k=b(Jmat.Real.fracn(a.re),a.im);f=-4.5>a.im?f(k.conj()).conj():-1.5>a.im?h(k.conj()).conj():1.5>a.im?g(k):4.5>a.im?h(k):f(k);return 0<a.re?b.tetration_loop_(b.E,f,Math.floor(a.re),!1):b.tetration_loop_(b.E,f,-Math.ceil(a.re),!0)};
Jmat.Complex.tetration=function(a,b){var c=Jmat.Complex;if(c.isPositive(a)&&c.isPositiveInt(b)&&Infinity!=b.re)return c(Jmat.Real.tetration(a.re,b.re));if(b.eqr(0))return c(1);if(b.eqr(1))return a;if(b.eqr(2))return a.pow(a);if(c.isReal(a)&&2<=a.re&&5<b)return c(Infinity);if(a.eqr(0)&&c.isPositiveInt(b))return c.isEven(b)?c(1):c(0);if(b.eqr(Infinity)){if(a.eqr(1))return c(1);a=c.log(a);return c.lambertw(a.neg()).div(a.neg())}if(c.isPositiveInt(b))return c.tetration_loop_(a,a,b.re-1,!1);if(c.isReal(b)){if(b.eqr(-1))return c(0);
if(-1<b.re&&0>=b.re)return b.inc();if(0<b.re){var d=b.sub(c.floor(b));return c.tetration_loop_(a,d,Math.ceil(b.re),!1)}if(-1>=b.re)return d=b.sub(c.floor(b)),c.tetration_loop_(a,d,-Math.ceil(b.re),!0)}return c.near(a,c.E,1E-15)?c.tetrational(b):c(NaN)};
Jmat.Complex.ei=function(a){var b=Jmat.Complex,c=a.abs();if(0==c)return b(-Infinity);if(Infinity==c)return 0<a.re?b(Infinity):b(0,Math.sign(a.im)*Math.PI);if(5<c)for(var d=b(0),e=b(1),f=Math.min(30,Math.floor(a.abs())+1),g=1;g<=f;g++){var h=e;e=e.mul(a.rdiv(g));if(b.nearr(e,0,1E-15))return g=b(0,Math.sign(a.im)*Math.PI),d=d.addr(1).div(a),100<a.abs()?b.exp(a.add(b.log(d))).add(g):b.exp(a).mul(d).add(g);if(e.abs()>h.abs()){d.sub(h);break}d=d.add(e)}if(1<c&&(0>a.re||1<Math.abs(a.im))){d=b(0,Math.sign(a.im)*
Math.PI);c=b(0);b(0);g=b.exp(a);0==a.im?(e=a.rsub(1).inv(),d=e.mul(g).neg()):(c=a.rsub(1).sub(g.div(d)).inv(),e=a.rsub(1).inv(),d=d.mul(e.div(c)));for(g=1;30>g&&(c=a.rsub(2*g+1).sub(c.mulr(g*g)).inv(),e=a.rsub(2*g+1).sub(e.mulr(g*g)).inv(),h=d,d=d.mul(e.div(c)),!b.near(d,h,1E-15));g++);return d}d=0;0!=a.im&&(d=Math.sign(a.im)*Math.abs(b.arg(a).re));d=b.EM.add(b.log(b.abs(a))).add(b(0,d));b=a;for(g=h=1;30>g;g++){c=d.add(b.divr(g*h));if(d.eq(c))break;d=c;b=b.mul(a);h*=g+1}return d};
Jmat.Complex.e1=function(a){var b=Jmat.Complex,c=b.ei(a.neg()).neg();if(0>a.im)c=c.add(b(0,Math.PI));else if(0<a.im||0>a.re)c=c.sub(b(0,Math.PI));return c};Jmat.Complex.li=function(a){var b=Jmat.Complex;return b.ei(b.log(a))};Jmat.Complex.li2=function(a){return Jmat.Complex.li(a).subr(1.045163780117493)};
Jmat.Complex.si_pade_=function(a){var b=a.mul(a),c=b.mulr(-6.053382120104225E-16).addr(7.08240282274876E-13).mul(b).addr(-3.5320197899716837E-10).mul(b).addr(9.432808094387131E-8).mul(b).addr(-1.4101853682133025E-5).mul(b).addr(.0011545722575101668).mul(b).addr(-.045439340981633).mul(b).addr(1);b=b.mulr(3.2110705119371216E-16).addr(4.504909757538658E-13).mul(b).addr(3.280675710557897E-10).mul(b).addr(1.556549863087456E-7).mul(b).addr(4.9917511616975513E-5).mul(b).addr(.010116214573922557).mul(b).addr(1);
return a.mul(c).div(b)};
Jmat.Complex.ci_pade_=function(a){var b=Jmat.Complex,c=a.mul(a),d=c.mulr(-9.937284888575855E-15).addr(1.0648080289118924E-11).mul(c).addr(-4.68889508144848E-9).mul(c).addr(1.052973638462392E-6).mul(c).addr(-1.275283422402677E-4).mul(c).addr(.007518515244388983).mul(c).addr(-.25).mul(c);c=c.mulr(1.3975961673137686E-18).addr(1.8910605471305976E-15).mul(c).addr(1.3853635277277863E-12).mul(c).addr(6.970712957609589E-10).mul(c).addr(2.5553327708612963E-7).mul(c).addr(6.721268008142544E-5).mul(c).addr(.011592605689110734).mul(c).addr(1);return b.log(a).addr(.5772156649015329).add(d.div(c))};
Jmat.Complex.f_pade_=function(a){var b=a.mul(a).inv(),c=b.mulr(-4.9470116864541595E11).addr(4.94816688199952E12).mul(b).addr(1.0079518298036857E13).mul(b).addr(4.2096818057107695E12).mul(b).addr(6.40533830574022E11).mul(b).addr(4.337362388704325E10).mul(b).addr(1.4307340382127464E9).mul(b).addr(2.3775031012543183E7).mul(b).addr(196396.37289514687).mul(b).addr(744.4370681619367).mul(b).addr(1);b=b.mulr(1.1153549350991426E13).addr(1.4346854917158102E13).mul(b).addr(5.060844645934751E12).mul(b).addr(7.085013081495154E11).mul(b).addr(4.585951158477658E10).mul(b).addr(1.4747895219298546E9).mul(b).addr(2.4153567016512685E7).mul(b).addr(197865.24703158395).mul(b).addr(746.4370681619276).mul(b).addr(1);
return c.div(b).div(a)};
Jmat.Complex.g_pade_=function(a){a=a.mul(a).inv();var b=a.mulr(-1.3651713767087168E12).addr(6.432916131430495E12).mul(a).addr(1.8100448746466457E13).mul(a).addr(7.576645832578344E12).mul(a).addr(1.0904952845036278E12).mul(a).addr(6.83052205423625E10).mul(a).addr(2.0629759514676335E9).mul(a).addr(3.1255757079577874E7).mul(a).addr(235239.1816264782).mul(a).addr(813.5952011516862).mul(a).addr(1),c=a.mulr(3.996532578874908E13).addr(4.0183908730765664E13).mul(a).addr(1.171647233717366E13).mul(a).addr(1.3986671069641458E12).mul(a).addr(7.8746501734183E10).mul(a).addr(2.2335554327809935E9).mul(a).addr(3.2602666164709084E7).mul(a).addr(240036.75283557878).mul(a).addr(819.5952011514515).mul(a).addr(1);return a.mul(b).div(c)};
Jmat.Complex.si=function(a){var b=Jmat.Complex;if(4>a.abs())return b.si_pade_(a);if(1<Math.abs(a.re)){var c=b.f_pade_(a),d=b.cos(a),e=b.g_pade_(a),f=b.sin(a);a=b.I.mulr(0>a.re||0==a.re&&0>a.im?Math.PI:-Math.PI);return a.muli(.5).sub(c.mul(d)).sub(e.mul(f))}c=b.e1(a.mul(b.I).neg());d=b.e1(a.mul(b.I));a=b.I.mulr(0>a.re||0==a.re&&0>a.im?Math.PI:-Math.PI);return c.sub(d).add(a).mul(b.I).mulr(.5)};
Jmat.Complex.ci=function(a){var b=Jmat.Complex;if(4>a.abs())return b.ci_pade_(a);if(1<Math.abs(a.re)){var c=b.f_pade_(a),d=b.cos(a),e=b.g_pade_(a),f=b.sin(a);b.log(a);a=0<a.re||0==a.re&&0<a.im?b(0):b(0,(0>a.im?-1:1)*Math.PI);return c.mul(f).sub(e.mul(d)).add(a)}c=b.e1(a.mul(b.I).neg());d=b.e1(a.mul(b.I));b=b.log(a);a=(0<a.re||0==a.re&&0<a.im?b:b.subi((0>a.im?-1:1)*Math.PI)).mulr(2);return c.add(d).add(a).mulr(-.5).add(b)};Jmat.Complex.shi=function(a){return Jmat.Complex.si(a.muli(1)).muli(1).neg()};
Jmat.Complex.chi=function(a){var b=Jmat.Complex,c=new b(0,0>a.re&&0<=a.im?3*Math.PI/2:-Math.PI/2);return b.ci(a.muli(1)).add(c)};
Jmat.Complex.erf_inv=function(a){var b=Jmat.Complex;if(0>a.re)return b.erf_inv(a.neg()).neg();if(0>a.im)return b.erf_inv(a.conj()).conj();if(0!=a.im&&1<Math.abs(a.re)){var c=0>a.re;c&&(a=a.neg());var d=b.sqrt(b.log(a.mulr(Jmat.Real.SQRTPI).mul(b.ONE.sub(a))).neg());a=b.finvert_newton(a,b.erf,function(a){return b.TWO.divr(Jmat.Real.SQRTPI).mul(b.exp(a.mul(a).neg()))},d);c&&(a=a.neg());return a}if(0==a.im){if(0==a.re)return b(0);if(1==a.re)return b(Infinity);if(-1==a.re)return b(-Infinity)}var e=[.886226899,
-1.645349621,.914624893,-.140543331];c=[1,-2.118377725,1.442710462,-.329097515,.012229801];var f=[-1.970840454,-1.62490649,3.429567803,1.641345311];d=[1,3.5438892,1.6370678];.7>=a.abs()?(d=a.mul(a),e=a.mul(d.mulr(e[3]).addr(e[2]).mul(d).addr(e[1]).mul(d).addr(e[0])),e=e.div(d.mulr(c[4]).addr(c[3]).mul(d).addr(c[2]).mul(d).addr(c[1]).mul(d).addr(c[0]))):(c=b.sqrt(b.log(b.ONE.sub(a).divr(2)).neg()),e=c.mulr(f[3]).addr(f[2]).mul(c).addr(f[1]).mul(c).addr(f[0]),e=e.div(c.mulr(d[2]).addr(d[1]).mul(c).addr(d[0])));
e=e.sub(b.erf(e).sub(a).div(b.exp(e.mul(e).neg()).mulr(2/Jmat.Real.SQRTPI)));return e=e.sub(b.erf(e).sub(a).div(b.exp(e.mul(e).neg()).mulr(2/Jmat.Real.SQRTPI)))};Jmat.Complex.erfc_inv=function(a){return Jmat.Complex.erf_inv(Jmat.Complex.ONE.sub(a))};
Jmat.Real.erf_inv=function(a){var b=Jmat.Real;if(0==a)return 0;if(0>a)return-b.erf_inv(-a);if(1==a)return Infinity;if(-1==a)return-Infinity;if(-1>a||1<a)return NaN;var c=[.886226899,-1.645349621,.914624893,-.140543331],d=[1,-2.118377725,1.442710462,-.329097515,.012229801],e=[-1.970840454,-1.62490649,3.429567803,1.641345311],f=[1,3.5438892,1.6370678];.7>=Math.abs(a)?(f=a*a,c=a*(((f*c[3]+c[2])*f+c[1])*f+c[0]),c/=(((f*d[4]+d[3])*f+d[2])*f+d[1])*f+d[0]):(d=Math.sqrt(-Math.log((1-a)/2)),c=((d*e[3]+e[2])*
d+e[1])*d+e[0],c/=(d*f[2]+f[1])*d+f[0]);c-=(b.erf(c)-a)/(2/b.SQRTPI*Math.exp(-c*c));return c-=(b.erf(c)-a)/(2/b.SQRTPI*Math.exp(-c*c))};Jmat.Real.erfc_inv=function(a){return Jmat.Real.erf_inv(1-a)};Jmat.Complex.fresnels=function(a){var b=Jmat.Complex,c=Jmat.Real,d=b.erf(b(1,1).mulr(c.SQRTPI/2).mul(a));a=b.erf(b(1,-1).mulr(c.SQRTPI/2).mul(a));return d.sub(a.muli(1)).mul(b(.25,.25))};
Jmat.Complex.fresnelc=function(a){var b=Jmat.Complex,c=Jmat.Real,d=b.erf(b(1,1).mulr(c.SQRTPI/2).mul(a));a=b.erf(b(1,-1).mulr(c.SQRTPI/2).mul(a));return d.add(a.muli(1)).mul(b(.25,-.25))};Jmat.Real.minkowski=function(a){if(a!=a)return NaN;var b=Math.floor(a),c=1,d=b+1,e=1,f=1,g=b;if(a<b||0>b!=0>=d)return a;for(;;){f/=2;if(g+f==g)break;var h=b+d;if(0>h!=0>b)break;var k=c+e;if(0>k)break;a<h/k?(d=h,e=k):(g+=f,b=h,c=k)}return g+f};
Jmat.Complex.minkowski=function(a){return Jmat.Complex(Jmat.Real.minkowski(a.re),Jmat.Real.minkowski(a.im))};Jmat.Complex.rootfind_bisection=function(a,b,c,d,e){if(0!=a.im||0!=b.im)return NaN;a=Jmat.Real.rootfind_bisection(a.re,b.re,function(a){a=c(Complex(a));return 0!=a.im?NaN:a.re},d,e);return Jmat.Complex(a)};
Jmat.Real.rootfind_bisection=function(a,b,c,d,e){d=void 0==d?256:d;e=void 0==e?1E-9:e;var f=b;if(f<a){var g=a;a=f;f=g}if(Infinity==f-a)return NaN;for(var h=g=NaN,k=0,l=0,m=0;m<=d;m++){var n=a+m*(f-a)/d;m==d&&(n=b);var p=c(n);if(Jmat.Real.near(p,0,e))return n;p>k&&(g=n,k=p);p<l&&(h=n,l=p)}if(h!=h||g!=g)return NaN;for(m=0;100>m;m++){n=(h+g)/2;p=c(n);if(Jmat.Real.near(p,0,e))return n;0<p&&(g=n);0>p&&(h=n);if(Jmat.Real.near(h,g,e))return n}};
Jmat.Complex.rootfind_secant=function(a,b,c,d,e){d=d||30;e=e||1E-15;for(var f=c(a),g=c(b),h=0;h<d;h++){var k=a.mul(g).sub(b.mul(f)).div(g.sub(f));Jmat.Complex.isInfOrNaN(k);var l=c(k);if(Jmat.Real.near(l,0,e))return k;a=b;f=g;b=k;g=l}return b};
Jmat.Complex.rootfind=function(a,b){b||(b={});var c=b.z0||Jmat.Complex.ZERO,d=b.maxit||30,e=void 0==b.prec?1E-9:b.prec;return b.real&&void 0!=b.z1?Jmat.Complex.rootfind_bisection(c,b.z1,a,d,e):b.df?Jmat.Complex.rootfind_newton(a,b.df,c,d):Jmat.Complex.rootfind_newton_noderiv(a,c,d)};
Jmat.Complex.newtonStartValues_=[Jmat.Complex(0),Jmat.Complex(.1),Jmat.Complex(-.1),Jmat.Complex.newi(.1),Jmat.Complex.newi(-.1),Jmat.Complex(.1,.1),Jmat.Complex(.1,-.1),Jmat.Complex(-.1,.1),Jmat.Complex(-.1,-.1),Jmat.Complex(1),Jmat.Complex(-1),Jmat.Complex.newi(1),Jmat.Complex.newi(-1)];
Jmat.Complex.newtonStartValue_=function(a){for(var b=Jmat.Complex.newtonStartValues_,c=Infinity,d=Jmat.Complex(NaN),e=0;e<b.length;e++){var f=b[e],g=a(f);g=Jmat.Complex.manhattan(g,Jmat.Complex.ZERO);g<c&&(c=g,d=f)}return d};Jmat.Complex.newtonStartValuesAround_=[Jmat.Complex(1),Jmat.Complex(-1),Jmat.Complex.newi(1),Jmat.Complex.newi(-1)];
Jmat.Complex.newtonStartValueAround_=function(a,b,c){for(var d=Jmat.Complex.newtonStartValuesAround_,e=Infinity,f=Jmat.Complex(NaN),g=0;g<d.length;g++){var h=b.add(d[g].mulr(c)),k=a(h);k=Jmat.Complex.manhattan(k,Jmat.Complex.ZERO);k<e&&(e=k,f=h)}return f};Jmat.Real.rootfind_newton2=function(a,b,c){b||(b=0);c||(c=30);for(var d,e=Infinity,f=NaN,g=0;g<c;g++){d=b;var h=a(b);b-=h[0]/h[1];h=Infinity;Jmat.Real.isInfOrNaN(b)?b=d-.1:h=Math.abs(b-d);if(h<e&&(g=0,f=b,e=h,1E-15>h))break}return f};
Jmat.Real.rootfind_newton=function(a,b,c,d){return Jmat.Real.rootfind_newton2(function(c){return[a(c),b(c)]},c,d)};Jmat.Real.finvert_newton=function(a,b,c,d,e){return Jmat.Real.rootfind_newton(function(c){return b(c)-a},c,d,e)};
Jmat.Complex.rootfind_newton=function(a,b,c,d){c||(c=Jmat.Complex.ZERO);d||(d=30);for(var e=c,f=Infinity,g=Jmat.Complex(NaN),h=0;h<d;h++){var k=a(c),l=Jmat.Complex.manhattan(k,Jmat.Complex.ZERO);if(Jmat.Real.near(l,0,1E-15))return c;l<f&&(f=l,g=c);k=c.sub(k.div(b(c)));Jmat.Complex.isInfOrNaN(k)&&(l=Jmat.Complex.manhattan(c,e),k=Jmat.Complex.newtonStartValueAround_(a,c,l?l:.1));e=c=k}return g};
Jmat.Complex.rootfind_newton_noderiv=function(a,b,c){return Jmat.Complex.rootfind_newton(a,function(b){return Jmat.Complex.differentiate_stencil5(b,a)},b,c)};Jmat.Complex.finvert_newton=function(a,b,c,d,e){return Jmat.Complex.rootfind_newton(function(c){return b(c).sub(a)},c,d,e)};Jmat.Complex.finvert_newton_noderiv=function(a,b,c,d){return Jmat.Complex.rootfind_newton_noderiv(function(c){return b(c).sub(a)},c,d)};Jmat.Real.gausleg_cache_=[];
Jmat.Real.gauss_legendre_roots_=function(a){if(Jmat.Real.gausleg_cache_[a])return Jmat.Real.gausleg_cache_[a];for(var b=function(a,b){for(var c=1,d=a,e=2;e<=b;e++){var f=((2*e-1)*a*d-(e-1)*c)/e;c=d;d=f}return[d,(b*c-b*a*d)/(1-a*a)]},c=[],d=[],e=0;e<a;e++){var f=Math.cos(Math.PI*(e+.75)/(a+.5));f=Jmat.Real.rootfind_newton2(function(c){return b(c,a)},f,100);var g=b(f,a);c[e]=f;d[e]=2/((1-f*f)*g[1]*g[1])}Jmat.Real.gausleg_cache_[a]=[c,d];return Jmat.Real.gausleg_cache_[a]};Jmat.Real.gauslag_cache_=[];
Jmat.Real.gauss_laguerre_roots_=function(a){if(Jmat.Real.gauslag_cache_[a])return Jmat.Real.gauslag_cache_[a];for(var b=function(a,b){if(0==b)return[1,0,0];for(var c=1,d=1-a,e=2;e<=b;e++){var f=((2*e-1-a)*d-(e-1)*c)/e;c=d;d=f}return[d,b*(d-c)/a,c]},c=[],d=[],e=0;e<a;e++){var f=0;f=0==e?3/(1+2.4*a):1==e?c[e-1]+15/(1+2.5*a):c[e-1]+(1+2.55*(e-1))/(1.9*(e-1))*(c[e-1]-c[e-2]);f=Jmat.Real.rootfind_newton2(function(c){return b(c,a)},f,100);var g=b(f,a);c[e]=f;d[e]=-1/(a*g[1]*g[2])}Jmat.Real.gauslag_cache_[a]=
[c,d];return Jmat.Real.gauslag_cache_[a]};Jmat.Real.integrate_simpson=function(a,b,c,d,e){b=(b-a)/d;for(var f=0,g=0,h=0;h<=d;h++){var k=a+(h-1)*b,l=a+h*b,m=c((k+l)/2),n=c(l);0<h&&(f+=(l-k)/6*(g+4*m+n));g=n;if(e&&49==h%50&&e())return NaN}return f};Jmat.Real.integrate_gaussian_legendre=function(a,b,c,d){if(1>d||d!=Math.round(d)||100<d)return NaN;var e=Jmat.Real.gauss_legendre_roots_(d),f=e[0];e=e[1];var g=(b-a)/2;a=(b+a)/2;for(var h=b=0;h<d;h++)b+=c(g*f[h]+a)*e[h];return g*b};
Jmat.Real.integrate_gaussian_laguerre=function(a,b,c){if(1>c||c!=Math.round(c)||100<c)return NaN;var d=Jmat.Real.gauss_laguerre_roots_(c);c=d[0];d=d[1];for(var e=0,f=0;f<c.length;f++){var g=Math.exp(-c[f]),h=b(c[f]+a);e+=h/g*d[f]}return e};
Jmat.Real.integrate_gaussian=function(a,b,c,d){var e=Jmat.Real;return Infinity==b?-Infinity==a?(a=e.integrate_gaussian_laguerre(0,function(a){return c(-a)},d),d=e.integrate_gaussian_laguerre(0,c,d),a+d):e.integrate_gaussian_laguerre(a,c,d):-Infinity==a?e.integrate_gaussian_laguerre(-a,function(a){return c(-a)},d):e.integrate_gaussian_legendre(a,b,c,d)};
Jmat.Real.integrate=function(a,b,c,d,e){void 0==e&&(e=1);d||(d=1==e?20:30);return 0==e?Jmat.Real.integrate_simpson(a,b,c,d):Jmat.Real.integrate_gaussian(a,b,c,d)};Jmat.Complex.integrate_gaussian_legendre=function(a,b,c,d){var e=Jmat.Complex;if(1>d||d!=Math.round(d)||100<d)return e(NaN);var f=Jmat.Real.gauss_legendre_roots_(d),g=f[0];f=f[1];var h=b.sub(a).divr(2);a=b.add(a).divr(2);e=e(0);for(b=0;b<d;b++)e=e.add(c(h.mulr(g[b]).add(a)).mulr(f[b]));return h.mul(e)};
Jmat.Complex.integrate_gaussian_laguerre=function(a,b,c){var d=Jmat.Complex;if(1>c||c!=Math.round(c)||100<c)return d(NaN);var e=Jmat.Real.gauss_laguerre_roots_(c);c=e[0];e=e[1];for(var f=d(0),g=0;g<c.length;g++){var h=Math.exp(-c[g]),k=b(d(c[g]).add(a));f=f.add(k.divr(h).mulr(e[g]))}return f};
Jmat.Complex.integrate_gaussian=function(a,b,c,d){var e=Jmat.Complex;return b.eqr(Infinity)?a.eqr(-Infinity)?(a=e.integrate_gaussian_laguerre(e(0),function(a){return c(a.neg())},d),d=e.integrate_gaussian_laguerre(e(0),c,d),a.add(d)):e.integrate_gaussian_laguerre(a,c,d):a.eqr(-Infinity)?e.integrate_gaussian_laguerre(a.neg(),function(a){return c(a.neg())},d):e.integrate_gaussian_legendre(a,b,c,d)};
Jmat.Complex.integrate_simpson=function(a,b,c,d,e){var f=b.sub(a).divr(d),g=Jmat.Complex(0),h=null,k=2;b.eqr(Infinity)&&(k=Math.pow(1E12/1E-12,1/d));for(var l=0;l<=d;l++){if(b.eqr(Infinity)){var m=n?n:a;var n=n?n.mulr(k):a.addr(1E-12)}else m=a.add(f.mulr(l-1)),n=a.add(f.mulr(l));var p=c(m.add(n).divr(2)),q=c(n);0<l&&(h=n.sub(m).divr(6).mul(h.add(p.mulr(4)).add(q)),g=g.add(h));h=q;if(e&&49==l%50&&e())return Jmat.Complex(NaN)}return g};
Jmat.Complex.integrate=function(a,b,c,d,e){void 0==e&&(e=1);d||(d=1==e?20:30);return 0==e?Jmat.Complex.integrate_simpson(a,b,c,d):Jmat.Complex.integrate_gaussian(a,b,c,d)};Jmat.Complex.differentiate_newton_noderiv=function(a,b){var c=Math.max(.01,Math.abs(a.re))/1E3,d=b(a.addr(c/2));a=b(a.subr(c/2));return d.sub(a).divr(c)};
Jmat.Complex.differentiate_stencil5=function(a,b){var c=Math.max(.01,Math.abs(a.re))/1E3,d=b(a.addr(2*c)).neg(),e=b(a.addr(c)).mulr(8),f=b(a.subr(c)).mulr(-8);a=b(a.subr(2*c));return d.add(e).add(f).add(a).divr(12*c)};Jmat.Complex.differentiate2nd_stencil5=function(a,b){var c=Jmat.Complex(Math.max(.01,Math.abs(a.re))/1E3),d=b(a.add(c.mulr(2))).neg(),e=b(a.add(c)).mulr(16),f=b(a).mulr(-30),g=b(a.sub(c)).mulr(16);a=b(a.sub(c.mulr(2))).neg();return d.add(e).add(f).add(g).add(a).div(c.mul(c).mulr(12))};
Jmat.Complex.differentiate=function(a,b){return Jmat.Complex.differentiate_stencil5(a,b)};Jmat.Complex.doSummation=function(a,b,c,d,e){if(0==c||0>c||!Jmat.Complex.isReal(a)||!Jmat.Complex.isReal(b))return Jmat.Complex(NaN);var f=a.re;b=b.re;a=Jmat.Complex(0);for(var g=0;f<=b+c/4;f+=c){var h=d(Jmat.Complex(f));a=a.add(h);if(e&&49==g%50&&e())return Jmat.Complex(NaN);g++}return a};
Jmat.Complex.doProduct=function(a,b,c,d,e){if(0==c||0>c||!Jmat.Complex.isReal(a)||!Jmat.Complex.isReal(b))return Jmat.Complex(NaN);b=b.re;var f=Jmat.Complex.ONE,g=0;for(a=a.re;a<=b+c/4;a+=c){var h=d(Jmat.Complex(a));f=f.mul(h);if(e&&49==g%50&&e())return Jmat.Complex(NaN);g++}return f};Jmat.Complex.powerSeries=function(a,b,c,d){for(var e=void 0==a[0].re,f=Jmat.Complex.ZERO,g=Jmat.Complex.ONE,h=0;h<b;h++)f=e?f.add(g.mulr(a[h])):f.add(g.mul(a[h])),g=g.mul(d.sub(c));return f};
Jmat.Real.powerSeries=function(a,b,c,d){for(var e=0,f=1,g=0;g<b;g++)e+=f*a[g],f*=d-c;return e};Jmat.Complex.pdf_uniform=function(a,b,c){return a.re>=b.re&&a.re<=c.re?c.sub(b).inv():Jmat.Complex(0)};Jmat.Complex.cdf_uniform=function(a,b,c){return a.re<b.re?Jmat.Complex(0):a.re<c.re?a.sub(b).div(c.sub(b)):Jmat.Complex(1)};Jmat.Complex.qf_uniform=function(a,b,c){a=b.add(a.mul(c.sub(b)));return a.re>=b.re&&a.re<=c.re?a:Jmat.Complex(NaN)};Jmat.Complex.pdf_standardnormal=function(a){return Jmat.Complex.exp(a.mul(a).mulr(-.5)).mul(Jmat.Complex.INVSQRT2PI)};
Jmat.Complex.cdf_standardnormal=function(a){return Jmat.Complex.erf(a.div(Jmat.Complex.SQRT2)).addr(1).mulr(.5)};Jmat.Complex.qf_standardnormal=function(a){return Jmat.Complex.erf_inv(a.mulr(2).subr(1)).mul(Jmat.Complex.SQRT2)};Jmat.Complex.pdf_normal=function(a,b,c){var d=Jmat.Complex.INVSQRT2PI.div(c);a=a.sub(b).mul(a.sub(b)).div(c.mul(c).mulr(2));return d.mul(Jmat.Complex.exp(a.neg()))};Jmat.Complex.cdf_normal=function(a,b,c){a=a.sub(b).divr(c.abs()).div(Jmat.Complex.SQRT2);return Jmat.Complex.erf(a).addr(1).mulr(.5)};
Jmat.Complex.qf_normal=function(a,b,c){return b.add(c.mul(Jmat.Complex.qf_standardnormal(a)))};Jmat.Complex.pdf_lognormal=function(a,b,c){var d=Jmat.Complex.INVSQRT2PI.div(c).div(a);a=Jmat.Complex.log(a).sub(b);return d.mul(Jmat.Complex.exp(a.mul(a).div(c.mul(c).mulr(2)).neg()))};Jmat.Complex.cdf_lognormal=function(a,b,c){if(a.eqr(0))return Jmat.Complex(0);a=Jmat.Complex.log(a).sub(b).div(Jmat.Complex.SQRT2.mul(c));return Jmat.Complex.erf(a).addr(1).mulr(.5)};
Jmat.Complex.qf_lognormal=function(a,b,c){a=Jmat.Complex.erf_inv(a.subr(.5).mulr(2));return Jmat.Complex.exp(Jmat.Complex.SQRT2.mul(c).mul(a).add(b))};Jmat.Complex.pdf_cauchy=function(a,b,c){a=a.sub(b);a=a.mul(a).add(c.mul(c)).mulr(Math.PI);return c.div(a)};Jmat.Complex.cdf_cauchy=function(a,b,c){return Jmat.Complex.atan(a.sub(b).div(c)).divr(Math.PI).addr(.5)};Jmat.Complex.qf_cauchy=function(a,b,c){return b.add(c.mul(Jmat.Complex.tan(a.subr(.5).mulr(Math.PI))))};
Jmat.Complex.pdf_studentt_cache_=[];Jmat.Complex.pdf_studentt_cachefun_=function(a){var b=a.inc().divr(2);return Jmat.Complex.exp(Jmat.Complex.loggammaDiv_(b,a.divr(2)))};
Jmat.Complex.pdf_studentt=function(a,b){if(b.eqr(1))return a.mul(a).addr(1).mulr(Math.PI).inv();if(b.eqr(2))return a.mul(a).addr(2).powr(1.5).inv();if(b.eqr(3)){var c=a.mul(a).addr(3);return Jmat.Complex(10.392304845413264).div(c.mul(c).mulr(Math.PI))}if(b.eqr(Infinity))return Jmat.Complex.pdf_standardnormal(a);c=b.inc().divr(2);var d=Jmat.Complex.calcCache_(b,Jmat.Complex.pdf_studentt_cachefun_,Jmat.Complex.pdf_studentt_cache_),e=Jmat.Complex.sqrt(Jmat.Complex.PI.mul(b)).inv();d=d.mul(e);Jmat.Complex.isNaN(d)&&
100<b.re&&(d=Jmat.Complex(Jmat.Complex.INVSQRT2PI));a=a.mul(a).div(b).inc();return d.mul(a.pow(c.neg()))};
Jmat.Complex.cdf_studentt=function(a,b){if(b.eqr(1))return Jmat.Complex.atan(a).divr(Math.PI).addr(.5);if(b.eqr(2))return a.div(Jmat.Complex.sqrt(a.mul(a).addr(2)).mulr(2)).addr(.5);if(b.eqr(Infinity))return Jmat.Complex.cdf_standardnormal(a);if(a.eqr(0))return Jmat.Complex(.5);if(0<a.re)return Jmat.Complex.beta_i(b.div(b.add(a.mul(a))),b.mulr(.5),Jmat.Complex(.5)).mulr(.5).rsub(1);if(0>a)return Jmat.Complex.cdf_studentt(a.neg(),b).rsub(1)};
Jmat.Complex.qf_studentt=function(a,b){if(b.eqr(1))return Jmat.Complex.tan(Jmat.Complex.PI.mul(a.subr(.5)));if(b.eqr(2))return b=a.mulr(4).mul(Jmat.Complex.ONE.sub(a)),a.subr(.5).mulr(2).mul(Jmat.Complex.sqrt(Jmat.Complex(2).div(b)));if(b.eqr(4)&&Jmat.Complex.isReal(a))return b=a.mulr(4).mul(Jmat.Complex.ONE.sub(a)),b=Jmat.Complex.sqrt(b),b=Jmat.Complex.cos(Jmat.Complex(1/3).mul(Jmat.Complex.acos(b))).div(b),Jmat.Complex.sign(a.subr(.5)).mulr(2).mul(Jmat.Complex.sqrt(b.dec()));if(b.eqr(Infinity))return Jmat.Complex.qf_standardnormal(a);
Jmat.Real.near(a.im,0,1E-15)&&(a=Jmat.Complex(a.re));Jmat.Real.near(b.im,0,1E-15)&&(b=Jmat.Complex(b.re));if(Jmat.Complex.isPositive(b)&&Jmat.Complex.isPositive(a)&&1>a.re){if(.5>a.re)return a=Jmat.Complex.beta_i_inv(a.mulr(2),b.divr(2),Jmat.Complex(.5)),Jmat.Complex.sqrt(b.mul(a.inv().subr(1))).neg();a=Jmat.Complex.beta_i_inv(Jmat.Complex.ONE.sub(a).mulr(2),b.divr(2),Jmat.Complex(.5));return Jmat.Complex.sqrt(b.mul(a.inv().subr(1)))}return Jmat.Complex(NaN)};
Jmat.Complex.pdf_chi_square=function(a,b){var c=b.divr(2);b=c.eqr(1)?Jmat.Complex(2):Jmat.Complex(2).pow(c);var d=Jmat.Complex.isNegativeInt(c)?Jmat.Complex(Infinity):Jmat.Complex.gamma(c);a=a.pow(c.dec()).mul(Jmat.Complex.exp(a.divr(-2)));return b.mul(d).inv().mul(a)};Jmat.Complex.cdf_chi_square=function(a,b){return Jmat.Complex.gamma_p(b.divr(2),a.divr(2))};Jmat.Complex.qf_chi_square=function(a,b){return Jmat.Complex.gamma_p_inv(b.divr(2),a).mulr(2)};
Jmat.Complex.pdf_logistic=function(a,b,c){a=Jmat.Complex.exp(a.sub(b).div(c).neg());b=a.inc();return a.div(c.mul(b).mul(b))};Jmat.Complex.cdf_logistic=function(a,b,c){return Jmat.Complex.tanh(a.sub(b).div(c).divr(2)).mulr(.5).addr(.5)};Jmat.Complex.qf_logistic=function(a,b,c){a=a.div(Jmat.Complex.ONE.sub(a));return b.add(c.mul(Jmat.Complex.log(a)))};Jmat.Complex.pdf_gamma_cache_=[];
Jmat.Complex.pdf_gamma=function(a,b,c){var d=a.pow(b.dec());a=Jmat.Complex.exp(a.div(c).neg());c=c.pow(b);b=Jmat.Complex.calcCache_(b,Jmat.Complex.gamma,Jmat.Complex.pdf_gamma_cache_);return d.mul(a).div(c).div(b)};Jmat.Complex.cdf_gamma=function(a,b,c){return Jmat.Complex.gamma_p(b,a.div(c))};Jmat.Complex.qf_gamma=function(a,b,c){return Jmat.Complex.gamma_p_inv(b,a).mul(c)};Jmat.Complex.pdf_beta=function(a,b,c){var d=a.pow(b.dec());a=a.rsub(1).pow(c.dec());b=Jmat.Complex.beta(b,c);return d.mul(a).div(b)};
Jmat.Complex.cdf_beta=function(a,b,c){return Jmat.Complex.beta_i(a,b,c)};Jmat.Complex.qf_beta=function(a,b,c){return Jmat.Complex.beta_i_inv(a,b,c)};Jmat.Complex.pdf_fisher=function(a,b,c){var d=b.mul(a).pow(b).mul(c.pow(c)),e=b.mul(a).add(c).pow(b.add(c));a=a.mul(Jmat.Complex.beta(b.divr(2),c.divr(2)));return Jmat.Complex.sqrt(d.div(e)).div(a)};Jmat.Complex.cdf_fisher=function(a,b,c){a=b.mul(a).div(b.mul(a).add(c));return Jmat.Complex.beta_i(a,b.divr(2),c.divr(2))};
Jmat.Complex.qf_fisher=function(a,b,c){a=Jmat.Complex.beta_i_inv(a,b.divr(2),c.divr(2));var d=Jmat.Complex.ONE.sub(a);return c.mul(a).div(b.mul(d))};Jmat.Complex.pdf_weibull=function(a,b,c){var d=c.div(b),e=a.div(b).pow(c.dec());a=a.div(b).pow(c).neg();return d.mul(e).mul(Jmat.Complex.exp(a))};Jmat.Complex.cdf_weibull=function(a,b,c){a=a.div(b).pow(c).neg();return Jmat.Complex.ONE.sub(Jmat.Complex.exp(a))};
Jmat.Complex.qf_weibull=function(a,b,c){a=Jmat.Complex.ONE.sub(a);c=Jmat.Complex.log(a).neg().pow(c.inv());return b.mul(c)};Jmat.Complex.pdf_exponential=function(a,b){return 0>a.re?Jmat.Complex(0):b.mul(Jmat.Complex.exp(a.mul(b).neg()))};Jmat.Complex.cdf_exponential=function(a,b){return 0>a.re?Jmat.Complex(0):Jmat.Complex.ONE.sub(Jmat.Complex.exp(a.mul(b).neg()))};Jmat.Complex.qf_exponential=function(a,b){return Jmat.Complex.log(a.rsub(1)).neg().div(b)};
Jmat.Complex.pdf_laplace=function(a,b,c){a=Jmat.Complex.exp(Jmat.Complex(a.sub(b).abs()).neg().div(c));return c.mulr(2).inv().mul(a)};Jmat.Complex.cdf_laplace=function(a,b,c){c=Jmat.Complex.exp(Jmat.Complex(a.sub(b).abs()).neg().div(c));a=Jmat.Complex.sign(a.sub(b));return c.rsub(1).mul(a).mulr(.5).addr(.5)};Jmat.Complex.qf_laplace=function(a,b,c){var d=Jmat.Complex.log(Jmat.Complex(a.subr(.5).abs()).mulr(2).rsub(1));a=Jmat.Complex.sign(a.subr(.5));return b.sub(c.mul(a).mul(d))};
Jmat.Complex.pmf_bernoulli=function(a,b){return a.eqr(0)?b.rsub(1):a.eqr(1)?b:b.pow(a).mul(b.rsub(1).pow(a.rsub(1)))};Jmat.Complex.cdf_bernoulli=function(a,b){return 0>a.re?Jmat.Complex.ZERO:1<=a.re?Jmat.Complex.ONE:b.rsub(1)};Jmat.Complex.qf_bernoulli=function(a,b){return a.eqr(0)?Jmat.Complex.ZERO:a.eqr(1)?Jmat.Complex.ONE:Jmat.Complex.ZERO};Jmat.Complex.pmf_binomial=function(a,b,c){return Jmat.Complex.binomial(b,a).mul(c.pow(a)).mul(c.rsub(1).pow(b.sub(a)))};
Jmat.Complex.cdf_binomial=function(a,b,c){return Jmat.Complex.beta_i(c.rsub(1),b.sub(a),a.addr(1))};Jmat.Complex.qf_binomial=function(a,b,c){if(c.eqr(0))return Jmat.Complex.ZERO;if(c.eqr(1))return b;var d=Jmat.Complex;d=Jmat.Complex.rootfind_bisection(d(0),b.addr(.1),function(d){return Jmat.Complex.cdf_binomial(d,b,c).sub(a)},100,1E-14);return Jmat.Complex.round(d)};Jmat.Complex.pmf_poisson=function(a,b){var c=b.pow(a);a=Jmat.Complex.factorial(a);b=Jmat.Complex.exp(b.neg());return c.mul(b).div(a)};
Jmat.Complex.cdf_poisson=function(a,b){return Jmat.Complex.gamma_q(a.addr(1),b)};Jmat.Complex.qf_poisson=function(a,b){return Jmat.Complex.gamma_q_inva(a,b).subr(1)};Jmat.Complex.linfit=function(a){var b=Jmat.Complex,c=b(0),d=b(0),e=b(0),f=b(0);b=b(0);for(var g=0;g<a.length;g++){var h=a[g][0],k=a[g][1];c=c.add(h);e=e.add(h.mul(h));d=d.add(k);f=f.add(k.mul(k));b=b.add(h.mul(k))}a=a.length;e=e.mulr(a).sub(c.mul(c));b=b.mulr(a).sub(c.mul(d));f=b.div(e);return[e.mul(d).sub(b.mul(c)).div(e.mulr(a)),f]};
Jmat.Real.pdf_uniform=function(a,b,c){return a>=b&&a<=c?1/(c-b):0};Jmat.Real.cdf_uniform=function(a,b,c){return a<b?0:a<c?(a-b)/(c-b):1};Jmat.Real.qf_uniform=function(a,b,c){a=b+a*(c-b);return a>=b&&a<=c?a:NaN};Jmat.Real.pdf_standardnormal=function(a){return Math.exp(-.5*a*a)*Jmat.Real.INVSQRT2PI};Jmat.Real.cdf_standardnormal=function(a){return.5*(Jmat.Real.erf(a/Jmat.Real.SQRT2)+1)};Jmat.Real.qf_standardnormal=function(a){return Jmat.Real.erf_inv(2*a-1)*Jmat.Real.SQRT2};
Jmat.Real.pdf_normal=function(a,b,c){return Jmat.Real.INVSQRT2PI/c*Math.exp(-((a-b)*(a-b)/(2*c*c)))};Jmat.Real.cdf_normal=function(a,b,c){return.5*(Jmat.Real.erf((a-b)/(Math.abs(c)*Jmat.Real.SQRT2))+1)};Jmat.Real.qf_normal=function(a,b,c){return b+c*Jmat.Real.qf_standardnormal(a)};Jmat.Real.pdf_lognormal=function(a,b,c){b=Math.log(a)-b;return Jmat.Real.INVSQRT2PI/(c*a)*Math.exp(-b*b/(2*c*c))};
Jmat.Real.cdf_lognormal=function(a,b,c){return 0==a?0:.5*(Jmat.Real.erf((Math.log(a)-b)/(Jmat.Real.SQRT2*c))+1)};Jmat.Real.qf_lognormal=function(a,b,c){a=Jmat.Real.erf_inv(2*(a-.5));return Math.exp(Jmat.Real.SQRT2*c*a+b)};Jmat.Real.pdf_cauchy=function(a,b,c){a-=b;return c/(Math.PI*(a*a+c*c))};Jmat.Real.cdf_cauchy=function(a,b,c){return Math.atan((a-b)/c)/Math.PI+.5};Jmat.Real.qf_cauchy=function(a,b,c){return b+c*Math.tan((a-.5)*Math.PI)};Jmat.Real.pdf_studentt_cache_=[];
Jmat.Real.pdf_studentt_cachefun_=function(a){return Math.exp(Jmat.Real.loggammaDiv_((a+1)/2,a/2))};
Jmat.Real.pdf_studentt=function(a,b){if(1==b)return 1/((a*a+1)*Math.PI);if(2==b)return Math.pow(a*a+2,-1.5);if(3==b)return a=a*a+3,10.392304845413264/(a*a*Math.PI);if(Infinity==b)return Jmat.Real.pdf_standardnormal(a);var c=(b+1)/2,d=Jmat.Real.calcCache_(b,Jmat.Real.pdf_studentt_cachefun_,Jmat.Real.pdf_studentt_cache_)*(1/Math.sqrt(Math.PI*b));isNaN(d)&&100<b&&(d=Jmat.Real(Jmat.Real.INVSQRT2PI));return d*Math.pow(a*a/b+1,-c)};
Jmat.Real.cdf_studentt=function(a,b){if(1==b)return Math.atan(a)/Math.PI+.5;if(2==b)return a/(2*Math.sqrt(a*a+2))+.5;if(Infinity==b)return Jmat.Real.cdf_standardnormal(a);if(0==a)return.5;if(0<a)return 1-.5*Jmat.Real.beta_i(b/(b+a*a),b/2,.5);if(0>a)return 1-Jmat.Real.cdf_studentt(-a,b)};
Jmat.Real.qf_studentt=function(a,b){if(1==b)return Math.tan(Math.PI*(a-.5));if(2==b)return 2*(a-.5)*Math.sqrt(2/(4*a*(1-a)));if(4==b)return b=Math.sqrt(4*a*(1-a)),2*Math.sign(a-.5)*Math.sqrt(Math.cos(Math.acos(b)/3)/b-1);if(Infinity==b)return Jmat.Real.qf_standardnormal(a);if(0>b||0>a||1<a)return NaN;if(.5>a)return a=Jmat.Real.beta_i_inv(2*a,b/2,.5),-Math.sqrt(b*(1/a-1));a=Jmat.Real.beta_i_inv(2*(1-a),b/2,.5);return Math.sqrt(b*(1/a-1))};
Jmat.Real.pdf_chi_square=function(a,b){var c=b/2,d=Math.pow(2,c),e=Jmat.Real.isNegativeInt(c)?Infinity:Jmat.Real.gamma(c);a=Math.pow(a,c-1)*Math.exp(-.5*a)/(d*e);return isNaN(a)&&200<b?0:a};Jmat.Real.cdf_chi_square=function(a,b){a=Jmat.Real.gamma_p(.5*b,.5*a);return isNaN(a)&&200<b?0:a};Jmat.Real.qf_chi_square=function(a,b){return 2*Jmat.Real.gamma_p_inv(.5*b,a)};Jmat.Real.pdf_logistic=function(a,b,c){a=Math.exp((b-a)/c);b=a+1;return a/(c*b*b)};
Jmat.Real.cdf_logistic=function(a,b,c){return.5*Jmat.Real.tanh(.5*(a-b)/c)+.5};Jmat.Real.qf_logistic=function(a,b,c){return b+c*Math.log(a/(1-a))};Jmat.Real.pdf_gamma_cache_=[];Jmat.Real.pdf_gamma=function(a,b,c){var d=Math.pow(a,b-1);a=Math.exp(-a/c);c=Math.pow(c,b);b=Jmat.Real.calcCache_(b,Jmat.Real.gamma,Jmat.Real.pdf_gamma_cache_);return d*a/(c*b)};Jmat.Real.cdf_gamma=function(a,b,c){return Jmat.Real.gamma_p(b,a/c)};Jmat.Real.qf_gamma=function(a,b,c){return Jmat.Real.gamma_p_inv(b,a)*c};
Jmat.Real.pdf_beta=function(a,b,c){var d=Math.pow(a,b-1);a=Math.pow(1-a,c-1);b=Jmat.Real.beta(b,c);return d*a/b};Jmat.Real.cdf_beta=function(a,b,c){return Jmat.Real.beta_i(a,b,c)};Jmat.Real.qf_beta=function(a,b,c){return Jmat.Real.beta_i_inv(a,b,c)};Jmat.Real.pdf_fisher=function(a,b,c){var d=Math.pow(b*a,b)*Math.pow(c,c),e=Math.pow(b*a+c,b+c);a*=Jmat.Real.beta(.5*b,.5*c);return Jmat.Real.sqrt(d/e)/a};Jmat.Real.cdf_fisher=function(a,b,c){return Jmat.Real.beta_i(b*a/(b*a+c),.5*b,.5*c)};
Jmat.Real.qf_fisher=function(a,b,c){a=Jmat.Real.beta_i_inv(a,.5*b,.5*c);return c*a/(b*(1-a))};Jmat.Real.pdf_weibull=function(a,b,c){return c/b*Math.pow(a/b,c-1)*Math.exp(-Math.pow(a/b,c))};Jmat.Real.cdf_weibull=function(a,b,c){return 1-Math.exp(-Math.pow(a/b,c))};Jmat.Real.qf_weibull=function(a,b,c){return b*Math.pow(-Math.log(1-a),1/c)};Jmat.Real.pdf_exponential=function(a,b){return 0>a?0:b*Math.exp(-a*b)};Jmat.Real.cdf_exponential=function(a,b){return 0>a?0:1-Math.exp(-a*b)};
Jmat.Real.qf_exponential=function(a,b){return-Math.log(1-a)/b};Jmat.Real.pdf_laplace=function(a,b,c){return Math.exp(-Math.abs(a-b)/c)/(2*c)};Jmat.Real.cdf_laplace=function(a,b,c){return(1-Math.exp(-Math.abs(a-b)/c))*Math.sign(a-b)*.5+.5};Jmat.Real.qf_laplace=function(a,b,c){return b-c*Math.sign(a-.5)*Math.log(1-2*Math.abs(a-.5))};Jmat.Real.pmf_bernoulli=function(a,b){return 0==a?1-b:1==a?b:Math.pow(b,a)*Math.pow(1-b,1-a)};Jmat.Real.cdf_bernoulli=function(a,b){return 0>a?0:1<=a?1:1-b};
Jmat.Real.qf_bernoulli=function(a,b){return 0==a?0:1==a?1:0};Jmat.Real.pmf_binomial=function(a,b,c){return Jmat.Real.binomial(b,a)*Math.pow(c,a)*Math.pow(1-c,b-a)};Jmat.Real.cdf_binomial=function(a,b,c){return Jmat.Real.beta_i(1-c,b-a,a+1)};Jmat.Real.qf_binomial=function(a,b,c){if(0==c)return 0;if(1==c)return b;var d=Jmat.Real.rootfind_bisection(0,b+.1,function(d){return Jmat.Real.cdf_binomial(d,b,c)-a},100,1E-14);return Jmat.Real.round(d)};
Jmat.Real.pmf_poisson=function(a,b){var c=Math.pow(b,a);a=Jmat.Real.factorial(a);return c*Math.exp(-b)/a};Jmat.Real.cdf_poisson=function(a,b){return Jmat.Real.gamma_q(a+1,b)};Jmat.Real.qf_poisson=function(a,b){return Jmat.Real.gamma_q_inva(a,b)-1};Jmat.Real.tdist=function(a,b,c){return c*(1-Jmat.Real.cdf_studentt(Math.abs(a),b))};Jmat.Real.corr_to_pvalue=function(a,b){return 3>b?1:Jmat.Real.tdist(a*Math.sqrt((b-2)/(1-a*a)),b-2,2)};
Jmat.Real.linfit=function(a){for(var b=0,c=0,d=0,e=0,f=0;f<a.length;f++){var g=a[f][0],h=a[f][1];b+=g;d+=g*g;c+=h;e+=g*h}a=a.length;d=a*d-b*b;e=a*e-b*c;return[(d*c-e*b)/(a*d),e/d]};Jmat.BigInt=function(a,b,c){if(this instanceof Jmat.BigInt)this.a=a||[],this.radix=b||Jmat.BigInt.ARRAYBASE_,this.minus=c||!1;else return Jmat.BigInt.make(a,b,c)};Jmat.BigInt.ARRAYBASE_=32768;Jmat.BigInt.ARRAYBASE_BITS_=15;Jmat.BigInt.STRINGBASE_=10;
Jmat.BigInt.make=function(a,b,c){return void 0==a?new Jmat.BigInt(a,b,c):"number"==typeof a?Jmat.BigInt.fromInt(a,b):"string"==typeof a?Jmat.BigInt.parse(a,Jmat.BigInt.STRINGBASE_,b):void 0!=a.length?new Jmat.BigInt(a,b,c):void 0!=a.re?Jmat.BigInt.fromInt(a.re,b):void 0!=a.w?Jmat.BigInt.fromInt(a.w,b):b&&a.radix!=b?Jmat.BigInt.convertBase(a,b):Jmat.BigInt.copy(a)};
Jmat.BigInt.cast=function(a,b,c){return void 0==a?new Jmat.BigInt(void 0,b,c):void 0==a.a||b&&a.radix!=b?a.radix&&b?Jmat.BigInt.convertBase(a,b):Jmat.BigInt(a,b,c):a};Jmat.BigInt.copy=function(a){return new Jmat.BigInt(a.a.slice(0),a.radix,a.minus)};Jmat.BigInt.parse=function(a,b,c){b=b||Jmat.BigInt.STRINGBASE_;c=c||Jmat.BigInt.ARRAYBASE_;var d=!1;"-"==a[0]&&(d=!0,a=a.substr(1));a=Jmat.BigInt.stringToArray(a,c,b);return new Jmat.BigInt(a,c,d)};
Jmat.BigInt.toString=function(a,b){return a&&a.a?(a.minus?"-":"")+Jmat.BigInt.arrayToString(a.a,a.radix,b):"invalid"};Jmat.BigInt.prototype.toString=function(a){return Jmat.BigInt.toString(this,a)};Jmat.BigInt.stringToArray=function(a,b,c){b=b||Jmat.BigInt.ARRAYBASE_;c=c||Jmat.BigInt.STRINGBASE_;for(var d=[],e=0;e<a.length;e++){var f=Jmat.BigInt.di_(a[e]);d[e]=f}return Jmat.BigInt.convertArrayBase(d,c,b)};
Jmat.BigInt.arrayToString=function(a,b,c){a=Jmat.BigInt.convertArrayBase(a,b||Jmat.BigInt.ARRAYBASE_,c||Jmat.BigInt.STRINGBASE_);b="";for(c=0;c<a.length;c++)b+=Jmat.BigInt.d_[a[c]];0==a.length&&(b="0");return b};Jmat.BigInt.getInBaseTwoWithoutConvert_=function(a){for(var b=[];0<a;)b.push(a&1),a>>=1;Jmat.BigInt.mirror_(b);return new Jmat.BigInt(b,2)};
Jmat.BigInt.convertArrayBase=function(a,b,c,d){if(8<a.length&&10==c&&Jmat.Real.isPOT(b))return d=Jmat.BigInt.convertArrayBase(a,b,1E8),Jmat.BigInt.convertArrayBase(d,1E8,10);var e=Jmat.Real,f=Jmat.BigInt;if(b==c)return a;var g=[];a=f.maybecopystrip_(a);if(2147483648>=b&&2147483648>=c&&e.isPOT(b)&&e.isPOT(c)){var h=e.ilog2(b);e=e.ilog2(c);d=Math.ceil(a.length*h/e);for(var k=0;k<d;k++)g[k]=0;if(b<c)for(b=d-1,c=0,k=a.length-1;0<=k;k--)c+h>e?(d=e-c,0!=d&&(g[b]|=(a[k]&(1<<d)-1)<<c),b--,g[b]=a[k]>>d,c=
h-d):(g[b]|=a[k]<<c,c+=h);else{var l=c-1;b=a.length-1;c=0;for(k=d-1;0<=k;k--)c+e>h?(d=h-c,g[k]=a[b]>>c,b--,g[k]|=(a[b]&l)<<d,c=e-d):(g[k]|=a[b]>>c&l,c+=e)}f.stripInPlace_(g);return g}if(h=e.isPowerOf(b,c)){for(k=0;k<a.length;k++){e=a[k];for(d=0;d<h;d++)g.push(Math.floor(e/(h-d-1))%c);for(d=h-1;0<=d;d--)g[k*h+d]=e%c,e=Math.floor(e/c)}f.stripInPlace_(g);return g}if(h=e.isPowerOf(c,b)){c=Math.ceil(a.length/h);for(k=0;k<c;k++)for(e=1,d=g[c-1-k]=0;d<h;d++){l=a.length-1-k*h-d;if(0>l)break;g[c-1-k]+=a[l]*
e;e*=b}f.stripInPlace_(g);return g}if(8<a.length){h=e.idiv(a.length,2);g=[];l=[];for(k=0;k<h;k++)g[k]=a[k];for(k=h;k<a.length;k++)l[k-h]=a[k];k=d||[];g=f.convertArrayBase(g,b,c,k);d=f.convertArrayBase(l,b,c,k);a=a.length-h;h=k[a];if(!h){h=e.idiv(a,2);e=a-h;l=k[h];var m=k[e];h=l&&m?l.mul(m):l?l.mul(f.pow(f(b,c),f.getInBaseTwoWithoutConvert_(e))):m?m.mul(f.pow(f(b,c),f.getInBaseTwoWithoutConvert_(h))):f.pow(f(b,c),f.getInBaseTwoWithoutConvert_(a))}k[a]=h;return f(d,c).add(f(g,c).mul(h)).a}for(k=0;k<
a.length;k++)g=f.baseloop_(g,0,b,[],0,1,a[k],c,!1);0==g.length&&(g=[0]);return g};Jmat.BigInt.convertStringBase=function(a,b,c){if(b==c)return a;a=Jmat.BigInt.stringToArray(a,c,b);return Jmat.BigInt.arrayToString(a,c,c)};
Jmat.BigInt.baseloop_=function(a,b,c,d,e,f,g,h,k){var l=[],m=Math.max(a.length+b,d.length+e),n=a.length;if(d.length||b)if(0==b&&0==e&&1==c&&1==f)for(p=0;p<m;p++)p<a.length&&(g+=a[a.length-p-1]),p<d.length&&(g+=d[d.length-p-1]),l[p]=(g+h)%h,g=Math.floor(g/h);else for(p=0;p<m;p++)p>=b&&p<a.length+b&&(g+=c*a[a.length-p-1+b]),p>=e&&p<d.length+e&&(g+=f*d[d.length-p-1+e]),l[p]=(g+h)%h,g=Math.floor(g/h);else for(var p=0;p<m;p++)g+=c*a[a.length-p-1],l[p]=(g+h)%h,g=Math.floor(g/h);if(Infinity==g)throw"infinite overflow";
for(;0<g;)l.push((g+h)%h),g=Math.floor(g/h);if(k){for(;l.length>n&&0==l[l.length-1];)l.length--;for(;l.length<n;)l.push(0)}else for(;1<l.length&&0==l[l.length-1];)l.length--;Jmat.BigInt.mirror_(l);return l};Jmat.BigInt.intToArray=function(a,b){if(a>Jmat.Real.BIGGESTJSINT)throw"too large integer literal for JS";b=b||Jmat.BigInt.ARRAYBASE_;for(var c=[];0<a;)c.push(a%b),a=Math.floor(a/b);0==c.length&&(c=[0]);1<c.length&&Jmat.BigInt.mirror_(c);return c};
Jmat.BigInt.arrayToInt=function(a,b){b=b||Jmat.BigInt.ARRAYBASE_;for(var c=0,d=1,e=0;e<a.length;e++)if(c+=d*a[a.length-1-e],d*=b,Infinity==c||Infinity==d)return Infinity;return c};Jmat.BigInt.fromInt=function(a,b){b=b||Jmat.BigInt.ARRAYBASE_;var c=!1;0>a&&(c=!0,a=-a);return new Jmat.BigInt(Jmat.BigInt.intToArray(a,b),b,c)};Jmat.BigInt.toInt=function(a){return Jmat.BigInt.arrayToInt(a.a,a.radix)*(a.minus?-1:1)};
Jmat.BigInt.prototype.toInt=function(){return Jmat.BigInt.arrayToInt(this.a,this.radix)*(this.minus?-1:1)};Jmat.BigInt.ZERO=Jmat.BigInt(0);Jmat.BigInt.ONE=Jmat.BigInt(1);Jmat.BigInt.TWO=Jmat.BigInt(2);Jmat.BigInt.convertBase=function(a,b){return a.radix==b?a:new Jmat.BigInt(Jmat.BigInt.convertArrayBase(a.a,a.radix,b),b,a.minus)};Jmat.BigInt.cloneArray=function(a){return a.slice(0)};Jmat.BigInt.cloneArrayTo=function(a,b){b.length=a.length;for(var c=0;c<a.length;c++)b[c]=a[c]};
Jmat.BigInt.lshift_radix=function(a,b){if(0==b)return a;if(0>b)return Jmat.BigInt.rshift_radix(a,-b);a=Jmat.BigInt.copy(a);for(var c=0;c<b;c++)a.a.push(0);return a};Jmat.BigInt.prototype.lshift_radix=function(a){return Jmat.BigInt.lshift_radix(this,a)};Jmat.BigInt.rshift_radix=function(a,b){if(0==b)return a;if(0>b)return Jmat.BigInt.lshift_radix(a,-b);a=Jmat.BigInt.copy(a);a.a=a.a.slice(0,-b);return a};Jmat.BigInt.prototype.rshift_radix=function(a){return Jmat.BigInt.rshift_radix(this,a)};
Jmat.BigInt.lshift=function(a,b){var c=Jmat.BigInt;if(0==b)return a;if(0>b)return c.rshift(a,-b);a=c.cast(a,Jmat.BigInt.ARRAYBASE_);var d=new c([],a.radix),e=Math.floor(b/c.ARRAYBASE_BITS_);b%=c.ARRAYBASE_BITS_;if(0==b){for(var f=0;f<a.a.length;f++)d.a[f]=a.a[f];for(f=0;f<e;f++)d.a.push(0)}else{d.a=[];var g=(1<<c.ARRAYBASE_BITS_-b)-1<<b,h=(1<<b)-1;for(f=0;f<=a.a.length;f++){var k=(0<f?a.a[f-1]:0)<<b&g|(f<a.a.length?a.a[f]:0)<<b>>c.ARRAYBASE_BITS_&h;(k||d.a.length)&&d.a.push(k)}for(f=0;f<e;f++)d.a.push(0);
0==d.a.length&&(d.a=[0])}a.minus&&(d=d.neg());return d};Jmat.BigInt.prototype.lshift=function(a){return Jmat.BigInt.lshift(this,a)};
Jmat.BigInt.rshift=function(a,b){var c=Jmat.BigInt;if(0==b)return a;if(0>b)return c.lshift(a,-b);a=c.cast(a,Jmat.BigInt.ARRAYBASE_);var d=new c([],a.radix),e=Math.floor(b/c.ARRAYBASE_BITS_);b%=c.ARRAYBASE_BITS_;if(0==b){d.a=[];for(var f=0;f<a.a.length-e;f++)d.a.push(a.a[f])}else{d.a=[];var g=(1<<b)-1<<c.ARRAYBASE_BITS_-b,h=(1<<c.ARRAYBASE_BITS_-b)-1;for(f=0;f<a.a.length-e;f++)d.a.push((0<f?a.a[f-1]:0)<<c.ARRAYBASE_BITS_>>b&g|(f<a.a.length?a.a[f]:0)>>b&h)}0==d.a.length&&(d.a=[0]);a.minus&&(d=d.neg());
c.stripInPlace_(d.a);return d};Jmat.BigInt.prototype.rshift=function(a){return Jmat.BigInt.rshift(this,a)};Jmat.BigInt.bitand=function(a,b){var c=Jmat.BigInt;a=c.cast(a,c.ARRAYBASE_);b=c.cast(b,c.ARRAYBASE_);if(a.minus||b.minus){var d=Math.max(c.getNumBits(a),c.getNumBits(b));a.minus&&(a=a.addr(1).bitnot(d));b.minus&&(b=b.addr(1).bitnot(d))}c=new c([],c.ARRAYBASE_);d=Math.min(a.a.length,b.a.length);for(var e=0;e<d;e++)c.a[d-1-e]=(a.a[a.a.length-1-e]||0)&(b.a[b.a.length-1-e]||0);return c};
Jmat.BigInt.prototype.bitand=function(a){return Jmat.BigInt.bitand(this,a)};Jmat.BigInt.bitandr=function(a,b){var c=Jmat.BigInt;if(a.minus)return c.bitand(a,c(b)).toInt();a=c.cast(a,b<c.ARRAYBASE_?c.ARRAYBASE_:2147483648);return a.a[a.a.length-1]&b};
Jmat.BigInt.bitor=function(a,b){var c=Jmat.BigInt;a=c.cast(a,c.ARRAYBASE_);b=c.cast(b,c.ARRAYBASE_);if(a.minus||b.minus){var d=Math.max(c.getNumBits(a),c.getNumBits(b));a.minus&&(a=a.addr(1).bitnot(d));b.minus&&(b=b.addr(1).bitnot(d))}c=new c([],c.ARRAYBASE_);d=Math.max(a.a.length,b.a.length);for(var e=0;e<d;e++)c.a[d-1-e]=(a.a[a.a.length-1-e]||0)|(b.a[b.a.length-1-e]||0);return c};Jmat.BigInt.prototype.bitor=function(a){return Jmat.BigInt.bitor(this,a)};
Jmat.BigInt.bitxor=function(a,b){var c=Jmat.BigInt;a=c.cast(a,c.ARRAYBASE_);b=c.cast(b,c.ARRAYBASE_);if(a.minus||b.minus){var d=Math.max(c.getNumBits(a),c.getNumBits(b));a.minus&&(a=a.addr(1).bitnot(d));b.minus&&(b=b.addr(1).bitnot(d))}c=new c([],c.ARRAYBASE_);d=Math.max(a.a.length,b.a.length);for(var e=0;e<d;e++)c.a[d-1-e]=(a.a[a.a.length-1-e]||0)^(b.a[b.a.length-1-e]||0);return c};Jmat.BigInt.prototype.bitxor=function(a){return Jmat.BigInt.bitxor(this,a)};
Jmat.BigInt.bitneg=function(a){a=Jmat.BigInt.cast(a,Jmat.BigInt.ARRAYBASE_);a=a.addr(1);return a=a.neg()};Jmat.BigInt.prototype.bitneg=function(){return Jmat.BigInt.bitneg(this)};
Jmat.BigInt.bitnot=function(a,b){if(0>=b)return a;var c=Jmat.BigInt;a=c.cast(a,c.ARRAYBASE_);var d=c.maybecopystrip_(a.a),e=c.ARRAYBASE_-1;if(void 0!=b){var f=c(0);var g=b%c.ARRAYBASE_BITS_;c=Math.ceil(b/c.ARRAYBASE_BITS_);b=(1<<g)-1;for(var h=0;h<c;h++)f.a[h]=(d[d.length-c+h]||0)^e,0==h&&0!=g&&(f.a[h]&=b)}else{if(!d.length)return a;g=Jmat.Real.ilog2(d[0])+1;if(0==g)for(f=c(1),h=0;h<d.length;h++)f.a.push(d[h]^e);else for(b=(2<<g)-1,f=c(0),f.a[0]=(d[0]^e)&b,h=1;h<d.length;h++)f.a[h]=d[h]^e}f.minus=
a.minus;return f};Jmat.BigInt.prototype.bitnot=function(a){return Jmat.BigInt.bitnot(this,a)};Jmat.BigInt.abs=function(a){return a.abs()};Jmat.BigInt.prototype.abs=function(){return this.minus?new Jmat.BigInt(this.a,this.radix,!1):this};Jmat.BigInt.dist=function(a,b){return a.sub(b).abs()};Jmat.BigInt.cheb=function(a,b){return Jmat.BigInt.dist(a,b)};Jmat.BigInt.manhattan=function(a,b){return Jmat.BigInt.dist(a,b)};Jmat.BigInt.neg=function(a){return a.neg()};
Jmat.BigInt.prototype.neg=function(){return new Jmat.BigInt(this.a,this.radix,!this.minus)};Jmat.BigInt.getSign=function(a){return a.getSign()};Jmat.BigInt.prototype.getSign=function(){return this.minus?-1:1};Jmat.BigInt.nonZero=function(a){return a.nonZero()};Jmat.BigInt.prototype.nonZero=function(){for(var a=0;a<this.a.length;a++)if(this.a[a])return!0;return!1};Jmat.BigInt.sign=function(a){return a.sign()};Jmat.BigInt.prototype.sign=function(){return this.nonZero()?this.getSign():0};
Jmat.BigInt.add=function(a,b){return a.add(b)};Jmat.BigInt.prototype.add=function(a){if(this.minus!=a.minus)return this.sub(a.neg());a=Jmat.BigInt.cast(a,this.radix);return new Jmat.BigInt(Jmat.BigInt.baseloop_(this.a,0,1,a.a,0,1,0,this.radix,!1),this.radix,this.minus)};Jmat.BigInt.addr=function(a,b){return a.addr(b)};Jmat.BigInt.prototype.addr=function(a){return this.add(Jmat.BigInt.fromInt(a))};Jmat.BigInt.sub=function(a,b){return a.sub(b)};
Jmat.BigInt.prototype.sub=function(a){if(this.minus!=a.minus)return this.add(a.neg());a=Jmat.BigInt.cast(a,this.radix);return this.abs().gte(a.abs())?new Jmat.BigInt(Jmat.BigInt.baseloop_(this.a,0,1,a.a,0,-1,0,this.radix,!1),this.radix,this.minus):new Jmat.BigInt(Jmat.BigInt.baseloop_(a.a,0,1,this.a,0,-1,0,this.radix,!1),this.radix,!this.minus)};Jmat.BigInt.subr=function(a,b){return a.subr(b)};Jmat.BigInt.prototype.subr=function(a){return this.sub(Jmat.BigInt.fromInt(a))};
Jmat.BigInt.rsub=function(a,b){return a.rsub(b)};Jmat.BigInt.prototype.rsub=function(a){return this.subr(a).neg()};Jmat.BigInt.mul=function(a,b){return a.mul(b)};Jmat.BigInt.prototype.mul=function(a){a=Jmat.BigInt.cast(a,this.radix);var b=Jmat.BigInt.karatsuba_(this.strip().a,a.strip().a,this.radix);return new Jmat.BigInt(b,this.radix,this.minus!=a.minus)};Jmat.BigInt.mulr=function(a,b){var c=new Jmat.BigInt([],a.radix,a.minus!=0>b);c.a=Jmat.BigInt.baseloop_(a.a,0,b,[],0,1,0,c.radix,!1);return c};
Jmat.BigInt.prototype.mulr=function(a){var b=new Jmat.BigInt([],this.radix,this.minus!=0>a);b.a=Jmat.BigInt.baseloop_(this.a,0,a,[],0,1,0,b.radix,!1);return b};
Jmat.BigInt.karatsuba_=function(a,b,c){if(1>=a.length||1>=b.length)return Jmat.BigInt.schoolmul_(a,b,c);if(a.length<b.length)return Jmat.BigInt.karatsuba_(b,a,c);if(20>=a.length)return Jmat.BigInt.schoolmul_(a,b,c);var d=Math.floor(a.length/2),e=b.length-(a.length-d),f=a.slice(0,d),g=a.slice(d,a.length),h=0>=e?[0]:b.slice(0,e);b=0>=e?b:b.slice(e,b.length);if(0>=e)return f=Jmat.BigInt.karatsuba_(f,b,c),g=Jmat.BigInt.karatsuba_(g,b,c),Jmat.BigInt.baseloop_(f,a.length-d,1,g,0,1,0,c,!1);e=Jmat.BigInt.baseloop_(f,
0,1,g,0,1,0,c,!1);var k=Jmat.BigInt.baseloop_(h,0,1,b,0,1,0,c,!1);f=Jmat.BigInt.karatsuba_(f,h,c);g=Jmat.BigInt.karatsuba_(g,b,c);h=Jmat.BigInt.karatsuba_(e,k,c);b=Jmat.BigInt.baseloop_(f,0,1,g,0,1,0,c,!1);h=Jmat.BigInt.baseloop_(h,0,1,b,0,-1,0,c,!1);d=a.length-d;a=2*d;d=Jmat.BigInt.baseloop_(h,d,1,g,0,1,0,c,!1);return Jmat.BigInt.baseloop_(f,a,1,d,0,1,0,c,!1)};
Jmat.BigInt.schoolmul_=function(a,b,c){if(1==a.length&&0==a[0])return[0];if(1==a.length&&1==a[0])return b;if(1==b.length&&0==b[0])return[0];if(1==b.length&&1==b[0])return a;if(a.length<b.length)return Jmat.BigInt.schoolmul_(b,a,c);for(var d=[0],e=0,f=0;f<b.length;f++)d=Jmat.BigInt.baseloop_(a,e,b[b.length-f-1],d,0,1,0,c,!1),e++;return d};Jmat.BigInt.compare=function(a,b){return a.compare(b)};
Jmat.BigInt.prototype.compare=function(a){if(a.minus!=this.minus){var b=this.sign();a=a.sign();return b==a?0:b<a?-1:1}a.radix!=this.radix&&(a=Jmat.BigInt.convertBase(a,this.radix));b=Math.max(this.a.length,a.a.length);for(var c=0;c<b;c++){var d=this.a[c-b+this.a.length]||0,e=a.a[c-b+a.a.length]||0;if(d<e)return-1*this.getSign();if(d>e)return 1*this.getSign()}return 0};Jmat.BigInt.comparer=function(a,b){return a.comparer(b)};
Jmat.BigInt.prototype.comparer=function(a){if(0>a!=this.minus){var b=this.sign();a=Math.sign(a);return b==a?0:b<a?-1:1}b=this.getSign();a=Math.abs(a);for(var c=0,d=0;d<this.a.length&&c<=a;d++)c*=this.radix,c+=this.a[d];return(c<a?-1:c==a?0:1)*b};Jmat.BigInt.eq=function(a,b){return 0==Jmat.BigInt.compare(a,b)};Jmat.BigInt.prototype.eq=function(a){return 0==Jmat.BigInt.compare(this,a)};Jmat.BigInt.eqr=function(a,b){return 0==Jmat.BigInt.comparer(a,b)};
Jmat.BigInt.prototype.eqr=function(a){return 0==Jmat.BigInt.comparer(this,a)};Jmat.BigInt.neq=function(a,b){return 0!=Jmat.BigInt.compare(a,b)};Jmat.BigInt.prototype.neq=function(a){return 0!=Jmat.BigInt.compare(this,a)};Jmat.BigInt.neqr=function(a,b){return 0!=Jmat.BigInt.comparer(a,b)};Jmat.BigInt.prototype.neqr=function(a){return 0!=Jmat.BigInt.comparer(this,a)};Jmat.BigInt.gt=function(a,b){return 0<Jmat.BigInt.compare(a,b)};
Jmat.BigInt.prototype.gt=function(a){return 0<Jmat.BigInt.compare(this,a)};Jmat.BigInt.gtr=function(a,b){return 0<Jmat.BigInt.comparer(a,b)};Jmat.BigInt.prototype.gtr=function(a){return 0<Jmat.BigInt.comparer(this,a)};Jmat.BigInt.lt=function(a,b){return 0>Jmat.BigInt.compare(a,b)};Jmat.BigInt.prototype.lt=function(a){return 0>Jmat.BigInt.compare(this,a)};Jmat.BigInt.ltr=function(a,b){return 0>Jmat.BigInt.comparer(a,b)};Jmat.BigInt.prototype.ltr=function(a){return 0>Jmat.BigInt.comparer(this,a)};
Jmat.BigInt.gte=function(a,b){return 0<=Jmat.BigInt.compare(a,b)};Jmat.BigInt.prototype.gte=function(a){return 0<=Jmat.BigInt.compare(this,a)};Jmat.BigInt.gter=function(a,b){return 0<=Jmat.BigInt.comparer(a,b)};Jmat.BigInt.prototype.gter=function(a){return 0<=Jmat.BigInt.comparer(this,a)};Jmat.BigInt.lte=function(a,b){return 0>=Jmat.BigInt.compare(a,b)};Jmat.BigInt.prototype.lte=function(a){return 0>=Jmat.BigInt.compare(this,a)};Jmat.BigInt.lter=function(a,b){return 0>=Jmat.BigInt.comparer(a,b)};
Jmat.BigInt.prototype.lter=function(a){return 0>=Jmat.BigInt.comparer(this,a)};
Jmat.BigInt.sqrt=function(a){var b=Jmat.BigInt;if(a.eqr(0))return b(0);if(!a.minus){var c=b([0],a.radix),d=Jmat.BigInt.copystrip_(a);1==d.a.length&&1==d.a[0]&&(c=b([1],a.radix));d.a=d.a.slice(0,Math.ceil(d.a.length/2)+1);16<a.radix&&(d.a[0]=Math.min(d.a[0],Math.ceil(Math.sqrt(d.a[0]+1))));for(var e=b([1],a.radix);;){var f=c.add(d).divr(2),g=f.mul(f);g=b.compare(g,a);if(0==g){a=f;break}else 0>g?c=f:d=f;if(0>=b.compare(d.sub(c),e)){a=c;break}}return a}};Jmat.BigInt.isOdd=function(a){return a.bitand(Jmat.BigInt.ONE).eqr(1)};
Jmat.BigInt.isEven=function(a){return a.bitand(Jmat.BigInt.ONE).eqr(0)};Jmat.BigInt.root=function(a,b){var c=Jmat.BigInt,d=b.toInt();if(!(0>=d))return d>Jmat.Real.BIGGESTJSINT?a.eqr(0)?c(0):c.isEven(b)&&a.minus?void 0:c(a.minus?-1:1):Jmat.BigInt.rootr(a,d)};
Jmat.BigInt.rootr=function(a,b){var c=Jmat.BigInt;if(!(0>=b)){if(a.eqr(0))return c(0);if(1==b)return a;if(2==b)return c.sqrt(a);if(!Jmat.Real.isEven(b)||!a.minus){if(b>c.log2(a.abs()).toInt())return c(a.minus?-1:1);var d=c([0],a.radix),e=Jmat.BigInt.copystrip_(a);1==e.a.length&&1==e.a[0]&&(d=c([1],a.radix));e.a=e.a.slice(0,Math.ceil(e.a.length/b)+1);16<a.radix&&(e.a[0]=Math.min(e.a[0],Math.ceil(Jmat.Real.root(e.a[0]+1,b))));for(var f=c([1],a.radix);;){var g=d.add(e).divr(2),h=c.powr(g,b);h=c.compare(h,
a);if(0==h){a=g;break}else 0>h?d=g:e=g;if(0>=c.compare(e.sub(d),f)){a=d;break}}return a}}};Jmat.BigInt.perfectsquare=function(a){var b=Jmat.BigInt;if(a.minus)return null;var c=b.bitandr(a,15);if(0!=c&&1!=c&&4!=c&&9!=c)return null;b=b.sqrt(a);return b.mul(b).eq(a)?b:null};
Jmat.BigInt.perfectpow=function(a,b,c,d){var e=Jmat.BigInt,f=d?e.cast(d):void 0,g=c?e.cast(c):void 0;if(!a.minus){if(c&&d)return[g.pow(f),g,f];if(c){if(a.lter(1)&&b)return[g.mul(g),g,e(2)];c="number"!=typeof c?c:g.toInt();f=e.logr(a,c);b&&(f=f.addr(1));c=g.pow(f);return[c,g,f]}if(d)return c="number"!=typeof d?d:f.toInt(),g=e.rootr(a,c),b&&(g=g.addr(1)),c=g.powr(c),[c,g,f];if(a.ltr(5))return c=a.toInt(),b?0==c?[e(1),e(1),e(2)]:4==c?[e(8),e(2),e(3)]:[e(4),e(2),e(2)]:0==c?void 0:4==a?[e(4),e(2),e(2)]:
[e(1),e(1),e(2)];f=e.log2(a).toInt();b&&f++;var h=a;d=0;for(var k=e(0),l=e(0),m=2;m<=f;m++)if(5<m&&0==m%5)m++;else if(3<m&&0==m%3)m++;else{g=e.rootr(a,m);g.eqr(2)&&(m=f);b&&(g=g.addr(1));c=g.powr(m);var n=a.sub(c).abs();if(n.lt(h)&&(h=n,d=m,k=g,l=c,n.eqr(0)))break;2<m&&m++}if(2==d||3==d||5==d)a=Jmat.BigInt.perfectpow(k),a[0].eq(k)&&(k=a[1],d*=a[2].toInt());return[l,k,e(d)]}};Jmat.PriorityQueue_=function(a){this.nodes=[];this.comparefun=a};
Jmat.PriorityQueue_.prototype.push=function(a){this.nodes.push(a);for(a=this.size()-1;0<a&&this.comparefun(this.nodes[a],this.nodes[this.getParent(a)]);)this.swap(a,this.getParent(a)),a=this.getParent(a)};
Jmat.PriorityQueue_.prototype.pop=function(){var a=this.nodes[0];this.nodes[0]=this.nodes[this.size()-1];this.nodes.pop();for(var b=0,c=this.size()>>1;b<c;){var d=this.getLeft(b),e=this.getRight(b);d=e<this.size()&&this.comparefun(this.nodes[e],this.nodes[d])?e:d;if(!this.comparefun(this.nodes[d],this.nodes[b]))break;this.swap(b,d);b=d}return a};Jmat.PriorityQueue_.prototype.size=function(){return this.nodes.length};Jmat.PriorityQueue_.prototype.getParent=function(a){return(a+1>>1)-1};
Jmat.PriorityQueue_.prototype.getLeft=function(a){return(a<<1)+1};Jmat.PriorityQueue_.prototype.getRight=function(a){return a+1<<1};Jmat.PriorityQueue_.prototype.swap=function(a,b){var c=this.nodes[a];this.nodes[a]=this.nodes[b];this.nodes[b]=c};
Jmat.BigInt.mulmany_=function(a){if(0==a.length)return Jmat.BigInt.ONE;for(var b=new Jmat.PriorityQueue_(function(a,b){return a.a.length==b.a.length?a.a[0]<b.a[0]:a.a.length<b.a.length}),c=0;c<a.length;c++)b.push(a[c]);for(;2<=b.size();)a=b.pop(),c=b.pop(),a=a.mul(c),b.push(a);return b.pop()};
Jmat.BigInt.factorial=function(a){var b=Jmat.BigInt;a=a.toInt();if(Infinity!=a){if(19>a)return b(Jmat.Real.factorial(a));for(var c=Jmat.Real.eratosthenes(a),d=[],e=0;e<c.length;e++){for(var f=c[e],g=Math.floor(a/f),h=0;0<g;)h+=g,g=Math.floor(g/f);d[e]=b.powr(b(f),h)}return b.mulmany_(d)}};Jmat.BigInt.primorial=function(a){var b=Jmat.BigInt;a=a.toInt();if(Infinity!=a){a=Jmat.Real.eratosthenes(a);for(var c=0;c<a.length;c++)a[c]=b(a[c]);return b.mulmany_(a)}};
Jmat.BigInt.nearestPrime=function(a){var b=Jmat.BigInt;if(a.lter(2))return b(2);if(a.lter(4))return b(3);var c=b.previousPrime(a);c=a.sub(c);return b.previousPrime(a.add(c).subr(1))};Jmat.BigInt.nextPrime=function(a){var b=Jmat.BigInt;if(a.ltr(2))return b(2);if(a.ltr(3))return b(3);var c=a.modr(6).toInt(),d=2;0==c||5==c?(a=a.addr(0==c?1:2),d=4):a=a.addr(5-c);for(;;){if(b.isPrime(a))return a;a=a.addr(d);d^=6}};
Jmat.BigInt.previousPrime=function(a){var b=Jmat.BigInt;if(a.lter(7))return a.lter(2)?void 0:a.lter(3)?b(2):a.lter(5)?b(3):b(5);var c=a.modr(6).toInt(),d=2;0==c||1==c?(a=a.subr(c+1),d=4):a=a.subr(c-1);for(;;){if(b.isPrime(a))return a;a=a.subr(d);d^=6}};Jmat.BigInt.min=function(a,b){return a.lt(b)?a:b};Jmat.BigInt.max=function(a,b){return a.gt(b)?a:b};Jmat.BigInt.primeCache_=[];
Jmat.BigInt.qs_sieve_=function(a,b,c,d,e,f){var g=Jmat.BigInt,h=c.sub(b).toInt();c=[];for(var k=0;k<h;k++)c[k]=0;for(k=1;k<d.length;k++){var l=d[k];if(!(4>l))for(var m=Math.log(l),n=-b.modr(l).toInt();n<h;){var p=n+e[k],q=n+(l-e[k]);0<=p&&p<h&&(c[p]+=m);0!=e[k]&&0<=q&&q<h&&(c[q]+=m);n+=l}}e=[[],[],[]];for(k=0;k<c.length;k++)if(h=b.addr(k),l=h.mul(h).sub(a),m=g.rlog(l.abs()),c[k]>=.95*m-10){m=l;n=[];m.minus&&(n.push(-1),m=m.abs());for(p=1;p<d.length&&!m.eqr(0);p++)for(;m.modr(d[p]).eqr(0);)m=m.divr(d[p]),
n.push(d[p]);if(m=m.eqr(1)?n:null)if(e[0].push(l),e[1].push(h),e[2].push(m),e[0].length>=f)break}return e};
Jmat.BigInt.qs_rref_=function(a){for(var b=a.length,c=a[0].length,d=function(a,b,c){var d=a[b];a[b]=a[c];a[c]=d},e=function(a,b,c,d){for(var e=a[0].length;b<e;b++)a[d][b]^=a[c][b]},f=[],g=0,h=0;h<c;h++){var k=Jmat.Real.argmax(g,b,function(b){return a[b][h]});if(0!=a[k][h]){g!=k&&d(a,g,k);for(k=g+1;k<b;k++)0!=a[k][h]&&e(a,h,g,k);f.push(h);g++;if(g>=b)break}}for(h=0;h<f.length;h++)for(b=f[h],c=h-1;0<=c;c--)0!=a[c][b]&&e(a,b,h,c)};
Jmat.BigInt.qs_solve_=function(a,b){var c=a.length,d=a[0].length;b=b||1;for(var e=[],f=0;f<d;f++)e[f]=-1;for(--c;0<=c;c--){for(var g=0;g<d&&0==a[c][g];)g++;if(g!=d){var h=0;for(f=g+1;f<d;f++)a[c][f]&&(-1==e[f]&&(e[f]=b&1,b>>=1),1==e[f]&&(h^=1));e[g]=h}}if(0!=b)return null;a=[];for(b=0;b<e.length;b++)0<e[b]&&a.push(b);return a};
Jmat.BigInt.qsieve_=function(a,b){var c=Jmat.BigInt,d=function(a,b){b=b||2;for(a=""+a;a.length<b;)a="0"+a;return a},e=function(a){return d(a.getHours())+":"+d(a.getMinutes())+":"+d(a.getSeconds())+"."+d(a.getMilliseconds(),3)},f=function(a){b&&console.log("["+e(new Date)+"]: "+a)},g=c.rlog10(a),h=Math.floor(50*g*g),k=c.sqrt(a),l=[-1].concat(Real.eratosthenes(h));if(6E3<l.length)return null;for(var m=[0],n=[-1],p=1;p<l.length;p++){g=c.legendre(a,c(l[p]));if(0==g)return c(l[p]);if(1==g&&(n.push(l[p]),
m.push(c.ressol(a,c(l[p])).toInt()),3E3<n.length))break}p=n.length+1;var q=999*p;f("input: "+a+", smoothness bound: "+h+", num primes: "+l.length+", num filtered primes: "+n.length+", sieving for "+p+" smooth numbers in batches of "+q);l=n;var t=k.subr(q);h=[];n=[];for(g=[];h.length<p;)k=c.qs_sieve_(a,t,t.addr(q),l,m,p-h.length),t=t.addr(q),h=h.concat(k[0]),n=n.concat(k[1]),g=g.concat(k[2]),f("found "+k[0].length+" for this batch, "+h.length+" total");f("sieving done, found "+h.length+" smooth numbers");
m={};for(p=0;p<l.length;p++)m[l[p]]=p;q=[];for(var v=0;v<l.length;v++)q.push([]);for(p=0;p<h.length;p++){for(v=0;v<l.length;v++)q[v][p]=0;var y=g[p];for(v=0;v<y.length;v++)q[m[y[v]]][p]^=1}f("performing gaussian elemination...");c.qs_rref_(q);f("gaussian elemination done. Matrix size: "+q.length+"x"+q[0].length);for(t=0;20>t;t++){f("solving...");var x=c.qs_solve_(q,t);if(!x||!x.length)break;var w=[],z=[];k=[];for(p=0;p<x.length;p++){z.push(h[x[p]]);w.push(n[x[p]]);y=g[x[p]];var A=[];for(v=0;v<l.length;v++)A[v]=
0;for(v=0;v<y.length;v++)A[m[y[v]]]++;for(v=0;v<A.length;v++)k[v]=(k[v]||0)+A[v]}v=c.mulmany_(w);for(p=0;p<k.length;p++)k[p]>>=1;y=[];for(p=0;p<k.length;p++)0!=k[p]&&y.push(c.pow(c(l[p]),c(k[p])));k=c.mulmany_(y);p=c.gcd(a,v.sub(k));f("gcd: "+p);if(!p.eqr(1)&&!p.eq(a))return p}return null};
Jmat.BigInt.factorize=function(a){var b=Jmat.BigInt,c=[];a.minus&&(a=b.neg(a),c.push(b(-1)));if(a.lter(2))return 0!=c.length&&a.eqr(1)||c.push(a),c;if(a.ltr(Jmat.Real.BIGGESTJSINT)){a=Jmat.Real.factorize(a);for(var d=0;d<a.length;d++)c.push(b(a[d]));return c}for(var e=function(a){if(!(a.a[a.a.length-1]&1))return b(2);if(a.modr(3).eqr(0))return b(3);if(a.modr(5).eqr(0))return b(5);if(a.modr(7).eqr(0))return b(7);if(a.modr(11).eqr(0))return b(11);if(a.modr(13).eqr(0))return b(13);if(b.isPrime(a))return a;
for(var c=Math.min(5E4,b.sqrt(a).toInt()),d=1,f=0;;)if(f>=b.primeCache_.length&&(b.primeCache_[f]=Jmat.Real.nextPrime(d)),d=b.primeCache_[f],f++,!(13>=d)){if(d!=d||d>c)break;if(a.modr(d).eqr(0))return b(d)}c=b.perfectpow(a);return c[0].eq(a)&&c[1].lt(a)?e(c[1]):(a=b.qsieve_(a))?e(a):b(0)};;){d=e(a);if(d.eqr(0))return c.sort(function(a,c){return b.compare(a,c)}),c.push(b(0)),c;c.push(d);if(d.eqr(a))return c.sort(function(a,c){return b.compare(a,c)}),c;a=a.div(d)}};
Jmat.BigInt.legendre=function(a,b){return Jmat.BigInt.modpow(a,b.subr(1).divr(2),b)};
Jmat.BigInt.ressol=function(a,b){var c=Jmat.BigInt;if(b.eqr(2))return c(0);if(b.lter(2))return null;a=a.mod(b);for(var d=b.subr(1),e=0;0==c.bitandr(d,1);)d=d.divr(2),e++;if(1==e){var f=c.modpow(a,b.addr(1).divr(4),b);return f.mul(f).mod(b).neq(a)?c(0):f}for(f=c(1);f=f.addr(1),!c.legendre(f,b).gtr(1););var g=c.modpow(f,d,b);f=c.modpow(a,d.addr(1).divr(2),b);d=c.modpow(a,d,b);for(var h=e;!d.eqr(1);){e=d;for(var k=0;!e.eqr(1);)if(e=e.mul(e).mod(b),k++,k==h)return 0;g=c.modpow(g,c.modpow(c(2),c(h-k-1),
b.subr(1)),b);e=g.mul(g).mod(b);f=f.mul(g).mod(b);d=d.mul(e).mod(b);g=e;h=k}return f.mul(f).mod(b).neq(a)?c(0):f};Jmat.BigInt.logy=function(a,b){return Jmat.BigInt.logr(a,b.toInt())};Jmat.BigInt.logr=function(a,b){if(a.eqr(b))return Jmat.BigInt(1);if(!(a.minus||0>b||a.eqr(0))){if(1==b)return a;if(2==b)return Jmat.BigInt.log2(a);b=Jmat.BigInt.convertBase(a,b);return Jmat.BigInt.fromInt(Jmat.BigInt.getNumDigits(b)-1,a.radix)}};
Jmat.BigInt.log2=function(a){if(!a.minus&&(a=Jmat.BigInt.getNumBits(a),0!=a))return Jmat.BigInt.fromInt(a-1)};Jmat.BigInt.log10=function(a){return Jmat.BigInt.logr(a,10)};Jmat.BigInt.rlog2=function(a){var b=Jmat.BigInt.getNumBits(a);return 128<b?(a=Jmat.BigInt.rshift(a,b-128),Jmat.Real.log2(a.toInt())+b-128):Jmat.Real.log2(a.toInt())};Jmat.BigInt.rlog=function(a){return Jmat.BigInt.rlog2(a)*Math.LN2};Jmat.BigInt.rlog10=function(a){return Jmat.BigInt.rlog2(a)/3.321928094887362};
Jmat.BigInt.div=function(a,b){return a.div(b)};Jmat.BigInt.prototype.div=function(a){a.radix!=this.radix&&(a=Jmat.BigInt.convertBase(a,this.radix));return Jmat.BigInt.divmod_(this,a)[0]};Jmat.BigInt.mod=function(a,b){return a.mod(b)};Jmat.BigInt.prototype.mod=function(a){a.radix!=this.radix&&(a=Jmat.BigInt.convertBase(a,this.radix));return Jmat.BigInt.divmod_(this,a)[1]};Jmat.BigInt.divmod=function(a,b){return a.divmod(b)};
Jmat.BigInt.prototype.divmod=function(a){a.radix!=this.radix&&(a=Jmat.BigInt.convertBase(a,this.radix));return a.abs().ltr(65536)?Jmat.BigInt.divsmall_(this,a.toInt()):Jmat.BigInt.divmod_(this,a)};Jmat.BigInt.divr=function(a,b){if(0!=b)return 1==b?a:-1==b?a.neg():a.abs().ltr(Math.abs(b))?Jmat.BigInt(0):a.eqr(b)?Jmat.BigInt(1):65536>Math.abs(b)?Jmat.BigInt.divsmall_(a,b)[0]:Jmat.BigInt.div(a,Jmat.BigInt(b))};Jmat.BigInt.prototype.divr=function(a){return Jmat.BigInt.divr(this,a)};
Jmat.BigInt.half_=function(a){if(Jmat.Real.isPOT(a.radix)){var b=a.a[a.a.length-1]%2;return[Jmat.BigInt.rshift(a,1),Jmat.BigInt(b)]}b=[];for(var c=a.radix,d=0,e=0;e<a.a.length;e++){var f=a.a[e]+d;d=Jmat.Real.isOdd(f)?c:0;f=Math.floor(f/2);(0<f||0<b.length)&&b.push(f)}return[new Jmat.BigInt(b,c,a.minus),0==d?Jmat.BigInt(0,c):Jmat.BigInt(1,c)]};
Jmat.BigInt.divsmall_=function(a,b){if(b==a.radix)return[a.rshift_radix(a),Jmat.BigInt(0)];if(2==b)return Jmat.BigInt.half_(a);if(-2==b)return b=Jmat.BigInt.half_(a),[b[0].neg(),b[1].neg()];var c=a.minus,d=0>b,e=a.minus!=0>b;b=Math.abs(b);for(var f=[],g=a.radix,h=0,k=0;k<a.a.length;k++){var l=a.a[k]+h*g;h=l%b;l=Math.floor(l/b);(0<l||0<f.length)&&f.push(l)}a=Jmat.BigInt(h,g);h&&(c&&d?a=a.neg():d?a=a.subr(b):c&&(a=a.subr(b).neg()));return[new Jmat.BigInt(f,g,e),a]};
Jmat.BigInt.modr=function(a,b){if(0!=b)return 1==b||-1==b?Jmat.BigInt(0):Math.abs(b)<a.radix&&0==a.radix%b?Jmat.BigInt(Jmat.Real.mod(a.a[a.a.length-1],b)):65536>Math.abs(b)?Jmat.BigInt.divsmall_(a,b)[1]:Jmat.BigInt.mod(a,Jmat.BigInt(b))};Jmat.BigInt.prototype.modr=function(a){return Jmat.BigInt.modr(this,a)};
Jmat.BigInt.leemondiv_=function(a,b,c){var d=Jmat.BigInt,e=a.radix,f=a.radix-1,g,h=d.copy(a);a=a.strip();b=d.copystrip_(b);var k=b.a.length;var l=b.a[b.a.length-1-k+1];for(g=0;l;g++)l>>=1;g=c-g;b=b.lshift(g);h=h.lshift(g);b.a.splice(0,0,0);var m=Math.max(k,h.a.length);d=d(0,e);for(l=0;l<a.a.length;l++)d.a[l]=0;for(d.a.splice(0,0,0);;){l=b.lshift_radix(m-k);if(l.gt(h))break;h=h.sub(l);d.a[d.a.length-m+k-1]++}for(;h.a.length<a.a.length+1;)h.a.splice(0,0,0);for(l=m-1;l>=k;l--){var n=h.a.length-1;a=d.a.length-
1;var p=b.a.length-1;for(d.a[a-(l-k)]=h.a[n-l]==b.a[p-(k-1)]?f:Math.floor((h.a[n-l]*e+h.a[n-(l-1)])/b.a[p-(k-1)]);;){var q=(1<k?b.a[p-(k-2)]:0)*d.a[a-(l-k)];var t=q>>c;q&=f;m=t+d.a[a-(l-k)]*b.a[p-(k-1)];t=m>>c;m&=f;if(t==h.a[n-l]?m==h.a[n-(l-1)]?q>(1<l?h.a[n-(l-2)]:0):m>h.a[n-(l-1)]:t>h.a[n-l])d.a[a-(l-k)]--;else break}m=b.lshift_radix(l-k);q=m.mulr(d.a[a-(l-k)]);h.lt(q)?(h.a=Jmat.BigInt.baseloop_(h.a,0,1,m.a,0,1,0,e,!0),h.a=Jmat.BigInt.baseloop_(h.a,0,1,q.a,0,-1,0,e,!0),d.a[a-(l-k)]--):h.a=Jmat.BigInt.baseloop_(h.a,
0,1,q.a,0,-1,0,e,!0)}h=h.rshift(g);return[d,h]};
Jmat.BigInt.divmod_=function(a,b,c){var d=Jmat.BigInt;if(!b.eqr(0)){if(b.eqr(1))return[a,d(0)];if(b.eqr(-1))return[a.neg(),d(0)];if(b.abs().ltr(65536))return Jmat.BigInt.divsmall_(a,b.toInt());if(b.abs().gt(a.abs()))return[d(0),a];if(b.eq(a))return[d(1),d(0)];var e=a.minus!=b.minus;a=a.abs();b=b.abs();c||(a=d.cast(a,d.ARRAYBASE_),b=d.cast(b,d.ARRAYBASE_));c=d.leemondiv_(a,b,c||d.ARRAYBASE_BITS_);a=c[0];c=c[1];d.stripInPlace_(a.a);d.stripInPlace_(c.a);e&&(a=a.neg(),c=c.add(b),c.minus&&c.eqr(0)&&(c.minus=
!1));return[a,c]}};Jmat.BigInt.pow=function(a,b){var c=b;b=Jmat.BigInt.cast(b,2);var d=a.radix;if(b.minus)return Jmat.BigInt(0,d);var e=!1;a.minus&&b.modr(2).eqr(1)&&(e=!0);a=a.abs();b=Jmat.BigInt.maybecopystrip_(b.a,b!=c);d=Jmat.BigInt(1,d);c=b.length;for(var f=0;f<c;f++)0==b[f]?(a=d.mul(a),d=d.mul(d)):(d=d.mul(a),a=a.mul(a));e&&(d=d.neg());return d};Jmat.BigInt.prototype.pow=function(a){return Jmat.BigInt.pow(this,a)};Jmat.BigInt.powr=function(a,b){return Jmat.BigInt.pow(a,Jmat.BigInt.fromInt(b))};
Jmat.BigInt.prototype.powr=function(a){return Jmat.BigInt.pow(this,Jmat.BigInt.fromInt(a))};Jmat.BigInt.gcd=function(a,b){var c=Jmat.BigInt;a=a.abs();for(b=b.abs();;){if(b.eqr(0))return a;var d=c.mod(a,b);a=b;b=d}};
Jmat.BigInt.egcd=function(a,b){var c=Jmat.BigInt,d=c(0),e=c(1),f=c(1);c=c(0);for(var g=a,h=b,k;!g.eqr(0);){var l=h.div(g);k=g;g=h.sub(l.mul(g));h=k;k=d;d=e.sub(l.mul(d));e=k;k=f;f=c.sub(l.mul(f));c=k}if(f.sign()!=a.sign()||d.sign()!=b.sign())k=f,f=d,d=k,k=c,c=e,e=k,f.sign()!=a.sign()&&(f=f.neg()),d.sign()!=b.sign()&&(d=d.neg());return[h,e,c,f,d]};
Jmat.BigInt.invmod=function(a,b){for(var c=Jmat.BigInt,d=b,e=c(1),f=c(0);;){if(a.eqr(1)){a=e;break}if(a.eqr(0)){a=c(0);break}var g=b.divmod(a);f=f.sub(e.mul(g[0]));b=g[1];if(b.eqr(1)){a=f;break}if(b.eqr(0)){a=c(0);break}g=a.divmod(b);e=e.sub(f.mul(g[0]));a=g[1]}a.minus&&(a=d.add(a));return a};Jmat.BigInt.monred_=function(a,b,c,d,e){c=a.mul(e).bitand(c);a=a.add(c.mul(d)).rshift(b);return a.gte(d)&&(a=a.sub(d),a.gte(d))?null:a};
Jmat.BigInt.genmonred_=function(a){var b=Jmat.BigInt.getNumBits(a),c=Jmat.BigInt.lshift(Jmat.BigInt(1),b),d=c.subr(1),e=Jmat.BigInt.invmod(a,c).neg().bitand(d),f=c.lshift(b).mod(a);return function(c,h){return h?Jmat.BigInt.monred_(c.mul(f),b,d,a,e):Jmat.BigInt.monred_(c,b,d,a,e)}};
Jmat.BigInt.modpow=function(a,b,c,d){var e=Jmat.BigInt,f=b;b=e.cast(b,2);b=e.maybecopystrip_(b.a,b!=f);f=e.ONE;a.gt(c)&&(a=a.mod(c));var g=b.length;if(c.modr(2).eqr(1)&&1<g){c=d||e.genmonred_(c);f=c(f,!0);a=c(a,!0);for(d=0;d<g;d++)0==b[d]?(a=f.mul(a),f=f.mul(f)):(f=f.mul(a),a=a.mul(a)),f=c(f),a=c(a);f=c(f)}else for(d=0;d<g;d++)0==b[d]?(a=f.mul(a).mod(c),f=f.mul(f).mod(c)):(f=f.mul(a).mod(c),a=a.mul(a).mod(c));return f};
Jmat.BigInt.randomBits=function(a){for(var b=Jmat.BigInt([],Jmat.BigInt.ARRAYBASE_),c=Math.ceil(a/Jmat.BigInt.ARRAYBASE_BITS_),d=0;d<c;d++)b.a[d]=Math.floor(Jmat.BigInt.ARRAYBASE_*Math.random());a=a*(Jmat.BigInt.ARRAYBASE_BITS_-1)%Jmat.BigInt.ARRAYBASE_BITS_;c=Jmat.BigInt.ARRAYBASE_-1;for(d=0;d<a;d++)c=Math.floor(c/2);c+1<Jmat.BigInt.ARRAYBASE_&&(b.a[0]&=c);return b};Jmat.BigInt.randomPrime=function(a){return Jmat.BigInt.nextPrime(Jmat.BigInt.randomBits(a))};
Jmat.BigInt.firstPrimes_=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97];Jmat.BigInt.isPrimeSimple=function(a){a=Jmat.BigInt.cast(a);if(a.ltr(2))return 0;for(var b=0;b<Jmat.BigInt.firstPrimes_.length;b++){if(a.eqr(Jmat.BigInt.firstPrimes_[b]))return 1;if(0==a.modr(Jmat.BigInt.firstPrimes_[b]).toInt())return 0}return-1};
Jmat.BigInt.isPrimeMillerRabin=function(a,b){var c=Jmat.BigInt;b=b||c.chooseMillerRabinBase_(a);for(var d=a.divr(2),e=c.ONE;c.bitand(d,c.ONE).eqr(0);)d=d.divr(2),e=e.addr(1);for(var f=c.genmonred_(a),g=0;g<b.length;g++){a:{var h=void 0;var k=a,l=e,m=c.cast(b[g]);for(m=c.modpow(m,d,k,f);!l.eqr(0);){h=m.mul(m).mod(k);if(h.eqr(1)&&!m.eqr(1)&&!m.eq(k.subr(1))){h=!1;break a}m=h;l=l.subr(1)}h=h.eqr(1)}if(!h)return!1}return!0};
Jmat.BigInt.chooseMillerRabinBase_=function(a){var b=Jmat.BigInt.getNumBits(a);if(64>=b)a=a.ltr(1373653)?[2,3]:a.ltr(9080191)?[31,73]:a.ltr(4759123141)?[2,7,61]:a.ltr(1122004669633)?[2,13,23,1662803]:a.ltr(2152302898747)?[2,3,5,7,11]:a.ltr(3474749660383)?[2,3,5,7,11,13]:a.ltr(341550071728321)?[2,3,5,7,11,13,17]:a.ltr(0xd655278977733)?[2,2570940,880937,610386380,4130785767]:[2,325,9375,28178,450775,9780504,1795265022];else{a=[2,3];for(var c=0;18>c;c++)a.push(Jmat.BigInt.randomBits(b-1))}return a};
Jmat.BigInt.isPrime=function(a){if(a.ltr(Jmat.Real.BIGGESTJSPRIME))return Jmat.Real.isPrime(a.toInt());var b=Jmat.BigInt.isPrimeSimple(a);return-1!=b?!!b:Jmat.BigInt.isPrimeMillerRabin(a)};Jmat.BigInt.d_="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");Jmat.BigInt.di_=function(a){a=a.charCodeAt(0);if(57>=a)return a-48;90<a&&(a-=32);return a-65+10};Jmat.BigInt.mirror_=function(a){for(var b=0;b<a.length/2;b++){var c=a[b];a[b]=a[a.length-b-1];a[a.length-b-1]=c}};
Jmat.BigInt.getNumBits=function(a){a.radix&&0==(a.radix&a.radix-1)||(a=Jmat.BigInt.cast(a,Jmat.BigInt.ARRAYBASE_));var b=Jmat.BigInt.maybecopystrip_(a.a);if(0==b.length)return 0;var c=Jmat.Real.ilog2(b[0])+1;0<b.length&&(a=Jmat.Real.ilog2(a.radix),c+=a*(b.length-1));return c};Jmat.BigInt.getNumDigits=function(a){for(var b=0;b<a.a.length&&0==a.a[b];)b++;return a.a.length-b};Jmat.BigInt.stripInPlace_=function(a){for(;0==a[0]&&1<a.length;)a.shift()};
Jmat.BigInt.copystrip_=function(a){for(var b=0,c=0;c<a.a.length&&0==a.a[c];c++)b++;var d=Array(a.a.length-b);if(0==d.length)return new Jmat.BigInt([0],a.radix);for(c=0;c<d.length;c++)d[c]=a.a[c+b];return Jmat.BigInt(d,a.radix)};Jmat.BigInt.maybecopystrip_=function(a,b){if(1>=a.length||0!=a[0])return a;b||(a=Jmat.BigInt.copyarray_(a));Jmat.BigInt.stripInPlace_(a);return a};Jmat.BigInt.strip=function(a){return a.strip()};
Jmat.BigInt.prototype.strip=function(){return 1>=this.a.length||0!=this.a[0]?this:Jmat.BigInt.copystrip_(this)};Jmat.BigInt.copyarray_=function(a){return a.slice(0)};Jmat.BigInt.FORMAT_UNKNOWN_=0;Jmat.BigInt.FORMAT_BIGINT_=1;Jmat.BigInt.FORMAT_ARRAY_=2;Jmat.BigInt.FORMAT_STRING_=3;Jmat.BigInt.getFormat=function(a){return"string"==typeof a?Jmat.BigInt.FORMAT_STRING_:"[object Array]"===Object.prototype.toString.call(a)?Jmat.BigInt.FORMAT_ARRAY_:a instanceof Jmat.BigInt?Jmat.BigInt.FORMAT_BIGINT_:Jmat.BigInt.FORMAT_UNKNOWN_};
Jmat.BigInt.toFormat=function(a,b,c){if(void 0!=a){if(b==Jmat.BigInt.getFormat(a)){if(void 0==c)return a;if(b==Jmat.BigInt.FORMAT_BIGINT_)return a.minus==c?a:a.neg();if(b==Jmat.BigInt.FORMAT_STRING_)return"-"==a[0]==c?a:c?"-"+a:a.substr(1)}a=Jmat.BigInt.cast(a);void 0!=c&&a.minus!=c&&(a=a.neg());return b==Jmat.BigInt.FORMAT_BIGINT_?a:b==Jmat.BigInt.FORMAT_ARRAY_?a.a:b==Jmat.BigInt.FORMAT_STRING_||b==Jmat.BigInt.FORMAT_UNKNOWN_?a.toString():a}};
Jmat.BigInt.enrichFunction_=function(a,b,c,d){if(3==d)Jmat.BigInt.enrichFunction_(b,c,0),1<c&&Jmat.BigInt.enrichFunction_(b,c-1,2);else if(4==d)Jmat.BigInt.enrichFunction_(b,c,1),1<c&&Jmat.BigInt.enrichFunction_(b,c-1,2);else{var e=2==d?Jmat.BigInt.prototype[b]:Jmat.BigInt[b],f=function(){for(var a=Jmat.BigInt.getFormat(arguments[0]),b=Array.prototype.slice.call(arguments),f=0;f<c;f++)b[f]=Jmat.BigInt.cast(arguments[f]);b=e.apply(this,b);return 1==d?Jmat.BigInt.toFormat(b,a):b};2==e.length&&2==c&&
1==d&&(f=function(a,b){b=e(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b));return Jmat.BigInt.toFormat(b,Jmat.BigInt.getFormat(a))});1==e.length&&1==c&&2==d&&(f=function(a){return e.call(this,Jmat.BigInt.cast(a))});2==d?a.prototype[b]=f:a[b]=f}};
Jmat.BigInt.enrichFunctions_=function(){Jmat.BigIntC=function(){return Jmat.BigInt.apply(this,arguments)};for(var a in Jmat.BigInt)Jmat.BigIntC[a]=Jmat.BigInt[a];for(a in Jmat.BigInt.prototype)Jmat.BigIntC.prototype[a]=Jmat.BigInt.prototype[a];a=Jmat.BigIntC;Jmat.BigInt.enrichFunction_(a,"add",2,1);Jmat.BigInt.enrichFunction_(a,"addr",1,1);Jmat.BigInt.enrichFunction_(a,"sub",2,1);Jmat.BigInt.enrichFunction_(a,"subr",1,1);Jmat.BigInt.enrichFunction_(a,"mul",2,1);Jmat.BigInt.enrichFunction_(a,"mulr",
1,1);Jmat.BigInt.enrichFunction_(a,"div",2,1);Jmat.BigInt.enrichFunction_(a,"divr",1,1);Jmat.BigInt.enrichFunction_(a,"mod",2,1);Jmat.BigInt.enrichFunction_(a,"modr",1,1);Jmat.BigInt.enrichFunction_(a,"divmod",2,0);Jmat.BigInt.enrichFunction_(a,"lshift",1,1);Jmat.BigInt.enrichFunction_(a,"rshift",1,1);Jmat.BigInt.enrichFunction_(a,"bitand",2,1);Jmat.BigInt.enrichFunction_(a,"bitor",2,1);Jmat.BigInt.enrichFunction_(a,"bitxor",2,1);Jmat.BigInt.enrichFunction_(a,"bitneg",1,1);Jmat.BigInt.enrichFunction_(a,
"bitnot",1,1);Jmat.BigInt.enrichFunction_(a,"abs",1,1);Jmat.BigInt.enrichFunction_(a,"neg",1,1);Jmat.BigInt.enrichFunction_(a,"sign",1,0);Jmat.BigInt.enrichFunction_(a,"getSign",1,0);Jmat.BigInt.enrichFunction_(a,"nonZero",1,0);Jmat.BigInt.enrichFunction_(a,"compare",2,0);Jmat.BigInt.enrichFunction_(a,"comparer",1,0);Jmat.BigInt.enrichFunction_(a,"sqrt",1,1);Jmat.BigInt.enrichFunction_(a,"root",2,1);Jmat.BigInt.enrichFunction_(a,"rootr",1,1);Jmat.BigInt.enrichFunction_(a,"logy",2,1);Jmat.BigInt.enrichFunction_(a,
"logr",1,1);Jmat.BigInt.enrichFunction_(a,"log2",1,1);Jmat.BigInt.enrichFunction_(a,"log10",1,1);Jmat.BigInt.enrichFunction_(a,"rlog2",1,0);Jmat.BigInt.enrichFunction_(a,"rlog",1,0);Jmat.BigInt.enrichFunction_(a,"rlog10",1,0);Jmat.BigInt.enrichFunction_(a,"pow",2,1);Jmat.BigInt.enrichFunction_(a,"powr",1,1);Jmat.BigInt.enrichFunction_(a,"gcd",2,1);Jmat.BigInt.enrichFunction_(a,"egcd",2,0);Jmat.BigInt.enrichFunction_(a,"invmod",2,1);Jmat.BigInt.enrichFunction_(a,"modpow",3,1);Jmat.BigInt.enrichFunction_(a,
"isPrimeSimple",1,0);Jmat.BigInt.enrichFunction_(a,"isPrimeMillerRabin",1,0);Jmat.BigInt.enrichFunction_(a,"isPrime",1,0);Jmat.BigInt.enrichFunction_(a,"perfectpow",1,0);Jmat.BigInt.enrichFunction_(a,"nextPrime",1,1);Jmat.BigInt.enrichFunction_(a,"factorize",1,0);Jmat.BigInt.enrichFunction_(a,"factorial",1,1);Jmat.BigInt.enrichFunction_(a,"primorial",1,1);Jmat.BigInt.enrichFunction_(a,"legendre",2,0);Jmat.BigInt.enrichFunction_(a,"ressol",2,1)};Jmat.BigInt.enrichFunctions_();Jmat.add=function(a,b){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.add(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.add(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.add(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.add(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.sub=function(a,b){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.sub(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.sub(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.sub(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.sub(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.mul=function(a,b){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.mul(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.matrixIn_(a)?Jmat.Matrix.mulc(Jmat.Matrix.cast(a),Jmat.Complex.cast(b)):Jmat.matrixIn_(b)?Jmat.Matrix.mulc(Jmat.Matrix.cast(b),Jmat.Complex.cast(a)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.mul(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.mul(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.mul(Jmat.Complex.cast(a),
Jmat.Complex.cast(b))};
Jmat.div=function(a,b){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.div(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.matrixIn_(a)?Jmat.Matrix.divc(Jmat.Matrix.cast(a),Jmat.Complex.cast(b)):Jmat.matrixIn_(b)?Jmat.Matrix.divc(Jmat.Matrix.cast(b),Jmat.Complex.cast(a)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.div(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.div(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.div(Jmat.Complex.cast(a),
Jmat.Complex.cast(b))};Jmat.eq=function(a,b){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.eq(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.matrixIn_(a)||Jmat.matrixIn_(b)?!1:Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.eq(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.eq(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.eq(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.near=function(a,b,c){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.near(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b),Jmat.Real.caststrict(c)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.near(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b),Jmat.Real.caststrict(c)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.eq(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.near(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Real.caststrict(c))};
Jmat.relnear=function(a,b,c){return Jmat.matrixIn_(a)&&Jmat.matrixIn_(b)?Jmat.Matrix.relnear(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b),Jmat.Real.caststrict(c)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.relnear(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b),Jmat.Real.caststrict(c)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.eq(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.Complex.relnear(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Real.caststrict(c))};
Jmat.isNaN=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.isNaN(Jmat.Matrix.cast(a)):Jmat.Complex.isNaN(Jmat.Complex.cast(a))};Jmat.pow=function(a,b){return Jmat.matrixIn_(a)?Jmat.Matrix.powc(Jmat.Matrix.cast(a),Jmat.Complex.cast(b)):Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.pow(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.Complex.pow(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.sqrt=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.sqrt(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.sqrt(Jmat.Quaternion.cast(a)):Jmat.bigIntIn_(a)?Jmat.BigInt.sqrt(Jmat.BigInt.cast(a)):Jmat.Complex.sqrt(Jmat.Complex.cast(a))};Jmat.exp=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.exp(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.exp(Jmat.Quaternion.cast(a)):Jmat.Complex.exp(Jmat.Complex.cast(a))};
Jmat.log=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.log(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.log(Jmat.Quaternion.cast(a)):Jmat.Complex.log(Jmat.Complex.cast(a))};Jmat.log1p=function(a){return Jmat.Complex.log1p(Jmat.Complex.cast(a))};Jmat.expm1=function(a){return Jmat.Complex.expm1(Jmat.Complex.cast(a))};
Jmat.logy=function(a,b){return Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.logy(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.Complex.logy(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.log2=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.log2(Jmat.Quaternion.cast(a)):Jmat.Complex.log2(Jmat.Complex.cast(a))};Jmat.log10=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.log10(Jmat.Quaternion.cast(a)):Jmat.Complex.log10(Jmat.Complex.cast(a))};
Jmat.lambertw=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.lambertw(Jmat.Quaternion.cast(a)):Jmat.Complex.lambertw(Jmat.Complex.cast(a))};Jmat.lambertwm=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.lambertwm(Jmat.Quaternion.cast(a)):Jmat.Complex.lambertwm(Jmat.Complex.cast(a))};Jmat.lambertwb=function(a,b){return Jmat.quaternionIn_(b)?Jmat.Quaternion.lambertwb(a,Jmat.Quaternion.cast(b)):Jmat.Complex.lambertwb(Jmat.Real.caststrict(a),Jmat.Complex.cast(b))};
Jmat.tetration=function(a,b){return Jmat.Complex.tetration(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.tetrational=function(a){return Jmat.Complex.tetrational(Jmat.Complex.cast(a))};Jmat.x=function(a){return Jmat.Complex.cast(a)};Jmat.neg=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.neg(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.neg(Jmat.Quaternion.cast(a)):Jmat.Complex.neg(Jmat.Complex.cast(a))};
Jmat.inv=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.inv(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.inv(Jmat.Quaternion.cast(a)):Jmat.Complex.inv(Jmat.Complex.cast(a))};Jmat.conj=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.conj(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.conj(Jmat.Quaternion.cast(a)):Jmat.Complex.conj(Jmat.Complex.cast(a))};
Jmat.sin=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.sin(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.zin(Jmat.Quaternion.cast(a)):Jmat.Complex.sin(Jmat.Complex.cast(a))};Jmat.cos=function(a){return Jmat.matrixIn_(a)?Jmat.Matrix.cos(Jmat.Matrix.cast(a)):Jmat.quaternionIn_(a)?Jmat.Quaternion.cos(Jmat.Quaternion.cast(a)):Jmat.Complex.cos(Jmat.Complex.cast(a))};Jmat.tan=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.tan(Jmat.Quaternion.cast(a)):Jmat.Complex.tan(Jmat.Complex.cast(a))};
Jmat.asin=function(a){return Jmat.Complex.asin(Jmat.Complex.cast(a))};Jmat.acos=function(a){return Jmat.Complex.acos(Jmat.Complex.cast(a))};Jmat.atan=function(a){return Jmat.Complex.atan(Jmat.Complex.cast(a))};Jmat.atan2=function(a,b){return Jmat.Complex.atan2(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.sinc=function(a){return Jmat.Complex.sinc(Jmat.Complex.cast(a))};Jmat.sinh=function(a){return Jmat.Complex.sinh(Jmat.Complex.cast(a))};Jmat.cosh=function(a){return Jmat.Complex.cosh(Jmat.Complex.cast(a))};
Jmat.tanh=function(a){return Jmat.Complex.tanh(Jmat.Complex.cast(a))};Jmat.asinh=function(a){return Jmat.Complex.asinh(Jmat.Complex.cast(a))};Jmat.acosh=function(a){return Jmat.Complex.acosh(Jmat.Complex.cast(a))};Jmat.atanh=function(a){return Jmat.Complex.atanh(Jmat.Complex.cast(a))};Jmat.gamma=function(a){return Jmat.Complex.gamma(Jmat.Complex.cast(a))};Jmat.factorial=function(a){return Jmat.bigIntIn_(a)?Jmat.BigInt.factorial(Jmat.BigInt.cast(a)):Jmat.Complex.factorial(Jmat.Complex.cast(a))};
Jmat.digamma=function(a){return Jmat.Complex.digamma(Jmat.Complex.cast(a))};Jmat.trigamma=function(a){return Jmat.Complex.trigamma(Jmat.Complex.cast(a))};Jmat.polygamma=function(a,b){return Jmat.Complex.polygamma(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.loggamma=function(a){return Jmat.Complex.loggamma(Jmat.Complex.cast(a))};Jmat.gamma_inv=function(a){return Jmat.Complex.gamma_inv(Jmat.Complex.cast(a))};
Jmat.incgamma_lower=function(a,b){return Jmat.Complex.incgamma_lower(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.incgamma_upper=function(a,b){return Jmat.Complex.incgamma_upper(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.gamma_p=function(a,b){return Jmat.Complex.gamma_p(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.gamma_q=function(a,b){return Jmat.Complex.gamma_q(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.gamma_p_inv=function(a,b){return Jmat.Complex.gamma_p_inv(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.beta=function(a,b){return Jmat.Complex.beta(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.incbeta=function(a,b,c){return Jmat.Complex.incbeta(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.beta_i=function(a,b,c){return Jmat.Complex.beta_i(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.beta_i_inv=function(a,b,c){return Jmat.Complex.beta_i_inv(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.re=function(a){return Jmat.Complex(Jmat.Complex.cast(a).re)};Jmat.im=function(a){return Jmat.Complex(Jmat.Complex.cast(a).im)};Jmat.abs=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.abs(Jmat.Quaternion.cast(a)):Jmat.Complex.abs(Jmat.Complex.cast(a))};Jmat.arg=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.qrg(Jmat.Quaternion.cast(a)):Jmat.Complex.arg(Jmat.Complex.cast(a))};
Jmat.sign=function(a){return Jmat.quaternionIn_(a)?Jmat.Quaternion.sign(Jmat.Quaternion.cast(a)):Jmat.Complex.sign(Jmat.Complex.cast(a))};
Jmat.dist=function(a,b){return Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.dist(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.dist(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.matrixIn_(a)||Jmat.matrixIn_(b)?Jmat.Matrix.dist(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.Complex.dist(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.cheb=function(a,b){return Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.cheb(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.cheb(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.matrixIn_(a)||Jmat.matrixIn_(b)?Jmat.Matrix.cheb(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.Complex.cheb(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.manhattan=function(a,b){return Jmat.quaternionIn_(a)||Jmat.quaternionIn_(b)?Jmat.Quaternion.manhattan(Jmat.Quaternion.cast(a),Jmat.Quaternion.cast(b)):Jmat.bigIntIn_(a)||Jmat.bigIntIn_(b)?Jmat.BigInt.manhattan(Jmat.BigInt.cast(a),Jmat.BigInt.cast(b)):Jmat.matrixIn_(a)||Jmat.matrixIn_(b)?Jmat.Matrix.manhattan(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b)):Jmat.Complex.manhattan(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.csgn=function(a){return Jmat.Complex.csgn(Jmat.Complex.cast(a))};
Jmat.floor=function(a){return Jmat.Complex.floor(Jmat.Complex.cast(a))};Jmat.ceil=function(a){return Jmat.Complex.ceil(Jmat.Complex.cast(a))};Jmat.round=function(a){return Jmat.Complex.round(Jmat.Complex.cast(a))};Jmat.trunc=function(a){return Jmat.Complex.trunc(Jmat.Complex.cast(a))};Jmat.frac=function(a){return Jmat.Complex.frac(Jmat.Complex.cast(a))};Jmat.fracn=function(a){return Jmat.Complex.fracn(Jmat.Complex.cast(a))};
Jmat.rotate=function(a,b){return Jmat.Complex.rotate(Jmat.Complex.cast(a),Jmat.Real.caststrict(b))};Jmat.decompose=function(a,b){return Jmat.Complex.decompose(Jmat.Complex.cast(a),Jmat.Real.cast(b))};Jmat.lerp=function(a,b,c){return Jmat.Complex.lerp(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.besselj=function(a,b){return Jmat.Complex.besselj(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.bessely=function(a,b){return Jmat.Complex.bessely(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.besseli=function(a,b){return Jmat.Complex.besseli(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.besselk=function(a,b){return Jmat.Complex.besselk(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.hankelh1=function(a,b){return Jmat.Complex.hankelh1(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.hankelh2=function(a,b){return Jmat.Complex.hankelh2(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.airy=function(a){return Jmat.Complex.airy(Jmat.Complex.cast(a))};Jmat.bairy=function(a){return Jmat.Complex.bairy(Jmat.Complex.cast(a))};
Jmat.airy_deriv=function(a){return Jmat.Complex.airy_deriv(Jmat.Complex.cast(a))};Jmat.bairy_deriv=function(a){return Jmat.Complex.bairy_deriv(Jmat.Complex.cast(a))};Jmat.struveh=function(a,b){return Jmat.Complex.struveh(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.struvek=function(a,b){return Jmat.Complex.struvek(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.struvel=function(a,b){return Jmat.Complex.struvel(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.struvem=function(a,b){return Jmat.Complex.struvem(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.angerj=function(a,b){return Jmat.Complex.angerj(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.webere=function(a,b){return Jmat.Complex.webere(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.theta1=function(a,b){return Jmat.Complex.theta1(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.theta2=function(a,b){return Jmat.Complex.theta2(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.theta3=function(a,b){return Jmat.Complex.theta3(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.theta4=function(a,b){return Jmat.Complex.theta4(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.zeta=function(a){return Jmat.Complex.zeta(Jmat.Complex.cast(a))};Jmat.eta=function(a){return Jmat.Complex.eta(Jmat.Complex.cast(a))};Jmat.lambda=function(a){return Jmat.Complex.lambda(Jmat.Complex.cast(a))};Jmat.dilog=function(a){return Jmat.Complex.dilog(Jmat.Complex.cast(a))};Jmat.trilog=function(a){return Jmat.Complex.trilog(Jmat.Complex.cast(a))};
Jmat.polylog=function(a,b){return Jmat.Complex.polylog(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.hurwitzzeta=function(a,b){return Jmat.Complex.hurwitzzeta(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.hypergeometric0F1=function(a,b){return Jmat.Complex.hypergeometric0F1(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.hypergeometric1F1=function(a,b,c){return Jmat.Complex.hypergeometric1F1(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.hypergeometric2F1=function(a,b,c,d){return Jmat.Complex.hypergeometric2F1(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c),Jmat.Complex.cast(d))};Jmat.hypergeometric=function(a,b,c){for(var d=[],e=0;e<a.length;e++)d[e]=Jmat.Complex.cast(a[e]);a=[];for(e=0;e<b.length;e++)a[e]=Jmat.Complex.cast(b[e]);return Jmat.Complex.hypergeometric(d,a,Jmat.Complex.cast(c))};Jmat.erf=function(a){return Jmat.Complex.erf(Jmat.Complex.cast(a))};Jmat.erfc=function(a){return Jmat.Complex.erfc(Jmat.Complex.cast(a))};
Jmat.erfcx=function(a){return Jmat.Complex.erfcx(Jmat.Complex.cast(a))};Jmat.erf_inv=function(a){return Jmat.Complex.erf_inv(Jmat.Complex.cast(a))};Jmat.erfc_inv=function(a){return Jmat.Complex.erfc_inv(Jmat.Complex.cast(a))};Jmat.erfi=function(a){return void 0==a.re?Jmat.Complex(Jmat.Real.erfi(a)):Jmat.Complex.erfi(Jmat.Complex.cast(a))};Jmat.dawson=function(a){return void 0==a.re?Jmat.Complex(Jmat.Real.dawson(a)):Jmat.Complex.dawson(Jmat.Complex.cast(a))};Jmat.faddeeva=function(a){return Jmat.Complex.faddeeva(Jmat.Complex.cast(a))};
Jmat.pdf_uniform=function(a,b,c){return Jmat.Complex.pdf_uniform(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_uniform=function(a,b,c){return Jmat.Complex.cdf_uniform(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_uniform=function(a,b,c){return Jmat.Complex.qf_uniform(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_standardnormal=function(a){return Jmat.Complex.pdf_standardnormal(Jmat.Complex.cast(a))};
Jmat.cdf_standardnormal=function(a){return Jmat.Complex.cdf_standardnormal(Jmat.Complex.cast(a))};Jmat.qf_standardnormal=function(a){return Jmat.Complex.qf_standardnormal(Jmat.Complex.cast(a))};Jmat.pdf_normal=function(a,b,c){return Jmat.Complex.pdf_normal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_normal=function(a,b,c){return Jmat.Complex.cdf_normal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.qf_normal=function(a,b,c){return Jmat.Complex.qf_normal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_lognormal=function(a,b,c){return Jmat.Complex.pdf_lognormal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_lognormal=function(a,b,c){return Jmat.Complex.cdf_lognormal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.qf_lognormal=function(a,b,c){return Jmat.Complex.qf_lognormal(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_cauchy=function(a,b,c){return Jmat.Complex.pdf_cauchy(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_cauchy=function(a,b,c){return Jmat.Complex.cdf_cauchy(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_cauchy=function(a,b,c){return Jmat.Complex.qf_cauchy(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.pdf_studentt=function(a,b){return Jmat.Complex.pdf_studentt(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.cdf_studentt=function(a,b){return Jmat.Complex.cdf_studentt(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.qf_studentt=function(a,b){return Jmat.Complex.qf_studentt(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.pdf_chi_square=function(a,b){return Jmat.Complex.pdf_chi_square(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.cdf_chi_square=function(a,b){return Jmat.Complex.cdf_chi_square(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.qf_chi_square=function(a,b){return Jmat.Complex.qf_chi_square(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.pdf_logistic=function(a,b,c){return Jmat.Complex.pdf_logistic(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_logistic=function(a,b,c){return Jmat.Complex.cdf_logistic(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.qf_logistic=function(a,b,c){return Jmat.Complex.qf_logistic(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_gamma=function(a,b,c){return Jmat.Complex.pdf_gamma(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_gamma=function(a,b,c){return Jmat.Complex.cdf_gamma(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_gamma=function(a,b,c){return Jmat.Complex.qf_gamma(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.pdf_beta=function(a,b,c){return Jmat.Complex.pdf_beta(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_beta=function(a,b,c){return Jmat.Complex.cdf_beta(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_beta=function(a,b,c){return Jmat.Complex.qf_beta(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_fisher=function(a,b,c){return Jmat.Complex.pdf_fisher(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.cdf_fisher=function(a,b,c){return Jmat.Complex.cdf_fisher(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_fisher=function(a,b,c){return Jmat.Complex.qf_fisher(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_weibull=function(a,b,c){return Jmat.Complex.pdf_weibull(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_weibull=function(a,b,c){return Jmat.Complex.cdf_weibull(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.qf_weibull=function(a,b,c){return Jmat.Complex.qf_weibull(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.pdf_exponential=function(a,b){return Jmat.Complex.pdf_exponential(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.cdf_exponential=function(a,b){return Jmat.Complex.cdf_exponential(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.qf_exponential=function(a,b){return Jmat.Complex.qf_exponential(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.pdf_laplace=function(a,b,c){return Jmat.Complex.pdf_laplace(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.cdf_laplace=function(a,b,c){return Jmat.Complex.cdf_laplace(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.qf_laplace=function(a,b,c){return Jmat.Complex.qf_laplace(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.permutation=function(a,b){return Jmat.Complex.permutation(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};
Jmat.binomial=function(a,b){return Jmat.Complex.binomial(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.stirling2=function(a,b){return Jmat.Complex.stirling2(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.agm=function(a,b){return Jmat.Complex.agm(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.ghm=function(a,b){return Jmat.Complex.ghm(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.isPrime=function(a){return Jmat.Complex.isPrime(Jmat.Complex.cast(a))};Jmat.smallestPrimeFactor=function(a){return Jmat.Complex(Jmat.Real.smallestPrimeFactor(Jmat.Real.cast(a)))};
Jmat.factorize=function(a){if(Jmat.bigIntIn_(a))return Jmat.BigInt.factorize(Jmat.BigInt.cast(a));a=Jmat.Real.factorize(Jmat.Real.caststrict(a));for(var b=0;b<a.length;b++)a[b]=Jmat.Complex(a[b]);return a};Jmat.eulerTotient=function(a){return Jmat.Complex(Jmat.Real.eulerTotient(Jmat.Real.caststrict(a)))};Jmat.primeCount=function(a){return Jmat.Complex(Jmat.Real.primeCount(Jmat.Real.caststrict(a)))};Jmat.nearestPrime=function(a){return Jmat.Complex(Jmat.Real.nearestPrime(Jmat.Real.cast(a)))};
Jmat.nextPrime=function(a){return Jmat.Complex(Jmat.Real.nextPrime(Jmat.Real.cast(a)))};Jmat.previousPrime=function(a){return Jmat.Complex(Jmat.Real.previousPrime(Jmat.Real.cast(a)))};Jmat.gcd=function(a,b){return Jmat.Complex(Jmat.Real.gcd(Jmat.Real.caststrict(a),Jmat.Real.caststrict(b)))};Jmat.lcm=function(a,b){return Jmat.Complex(Jmat.Real.lcm(Jmat.Real.caststrict(a),Jmat.Real.caststrict(b)))};Jmat.dms=function(a){return Jmat.Complex(Jmat.Real.dms(Jmat.Real.caststrict(a)))};Jmat.dd=function(a){return Jmat.Complex(Jmat.Real.dd(Jmat.Real.caststrict(a)))};
Jmat.bitneg=function(a){return Jmat.Complex.bitneg(Jmat.Complex.cast(a))};Jmat.bitand=function(a,b){return Jmat.Complex.bitand(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.bitor=function(a,b){return Jmat.Complex.bitor(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.bitxor=function(a,b){return Jmat.Complex.bitxor(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.lshift=function(a,b){return Jmat.Complex.lshift(Jmat.Complex.cast(a),Jmat.Real.caststrict(b))};
Jmat.rshift=function(a,b){return Jmat.Complex.rshift(Jmat.Complex.cast(a),Jmat.Real.caststrict(b))};Jmat.mod=function(a,b){return Jmat.Complex.mod(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.rem=function(a,b){return Jmat.Complex.rem(Jmat.Complex.cast(a),Jmat.Complex.cast(b))};Jmat.wrap=function(a,b,c){return Jmat.Complex.wrap(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};Jmat.clamp=function(a,b,c){return Jmat.Complex.clamp(Jmat.Complex.cast(a),Jmat.Complex.cast(b),Jmat.Complex.cast(c))};
Jmat.minkowski=function(a){return Jmat.Complex.minkowski(Jmat.Complex.cast(a))};Jmat.lu=function(a){return Jmat.Matrix.lu(Jmat.Matrix.cast(a))};Jmat.qr=function(a){return Jmat.Matrix.qr(Jmat.Matrix.cast(a))};Jmat.svd=function(a){return Jmat.Matrix.svd(Jmat.Matrix.cast(a))};Jmat.eig=function(a){return Jmat.Matrix.eig(Jmat.Matrix.cast(a))};Jmat.pseudoinverse=function(a){return Jmat.Matrix.pseudoinverse(Jmat.Matrix.cast(a))};Jmat.determinant=function(a){return Jmat.Matrix.determinant(Jmat.Matrix.cast(a))};
Jmat.transpose=function(a){return Jmat.Matrix.transpose(Jmat.Matrix.cast(a))};Jmat.transjugate=function(a){return Jmat.Matrix.transjugate(Jmat.Matrix.cast(a))};Jmat.trace=function(a){return Jmat.Matrix.trace(Jmat.Matrix.cast(a))};Jmat.rank=function(a){return Jmat.Matrix.rank(Jmat.Matrix.cast(a))};Jmat.adj=function(a){return Jmat.Matrix.adj(Jmat.Matrix.cast(a))};Jmat.fft=function(a){return Jmat.Matrix.fft(Jmat.Matrix.cast(a))};Jmat.ifft=function(a){return Jmat.Matrix.ifft(Jmat.Matrix.cast(a))};
Jmat.solve=function(a,b){return Jmat.Matrix.solve(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b))};Jmat.dot=function(a,b){return Jmat.Matrix.dot(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b))};Jmat.cross=function(a,b){return Jmat.Matrix.cross(Jmat.Matrix.cast(a),Jmat.Matrix.cast(b))};Jmat.minor=function(a,b,c){return Jmat.Matrix.minor(Jmat.Matrix.cast(a),Jmat.Real.caststrict(b),Jmat.Real.caststrict(c))};Jmat.cofactor=function(a,b,c){return Jmat.Matrix.cofactor(Jmat.Matrix.cast(a),Jmat.Real.caststrict(b),Jmat.Real.caststrict(c))};
Jmat.submatrix=function(a,b,c,d,e){return Jmat.Matrix.submatrix(Jmat.Matrix.cast(a),Jmat.Real.caststrict(b),Jmat.Real.caststrict(c),Jmat.Real.caststrict(d),Jmat.Real.caststrict(e))};Jmat.makeRot2D=function(a){return Jmat.Matrix.makeRot2D(Jmat.Complex.cast(a))};Jmat.makeRot3D=function(a,b){return Jmat.Matrix.makeRot3D(Jmat.Matrix.cast(a),Jmat.Complex.cast(b))};Jmat.svd=function(a){return Jmat.Matrix.svd(Jmat.Matrix.cast(a))};Jmat.evd=function(a){return Jmat.Matrix.evd(Jmat.Matrix.cast(a))};
Jmat.qr=function(a){return Jmat.Matrix.qr(Jmat.Matrix.cast(a))};Jmat.norm=function(a){return Jmat.Matrix.norm(Jmat.Matrix.cast(a))};Jmat.norm2=function(a){return Jmat.Matrix.norm2(Jmat.Matrix.cast(a))};Jmat.maxcolnorm=function(a){return Jmat.Matrix.maxcolnorm(Jmat.Matrix.cast(a))};Jmat.maxrownorm=function(a){return Jmat.Matrix.maxrownorm(Jmat.Matrix.cast(a))};Jmat.differentiate=function(a,b){return Jmat.Complex.differentiate(Jmat.Complex.cast(a),b)};
Jmat.integrate=function(a,b,c,d){return Jmat.Complex.integrate(Jmat.Complex.cast(a),Jmat.Complex.cast(b),c,Jmat.Real.caststrict(d))};Jmat.rootfind_newton=function(a,b,c,d){return Jmat.Complex.rootfind_newton(a,b,Jmat.Complex.cast(c),Jmat.Real.caststrict(d))};Jmat.rootfind_newton_noderiv=function(a,b,c){return Jmat.Complex.rootfind_newton_noderiv(a,Jmat.Complex.cast(b),Jmat.Real.caststrict(c))};Jmat.polyroots=function(a){return Jmat.Complex.polyroots(Jmat.Complex.castArray(a))};
Jmat.matrixIn_=function(a){return a?"string"==typeof a?2>a.length?!1:"["==a[0]?!0:"-"==a[0]||48<=a.charCodeAt(0)&&57>=a.charCodeAt(0)?!1:-1!=a.indexOf("["):a&&(a instanceof Jmat.Matrix||void 0!=a.length):!1};Jmat.quaternionIn_=function(a){return a?"string"==typeof a&&(0<=a.indexOf("j")||0<=a.indexOf("k"))?!0:a&&a instanceof Jmat.Quaternion:!1};
Jmat.bigIntIn_=function(a){if(!a)return!1;if("string"==typeof a&&16<a.length){for(var b=!0,c=1;c<a.length&&17>c;c++){var d=a.charCodeAt(c);if(48>d||57<d){b=!1;break}}if(b)return!0}return a&&a instanceof Jmat.BigInt};
Jmat.toString_=function(a,b,c){if(!a)return""+a;var d="";if(b&&a.render)return"\n"+a.render(c);if("object"==typeof a&&Array.isArray(a)){d+="[";for(var e=0;e<a.length;e++)d+=Jmat.toString_(a[e],b,c)+(e+1==a.length?"":", ");return d+"]"}if(a.constructor==Object){d+="{";e=!1;for(var f in a)f&&a[f]&&(e&&(d+=", "),d+=f+": ",d+=Jmat.toString_(a[f],b,c),e=!0);return d+"}"}return d=b&&a.render?"\n"+a.render(c):a.toString?a.toString(c):""+a};Jmat.toString=function(a){return Jmat.toString_(a,!1)};
Jmat.print=function(a){console.log(Jmat.toString(a))};Jmat.render=function(a,b){return Jmat.toString_(a,!0,b)};var Real=Jmat.Real,Complex=Jmat.Complex,Matrix=Jmat.Matrix,BigInt=Jmat.BigIntC||Jmat.BigInt,Quaternion=Jmat.Quaternion;["gamma","factorial","lambertw","erf","erfc"].map(function(a){Math[a]||(Math[a]=Jmat.Real[a])});"sinh cosh tanh asinh acosh atanh clz32 log2 log10 log1p expm1".split(" ").map(function(a){Math[a]||(Math[a]=Jmat.Real[a])});
